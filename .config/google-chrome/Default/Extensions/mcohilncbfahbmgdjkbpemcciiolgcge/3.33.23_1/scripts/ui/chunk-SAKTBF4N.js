import{a as R,b as P,d as le,f as pe,k as fe,l as de,m as Te}from"./chunk-5GDA7ZVW.js";import{a as ue}from"./chunk-HOITYUNE.js";import{a as me}from"./chunk-3OHPQNDG.js";import{a as se,b as ae,c as at,d as re}from"./chunk-CCXOIJJY.js";import{a as ee}from"./chunk-XVRO6N6T.js";import{a as te,d as A}from"./chunk-UTVBVZWC.js";import{d as ie}from"./chunk-FXQ35K27.js";import{a as oe}from"./chunk-FSQDFL3V.js";import{a as Zt,c as $t}from"./chunk-VAJR5FGA.js";import{a as Xt}from"./chunk-E4XNFX7S.js";import{a as ge}from"./chunk-6VTLAKSD.js";import{b as ce}from"./chunk-L6WH2C7V.js";import{b as ne}from"./chunk-FAJ2Q5PZ.js";import{a as Bt,b as Tt}from"./chunk-C77TCOTM.js";import{a as zt}from"./chunk-EBBN5EW3.js";import{a as Wt,f as Vt}from"./chunk-XZ6AHFH2.js";import{d as nt,o as jt,q as Jt}from"./chunk-6UFIPREK.js";import{a as G}from"./chunk-JEIYTQ5E.js";import{b as dt}from"./chunk-DUWPYFAS.js";import{a as gt,j as Qt}from"./chunk-56SDY6L3.js";import{b as st}from"./chunk-PXWV5LKL.js";import{Q as qt}from"./chunk-DUKP4BLI.js";import{o as et}from"./chunk-KCWFMCND.js";import{T as X,ba as bt,da as Ut,na as Ht,ra as Mt,w as Q,wa as Kt,xa as Yt}from"./chunk-3TDWET6C.js";import{m as q}from"./chunk-EBR3PGFZ.js";import{a as Ye}from"./chunk-VPGNJAK6.js";import{Na as Y,Ra as kt}from"./chunk-W6Q44ZHW.js";import{d as S,f as ft}from"./chunk-3HS6AHPS.js";import{a as W,b as F}from"./chunk-JUXPONKW.js";import{a as Ke}from"./chunk-O2FUKKO3.js";import{a as ot}from"./chunk-GCXT25LW.js";import{Hb as St,Lb as b,Tb as Lt,V as wt,W as Ot,Xb as Dt,Ya as It,a as Nt,b as He,bc as Ft,dc as pt,ic as Gt,mc as Me}from"./chunk-O3CM75EN.js";import{G as U}from"./chunk-J3CEQI22.js";import{F as lt,K as ht,U as Ct,f as j,pa as vt}from"./chunk-VFHYER2K.js";import{L as Rt,w as I}from"./chunk-KJIO572I.js";import{a as J}from"./chunk-EAZTJZU7.js";import{f as v,m as d,o as T}from"./chunk-ZCHLW7CF.js";d();T();var V=v(Q());function mo(){let t=(0,V.useSelector)(Vt),e=t&&t.metadata?t.metadata.id:null,s=e?1:0,o=(0,V.useSelector)(Ut),n=o.length,a=(0,V.useSelector)(bt),i=(0,V.useSelector)(Yt),c=i.length,r=(0,V.useSelector)(Kt),m=r.length;return{unapprovedTxList:o,unapprovedTxCount:n,unapprovedSmCount:a,unapprovedStList:i,unapprovedStCount:c,unapprovedPermissionCount:s,unapprovedPermissionsRequestId:e,unapprovedSnList:r,unapprovedSnCount:m,unapprovedRequestCount:n+a+c+m+s}}d();T();d();T();var _=v(J()),yt=v(Q()),De=v(Ye());Rt();d();T();var rt=v(Q()),B=v(et()),H=v(Ke());vt();He();ft();Me();It();d();T();ft();var _e=async t=>await S().rpcEvmAddTransaction(t),_t=async t=>await S().rpcEvmUpdateTransaction(t),Pe=async t=>await S().rpcEvmConfirmTransaction(t),Ee=async t=>await S().rpcEvmFindTransaction(t),Ae=async(t,e)=>await S().rpcEvmPublishTransaction(t,e);d();T();var xe=v(J());Rt();var qe=()=>{let t=fe();return e=>{if(e){let{type:s,status:o,txHash:n,extraParams:a}=e,i={[P.TRANS_OUT]:{key:"wallet_transfer_notif_send_success",params:{first:a?.value,second:a?.coinSymbol}},[P.CONTRACT_CALL]:{key:"wallet_transfer_notif_contract_interaction_success"},[P.AUTHORIZATION]:{key:"wallet_transfer_notif_approval_success",params:{first:a?.coinSymbol}},[P.CANCEL_AUTHORIZATION]:{key:"wallet_transfer_notif_cancel_approval_success",params:{first:a?.coinSymbol}},[P.CONTRACT_DEPLOY]:{key:"developer_mode_dapp_toast_deployed_successfully"}},c={[P.TRANS_OUT]:{key:"wallet_transfer_notif_send_fail",params:{first:a?.value,second:a?.coinSymbol}},[P.CONTRACT_CALL]:{key:"wallet_transfer_notif_contract_interaction_fail"},[P.AUTHORIZATION]:{key:"wallet_transfer_notif_approval_fail",params:{first:a?.coinSymbol}},[P.CANCEL_AUTHORIZATION]:{key:"wallet_transfer_notif_cancel_approval_fail",params:{first:a?.coinSymbol}},[P.CONTRACT_DEPLOY]:{key:"developer_mode_dapp_toast_deployfailed"}},r,m,p,u,f;o===R.PENDING?(r=U.TYPE.success,s===P.CANCEL_AUTHORIZATION?(m="wallet_transfer_notif_cancel_approval_submit",p={first:a?.coinSymbol}):m="wallet_transfer_notif_transaction_submit"):(o===R.SUCCEED?(r=U.TYPE.success,m=i[s]?.key,p=i[s]?.params):(r=U.TYPE.error,m=c[s]?.key,p=c[s]?.params),o!==R.DROPPED&&(u=t(n),f="wallet_transfer_notif_view_on_explorer")),U[r]({title:I(m,p)||m,desc:u?xe.default.createElement(Xt,{url:u,urlText:I(f)}):null,duration:3})}}},ye=qe;function We(t){let e={to:t.to,value:(0,H.addHexPrefix)(F(t.value)),gasLimit:(0,H.addHexPrefix)(F(t.gasLimit)),nonce:(0,H.addHexPrefix)(F(t.nonce))};return t.type===q.FEE_MARKET?(e.maxFeePerGas=(0,H.addHexPrefix)(F(t.maxFeePerGas)),e.maxPriorityFeePerGas=(0,H.addHexPrefix)(F(t.maxPriorityFeePerGas)),e.type=t.type):(e.gasPrice=(0,H.addHexPrefix)(F(t.gasPrice)),t.type=q.LEGACY),t.data&&(e.data=t.data),e}function Et(t){let{extensionConfig:e}=G("rpc_info"),s=t||e,o=st();return(0,B.useMemoizedFn)(n=>{let{type:a,txParams:i,extraParams:c}=n,r=a;return r||(i.to?r=P.CONTRACT_CALL:r=P.CONTRACT_DEPLOY),{id:Gt(),type:r,txParams:{...We(i),from:i.from||o,chainId:s.chainId},status:R.UNAPPROVED,createTime:+new Date,txPool:[],isCanceling:!1,isSpeeding:!1,extraParams:c||{}}})}function At(t){let e=ye(),s=(0,rt.useSelector)(Mt),o=gt();return(0,B.useMemoizedFn)(async(n,{walletId:a=o,signedCallback:i=j}={})=>{if(!n)throw new Error("tx meta error");let c;if(n.txParams.result)c=n.txParams.result;else{let{from:m}=n.txParams;c=await S().signRpcEvmTransaction(n.txParams,m,s,a)}let r=await te(wt,c);return await i({rawTx:c,txHash:r,status:R.PENDING}),new Promise((m,p)=>{Ae({txId:n.id,rawTx:c},t).then(({error:u,data:f,tx:l})=>{if(u){(l?.status===R.PENDING||l?.status===R.DROPPED)&&e(l),p(u);let{type:x,txParams:y,extraParams:h}=n,{from:C,to:N,value:O,gasLimit:g,gasPrice:E,nonce:L,chainId:D}=y||{},{approvedAmount:z,coinSymbol:K,tokenAddress:it,approvedAddress:ct,value:mt,toAddress:ut}=h||{};Nt.captureEvent({tags:{address:C},message:"API_ERROR_evm_rpc_send_tx",contexts:{report:{info:JSON.stringify({type:x,txParams:{from:C,to:N,value:O,gasLimit:g,gasPrice:E,nonce:L,chainId:D},extraParams:Ct({approvedAmount:z,coinSymbol:K,tokenAddress:it,approvedAddress:ct,value:mt,toAddress:ut},ht)})}},exception:{values:[{type:"API_ERROR_evm_rpc_send_tx",value:u?.message}]},level:"info"})}else e(l),m({id:n.id,txHash:f.result})}).catch(async u=>{await Pe({txId:n.id,tx:{status:R.DROPPED,finishTime:+new Date,errorMessage:u?.message},checkPoolEmpty:!0}),p(u)})})})}var xt=()=>{let t=(0,rt.useDispatch)(),e=gt();return async(s,o=e)=>{await t(zt({walletId:o,txParams:s.txParams,isRpcMode:!0}));let{id:n}=s,a=await Ee(n);if(a&&(a.status===R.SUCCEED||a.status===R.DROPPED||a.status===R.DROPPED))throw Error(ot)}};function Ne(t){let e=Et(t),s=At(t),o=xt();return(0,B.useMemoizedFn)(async(n,a,i)=>{if(!await oe({walletId:a}))return j;let r=e(n);return await o(r,a),s(r,{walletId:a,signedCallback:m=>{let p={...r,...m};try{i&&i(p)}catch(u){console.log(u)}return _e(p)}})})}function Bo(){let t=Et(),e=At(),s=xt();return(0,B.useMemoizedFn)(async(o,n)=>{let{type:a,txParams:i,extraParams:c}=o,r=t({type:a,txParams:{...i,...n},extraParams:c}),{id:m,txPool:p}=o;return o.id=r.id,r.id=m,o.txPool=[],await s(r),e(r,{signedCallback:u=>_t({txId:m,tx:{...r,status:R.PENDING,isSpeeding:!0,txPool:[o,...p],...u}})})})}function Zo(){let t=jt(!0),e=Et(),s=At(),o=xt();return(0,B.useMemoizedFn)(async(n,a)=>{let{txParams:i,extraParams:c}=n,{from:r,nonce:m,type:p,chainId:u}=i,f=t.find(({address:h})=>!h),l=e({type:P.TRANS_OUT,txParams:{to:r,value:"0x0",nonce:m,chainId:u,type:p,...a},extraParams:c}),{id:x,txPool:y}=n;return n.id=l.id,l.id=x,n.txPool=[],await o(l),s(l,{signedCallback:h=>_t({txId:x,tx:{...l,status:R.PENDING,isCanceling:!0,txPool:[n,...y],extraParams:{toAddress:r,tokenAddress:"",coinSymbol:f?.symbol,value:"0"},...h}})})})}d();T();var Z=v(J()),he=v(Q()),tt=v(et());function Ve(t){let e=t.map(o=>{let{nonce:n}=o.txParams;return parseInt(n,16)}),s=Math.max.apply(null,e);return Number.isInteger(s)?s+1:0}function Ce(t,e){let s=nt(void 0,e),o=st(),n=t||o,a=(0,he.useSelector)(ce),i=(0,tt.useLatest)(le(e)),c=(0,tt.useLatest)(pe(void 0,e)),[r,m]=(0,Z.useState)(!1),[p,u]=(0,Z.useState)(null),[f,l]=(0,Z.useState)(null),x=(0,tt.useMemoizedFn)(async()=>{let y;try{m(!0),y=await(await s()).eth.getTransactionCount(n,"latest")}finally{m(!1)}let h=Ve(i.current),C=Math.max(y,h),N=c.current.map(g=>{let{nonce:E}=g.txParams;return ne(E)}),O=C;for(;N.includes(O);)O+=1;return u(y),l(O),{nonce:y,suggestedNonce:O}});return(0,Z.useEffect)(()=>{(async()=>(await s())?.eth&&x())()},[s,n,a]),{loadingNonce:r,nonce:p,suggestedNonce:f,request:x}}pt();d();T();d();T();var $=v(J()),ve=v(et());pt();var Be=({txParams:t={},dappInjectedGasInfo:e={}},s)=>{let{to:o,from:n,value:a,data:i,tokenAddress:c}=t,[r,m]=(0,$.useState)(""),[p,u]=(0,$.useState)(!0),[f,l]=(0,$.useState)(!1),{extensionConfig:x}=G("rpc_info"),h=de((s||x)?.rpcUrl),{run:C}=(0,ve.useDebounceFn)(async()=>{try{u(!0);let N=await h({to:o,from:n,value:a,data:i},c);m(N),l(!1)}catch{l(!0)}finally{u(!1)}},{wait:500});return(0,$.useEffect)(()=>{b(e.gasLimit,0)?(m(e.gasLimit),u(!1)):C()},[o,n,a,i,c,e.gasLimit]),{chainGasLimit:r,chainGasLimitLoading:p,chainGasLimitLoadFailed:f}},Re=Be;d();T();var M=v(J());vt();pt();var we=v(et()),Ze=({dappInjectedGasInfo:t={}},e)=>{let[s,o]=(0,M.useState)({}),[n,a]=(0,M.useState)(!0),[i,c]=(0,M.useState)(!1),{extensionConfig:r}=G("rpc_info"),m=e||r,{rpcUrl:p,chainId:u}=m,f=ee(u),l=Te(p),x=7e3,y=(0,M.useRef)(),h=(0,M.useRef)(!0),C=()=>{h.current=null,clearTimeout(y.current)},N=g=>{if(lt(t))o(g);else{let{gasPrice:E,maxFeePerGas:L,maxPriorityFeePerGas:D}=t,{isSupportEip1559:z}=g;if(z){delete g.gasPrice;let K=St(L,D);b(L,0)&&b(K,0)&&b(D,0)?(o({...g,maxFeePerGas:L,baseFeePerGas:K,maxPriorityFeePerGas:D}),C()):o(g)}else delete g.maxFeePerGas,delete g.baseFeePerGas,delete g.maxPriorityFeePerGas,b(E,0)?(o({...g,gasPrice:E}),C()):o(g)}},O=async(g=!1)=>{try{g&&a(!0);let L=(await l(u)).find(({level:D})=>D===ge.MEDIUM)||{};delete L.level,(g||h.current)&&(N(L),c(!1))}catch{g&&c(!0)}finally{a(!1),h.current&&(y.current=setTimeout(()=>{O()},x))}};return(0,we.useAsyncEffect)(async()=>{if(!m?.rpcUrl)return j;let g=await f();return lt(g)?O(!0):(o(g),a(!1)),()=>{C()}},[m?.rpcUrl]),{chainGasPrice:s,stopPollingGasPrice:C,chainGasPriceLoading:n,chainGasPriceLoadFailed:i}},Oe=Ze;var $e=(t={},e={},s)=>{let{chainGasPrice:o,stopPollingGasPrice:n,chainGasPriceLoading:a,chainGasPriceLoadFailed:i}=Oe({dappInjectedGasInfo:e},s),{chainGasLimit:c,chainGasLimitLoading:r,chainGasLimitLoadFailed:m}=Re({txParams:t,dappInjectedGasInfo:e},s);return{chainGasPrice:o,chainGasLimit:c,chainGasLoading:a||r,chainGasLoadFailed:i||m,stopPollingGasPrice:n,chainGasPriceLoading:a,chainGasLimitLoading:r,chainGasPriceLoadFailed:i,chainGasLimitLoadFailed:m}},Ie=$e;d();T();var Se=async(t,e)=>{let s;try{s=await e.eth.getCode(t)}catch{s=null}return{isContractAddress:s&&s!=="0x"&&s!=="0x0"}};d();T();function Le(t,{customPermissionAmount:e,decimals:s}){let o=X(t);if(o){if(o.name!==A.TOKEN_METHOD_APPROVE)throw new Error(`Invalid data; should be 'approve' method, but instead is '${o.name}'`)}else throw new Error("Invalid data");let n=at(o);n.startsWith("0x")&&(n=n.substring(2));let[a,i]=t.split(n);if(!a||!i)throw new Error("Invalid data");if(i.length!==64)throw new Error("Invalid token value; should be exactly 64 hex digits long (u256)");let c=F(ae(e,s));if(c.length>64)throw new Error("Custom value is larger than u256");return c=c.padStart(i.length,"0"),`${a}${n}${c}`}function ze({data:t,to:e}){let s=nt(),[o,n]=(0,_.useState)(""),[a,i]=(0,_.useState)(!1);return(0,_.useEffect)(()=>{(async()=>{if(t&&!e){n(A.DEPLOY_CONTRACT);return}try{let u=X(t)?.name,f=[A.TOKEN_METHOD_APPROVE,A.TOKEN_METHOD_TRANSFER,A.TOKEN_METHOD_TRANSFER_FROM].find(l=>l.toLowerCase()===u.toLowerCase());if(f){n(f);return}}catch{}i(!0);let r=await s(),{isContractAddress:m}=await Se(e,r);n(m?A.CONTRACT_INTERACTION:A.SENT_ETHER),i(!1)})()},[t,e,s]),[o,a]}function je({data:t,type:e}){let s,o,n,a;try{let i=X(t),c=re(i);s=at(i),a=c,o=e===A.TOKEN_METHOD_APPROVE,n=o&&Number(a)===0}catch{}return{address:s,isApprove:o,isRevoke:n,amount:a}}function Je(t,e){let s=Jt(void 0,e),[o,n]=(0,_.useState)({}),[a,i]=(0,_.useState)(!1),c=async()=>{try{i(!0);let{symbol:r,decimals:m}=await s(t);n({symbol:r,decimals:m}),i(!1)}catch{i(!1)}};return(0,_.useEffect)(()=>{t&&c()},[t]),[o,a]}function Qe(t){let[s,o]=(0,_.useState)(-1),{isApprove:n,formattedAmount:a,decimals:i,symbol:c}=t;(0,_.useEffect)(()=>{n&&o(a)},[n,a]);let r=(0,_.useMemo)(()=>s>=1e13?I("wallet_dapp_connection_subtitle_approval_amount_unlimitied"):`${Ft(Dt(s,i))}${c||""}`,[s,i,c,1e13]);return[{...t,customApproveAmount:s,approveAmountDisplay:r,INFINITY:1e13},o]}function Xe({origin:t,isApprove:e,isRevoke:s,symbol:o,walletId:n}){let a=Qt(n),i=(0,yt.useSelector)(Ht),c=n?a:i,m=(0,yt.useSelector)(Wt)[t]||{},[p,u]=(0,_.useState)({});return(0,_.useEffect)(()=>{let f=null,l=null,x=null;e?(f=null,l=o,x=s?I("wallet_approval_subtitle_revoke_approval_desc",{tokenSymbol:o}):I("wallet_dapp_conncetion_alert_approve_tip",{name:m.name,tokenSymbol:o})):(f=m.icon,x=m.host,l=m.name),u({icon:f,host:x,name:l})},[s,o]),{...p,originInfo:m,wallet:`${c.keyringName} - ${c.walletName}`}}function to(t,e){let{nonce:s,suggestedNonce:o}=Ce(t,e),[n,a]=(0,_.useState)(0),[i,c]=(0,_.useState)(!0);return(0,_.useEffect)(()=>{a(o),c(!1)},[o]),[{suggested:s,custom:n,pending:i},a]}var eo=({tx:t,nonce:e,txData:s,tokenInfo:o,chain:n,customGasInfo:a,approvedAmount:i,formattedAmount:c,txType:r})=>{let{from:m,to:p,value:u,data:f}=t,{isSupportEip1559:l,maxFeePerGas:x,maxPriorityFeePerGas:y,gasPrice:h,gasLimit:C}=a,N={from:m,to:p,value:u,gasLimit:C,nonce:e,data:f};l?(N.maxFeePerGas=x,N.maxPriorityFeePerGas=y,N.type=q.FEE_MARKET):(N.gasPrice=h,N.type=q.LEGACY);let g={[A.DEPLOY_CONTRACT]:P.CONTRACT_DEPLOY,[A.CONTRACT_INTERACTION]:P.CONTRACT_CALL,[A.TOKEN_METHOD_APPROVE]:P.AUTHORIZATION,[A.SENT_ETHER]:P.TRANS_OUT,[A.TOKEN_METHOD_TRANSFER]:P.TRANS_OUT,[A.TOKEN_METHOD_TRANSFER_FROM]:P.TRANS_OUT}[r]||P.CONTRACT_CALL;s.isRevoke&&(g=P.CANCEL_AUTHORIZATION);let E={};return r===A.TOKEN_METHOD_APPROVE&&(E.approvedAmount=i,E.coinSymbol=o.symbol,E.tokenAddress=p,E.approvedAddress=s.address),r===A.SENT_ETHER&&(E.value=Lt(W(u)),E.toAddress=p,E.coinSymbol=n.symbol),(r===A.TOKEN_METHOD_TRANSFER||r===A.TOKEN_METHOD_TRANSFER_FROM)&&(E.value=c,E.tokenAddress=p,E.toAddress=s.address,E.coinSymbol=o.symbol),{type:g,txParams:N,extraParams:E}};function oo(t,e,s){let o=(0,De.useHistory)(),n=me(),a=ue(),i=Ne(s),[c,r]=(0,_.useState)(!1);return[{sign:async(u,f)=>{r(!0),i(t,u,f).then(async({txHash:l})=>{n({id:e,result:l}),o.push(qt)}).catch(l=>{l.message!==ot&&U.error({title:l?.message}),n({id:e,error:l?.message||"Transaction failed"}),r(!1)}).finally(()=>{o.go(0)})},cancel:async()=>{await a({id:e}),o.go(0)}},c]}function is(t,e){let[s]=ze(t),o=je({data:t.data,type:s}),[n,a]=Je(t?.to,e),i=Xe({walletId:t?.walletId,origin:t.origin,...o,...n}),c=(0,_.useMemo)(()=>se(o?.amount||0,n?.decimals),[o?.amount,n?.decimals]),[r,m]=Qe({...o,...n,formattedAmount:c}),[p,u]=(0,_.useState)(t.data);(0,_.useEffect)(()=>{if(s===A.TOKEN_METHOD_APPROVE&&r.customApproveAmount>=0&&r.customApproveAmount<=r.INFINITY)try{let k=Le(t.data,{customPermissionAmount:r.customApproveAmount,decimals:n?.decimals});u(k)}catch{}},[r.customApproveAmount,r.INFINITY,t.data,n?.decimals,o,s]);let f={...e,name:e?.name||e?.chainName},[l,x]=to(t.from,e),[y,h]=(0,_.useState)(null),[C,N]=(0,_.useState)({}),{chainGasPrice:O,chainGasLimit:g,chainGasLoading:E,chainGasLoadFailed:L,stopPollingGasPrice:D,chainGasLimitLoadFailed:z}=Ie({to:t.to,from:t.from,value:t.value||"0x0",data:p},{gasLimit:W(t.gas||t.gasLimit),gasPrice:W(t.gasPrice),maxFeePerGas:W(t.maxFeePerGas),maxPriorityFeePerGas:W(t.maxPriorityFeePerGas)},e),K=k=>{h(Ue=>({...Ue,...k}))};(0,_.useEffect)(()=>{N(k=>({...k,...O}))},[O]),(0,_.useEffect)(()=>{N(k=>({...k,gasLimit:g}))},[g]);let it=eo({tx:{...t,data:p},nonce:l.custom||l.suggested,txData:o,tokenInfo:n,chain:f,customGasInfo:y||C,approvedAmount:r.customApproveAmount,formattedAmount:c,txType:s}),[{sign:ct,cancel:mt},ut]=oo(it,t.id,e),be=(0,_.useMemo)(()=>{switch(s){case A.DEPLOY_CONTRACT:return I("developer_mode_history_title_contract_eployment");case A.TOKEN_METHOD_APPROVE:return o?.isRevoke?I("wallet_extension_popup_btn_revoke_approval"):I("wallet_extension_popup_btn_approve");default:return I("wallet_extension_popup_title_contract_interaction")}},[s,o?.isRevoke]);return[{type:s,title:be,auth:{...r,...n,formattedAmount:c},meta:i,chain:f,nonce:l,gas:{chainGasInfo:C,customGasInfo:y||C,chainGasLoading:E,chainGasLoadFailed:L,updateCustomGasInfo:K,stopPollingGasPrice:D,chainGasLimitLoadFailed:z},loading:{sign:ut,token:a},data:p},{sign:ct,cancel:mt,setNonce:x,setAuthAmount:m}]}d();T();var ke=v(Q());d();T();kt();ft();function Fe(t,e,s){return async o=>{await S().resolvePendingApproval(t,e);let{pendingApprovals:n}=await Y(o);Object.values(n).length===0&&!s&&o(Tt())}}function Ge(t){return async e=>{await S().rejectPendingApproval(t);let{pendingApprovals:s}=await Y(e);Object.values(s).length===0&&e(Tt())}}kt();It();function Cs(t){let e=(0,ke.useDispatch)(),o=(r=>{let{id:m,origin:p,requestData:u,type:f,requestData:{chainId:l}}=r;return{id:m,origin:p,...u,requestData:u,chainIdToDisplay:parseInt(l,16),switchType:f,explorers:u.blockExplorerUrl}})(t),{addRpcNetwork:n}=ie(),{setExtensionConfig:a}=G("rpc_info");return[o,{cancel:async()=>{await e(Ge(o.id)),await Y(e)},approve:async()=>{let{rpcUrl:r,ticker:m,blockExplorerUrl:p,chainId:u,faucetUrl:f,chainName:l}=o,x=await n({chainId:u,explorerUrl:p,faucetUrl:f,name:l,rpcUrl:r,symbol:m}),{uniqueId:y}=x;await a(x),await e(dt("isRpcMode",!0)),await e(dt("currentNetworkUniqueId",y)),await e(Bt(Ot,r,m,l,u,{},!0,y)),await e(Fe(o.id,o.requestData)),await Y(e)}}]}d();T();function Is(t){return Zt(t?.image)?t.image=t.image[0]:$t(t?.image)&&(t.image=null),t}export{Pe as a,Ee as b,ye as c,Ne as d,Bo as e,Zo as f,Ce as g,Ie as h,ze as i,je as j,Je as k,eo as l,is as m,Cs as n,mo as o,Is as p};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-SAKTBF4N.js.map
