import{a as hn}from"./chunk-M7DGEDWH.js";import{a as wn}from"./chunk-3OHPQNDG.js";import{a as Nn}from"./chunk-H3WNV4JD.js";import{a as dn}from"./chunk-BAPOQKLV.js";import{i as xn,j as Tn,k as yn,l as gn,m as Cn,n as In}from"./chunk-JAXPFHLZ.js";import"./chunk-KXIOITHX.js";import"./chunk-CDVXLQA3.js";import"./chunk-JBU7IWTZ.js";import{a as ke,b as Le}from"./chunk-F46AEGKF.js";import{a as fn}from"./chunk-OPDQBBGJ.js";import{a as Be}from"./chunk-V2C2H4YP.js";import{b as mn,c as pn,d as un}from"./chunk-4IDSMRQU.js";import{a as _n}from"./chunk-65VFWMII.js";import{a as cn}from"./chunk-7KXE5PFN.js";import"./chunk-F7YYSTTZ.js";import{a as an}from"./chunk-SYQTAGUC.js";import"./chunk-X6LGMUFV.js";import{d as ln}from"./chunk-6M2GCKDH.js";import{d as sn}from"./chunk-4RVQOPYQ.js";import"./chunk-CCXOIJJY.js";import{a as on,c as nn,g as rn}from"./chunk-EU22H7NN.js";import{a as en}from"./chunk-KTRYKYE5.js";import{a as ce}from"./chunk-V2A2AEVZ.js";import{a as Ee,b as be}from"./chunk-ELKHXPPU.js";import"./chunk-Z2M3JODD.js";import"./chunk-UTGDPJGB.js";import{b as Zt,g as Ne,i as Vo,j as jo,k as Ae,m as Se,q as Ko,r as Jo,s as Qo}from"./chunk-D6NWGDM6.js";import"./chunk-NJJL64HF.js";import{a as he}from"./chunk-ZVUQCOMJ.js";import{e as $o}from"./chunk-TSGQQ5QA.js";import"./chunk-KU3DITYD.js";import{c as Ro}from"./chunk-7CWLH6ZR.js";import"./chunk-Q5HW75TA.js";import"./chunk-SYF5MRVO.js";import{a as me}from"./chunk-UUX3UNZW.js";import"./chunk-QCTV4R7X.js";import{a as tn,b as le,c as Qe,d as X,e as Rt,g as Q}from"./chunk-SIIB3XCZ.js";import"./chunk-GUGRL7WK.js";import"./chunk-6ZHQ2QLX.js";import"./chunk-S4NIXE4H.js";import{q as G}from"./chunk-UTVBVZWC.js";import"./chunk-GL4YYTXQ.js";import"./chunk-4MDR2IS2.js";import{c as Zo}from"./chunk-GZN3TPOZ.js";import"./chunk-ZN3567SM.js";import"./chunk-SJCGLHGC.js";import{d as wt,g as Ho}from"./chunk-GQYTOJVD.js";import"./chunk-7HZMPY3W.js";import"./chunk-QTEBOXIQ.js";import"./chunk-K4WB5MMU.js";import{a as ae}from"./chunk-FSQDFL3V.js";import"./chunk-YLJ56YQC.js";import"./chunk-YVC4CAU2.js";import"./chunk-K4MSA5MN.js";import"./chunk-4HBLPFAF.js";import"./chunk-TJW4EUGS.js";import{c as ft}from"./chunk-SJRV5U24.js";import"./chunk-PUMQ7BEU.js";import"./chunk-4OKCKO5L.js";import"./chunk-VAJR5FGA.js";import{a as Wo}from"./chunk-KWRE6JWY.js";import"./chunk-SKK4O3IC.js";import"./chunk-L4BR2EHM.js";import"./chunk-AQH6QKNE.js";import"./chunk-6IVHTBSR.js";import"./chunk-75OW6LUI.js";import"./chunk-W4IULSMQ.js";import"./chunk-UXRYSOKP.js";import"./chunk-ABSI53HE.js";import"./chunk-JJIQEHOY.js";import"./chunk-2AX7AESG.js";import"./chunk-KP7FQOJR.js";import"./chunk-CIJPMHDN.js";import"./chunk-AE7B6XHD.js";import{b as Yo}from"./chunk-5U7ZXBMP.js";import{b as nt}from"./chunk-C77TCOTM.js";import{d as zo}from"./chunk-EBBN5EW3.js";import"./chunk-KA5VAELR.js";import"./chunk-JOXGYPV7.js";import"./chunk-RUFGCIXT.js";import"./chunk-4BUFJ3ZT.js";import"./chunk-T37NLQBV.js";import"./chunk-U5WRMXFD.js";import"./chunk-JMTMYFWR.js";import{a as Je}from"./chunk-RE5SSELD.js";import{h as J,i as at}from"./chunk-A3B5II6P.js";import{d as Go}from"./chunk-XVPROSYE.js";import"./chunk-E2MXYP3A.js";import{j as qo}from"./chunk-FPV6XIHQ.js";import"./chunk-MZXFJMVC.js";import"./chunk-46PSZUMN.js";import"./chunk-MYY7DCIN.js";import"./chunk-AHIMORZ4.js";import"./chunk-M2ZE7N7H.js";import"./chunk-XZ6AHFH2.js";import"./chunk-3DEZPDXQ.js";import"./chunk-6UFIPREK.js";import"./chunk-G4OIO3Z6.js";import"./chunk-JEIYTQ5E.js";import"./chunk-TOO5SEJU.js";import"./chunk-DUWPYFAS.js";import{a as Xo}from"./chunk-CA4PB6NG.js";import"./chunk-SCXRHDUG.js";import"./chunk-5STCPPZU.js";import"./chunk-ZVXDJZSD.js";import"./chunk-56SDY6L3.js";import"./chunk-PXWV5LKL.js";import"./chunk-M5PVKGM6.js";import"./chunk-AK34CZMZ.js";import{m as ie,n as se}from"./chunk-QHZHYX4V.js";import"./chunk-FLFVNMKM.js";import"./chunk-YJ2NGJXA.js";import"./chunk-DQ2UEFEE.js";import{a as Ot}from"./chunk-ZUBNNPBM.js";import"./chunk-2SHHGXPQ.js";import"./chunk-UK4SAM7E.js";import{a as Dt}from"./chunk-LXIBKSOK.js";import"./chunk-C53RLQYB.js";import"./chunk-72NGWMH2.js";import"./chunk-VRXSSD45.js";import{a as Ht}from"./chunk-DUKP4BLI.js";import{b as ot}from"./chunk-S3O4LR55.js";import{a as No,q as T}from"./chunk-FZCNSMLW.js";import"./chunk-WANYNTD6.js";import{a as Ar}from"./chunk-QMGTBJAL.js";import{o as bt}from"./chunk-KCWFMCND.js";import{V as Oo,W as Uo,j as $e,k as ge,m as uo,n as _o,w as re}from"./chunk-3TDWET6C.js";import{F as K,T as Do,V as Mt,b as P,c as vo,ea as Et,i as Mo}from"./chunk-EBR3PGFZ.js";import{a as Ao}from"./chunk-UDGUBKMO.js";import{a as Ve}from"./chunk-VPGNJAK6.js";import{Na as xe,Ra as Fo}from"./chunk-W6Q44ZHW.js";import{d as So,f as Sr}from"./chunk-3HS6AHPS.js";import"./chunk-JUXPONKW.js";import{e as wo,g as ho}from"./chunk-WSUAESF2.js";import"./chunk-O2FUKKO3.js";import"./chunk-GQJVAWGG.js";import"./chunk-WO5B666G.js";import"./chunk-GCXT25LW.js";import"./chunk-TW63K7CB.js";import{c as u}from"./chunk-FDCWN4NG.js";import"./chunk-5YGMD6KK.js";import{Eb as Re,Hc as Eo,Jc as bo,Kc as Bo,Lc as ko,Mc as we,Pc as Lo,Ta as oe,Ua as It,Uc as Er,Vc as Po,Wa as co,Wc as br,Ya as ne,_a as po,dc as Nr,wb as hr,yc as qt}from"./chunk-O3CM75EN.js";import"./chunk-ZGRAPBBU.js";import{G as yo,H as go,N as Ke,O as Co,W as Io,b as Xt,o as vt,p as je,r as xo,y as To}from"./chunk-J3CEQI22.js";import"./chunk-VFHYER2K.js";import{L as R,l as A,w as i}from"./chunk-KJIO572I.js";import"./chunk-HJXNXGYU.js";import"./chunk-77ECUYXV.js";import"./chunk-4BZBCAHV.js";import{T as Ie,Z as fo,c as Ce,ca as z}from"./chunk-KALFZBR5.js";import"./chunk-V55FEIYE.js";import{a as W}from"./chunk-EAZTJZU7.js";import"./chunk-YTRW5WTJ.js";import"./chunk-3AN5FAZD.js";import"./chunk-CJ3MW6GG.js";import"./chunk-AKCHCVUS.js";import"./chunk-VOT7VHG3.js";import"./chunk-SYQUJKIR.js";import"./chunk-UYGNKZ5P.js";import"./chunk-KZFZROAL.js";import"./chunk-WPMHLM7C.js";import"./chunk-3MRE2BAK.js";import"./chunk-CSLLQXN7.js";import"./chunk-P7DU4NJA.js";import"./chunk-FMFDUPSA.js";import"./chunk-GAJPJAPC.js";import"./chunk-KW7JYBDS.js";import"./chunk-224G4QSH.js";import{f as d,m as s,n as x,o as a}from"./chunk-ZCHLW7CF.js";s();a();var Lt=d(W());s();a();var Pe=d(W());R();s();a();var An=({unapproved:t})=>Pe.default.createElement(u.Container,null,Pe.default.createElement(Ot,{title:i("wallet_trade_maintitle_transaction_confirm"),backable:!1,closeable:!1}),Pe.default.createElement(dn,{unapproved:t}));s();a();var h=d(W()),Sn=d(re()),Fe=d(bt());R();Sr();we();ne();var Br=({unapproved:t})=>{let e=t?.localType,o=ft({localType:e})?.coinId;o===void 0&&(o=It(e));let r=wt(o),l=(0,Sn.useDispatch)(),c=t.walletId,p=t.params.transaction.from,B=se(c),C=t.params.transaction.amount||2,[,y]=he({coinId:o,address:p,chainId:r?.chainId}),w=y?.transferReminder,f=y?.dummyOutput,[m,I]=(0,h.useState)({level:Mt.STANDARD,satBytes:y?.normal}),E=m?.satBytes;(0,h.useEffect)(()=>{if(!E&&y?.normal&&I({level:Mt.STANDARD,satBytes:y?.normal}),E&&m?.level!==Mt.CUSTOM){let $=y[Ee[m?.level]?.satBytes];I({...m,satBytes:$})}},[y]);let[D,{toggle:O}]=(0,Fe.useBoolean)(!1),[F,{set:N}]=(0,Fe.useBoolean)(!1),[b,{set:U}]=(0,Fe.useBoolean)(!1),[v,Pt]=(0,h.useState)(),[H,S]=Ae({coinId:o,walletId:c,address:p,batchDummyNum:C,utxoType:Zt.SPLIT_UTXO}),[Ct,k,yt]=jo({coinId:o,walletId:c,address:p,networkFee:v,utxoType:Zt.SPLIT_UTXO,batchDummyNum:C,coinAmount:A.mul(f,C)},{ready:!!f}),rt=(0,h.useMemo)(()=>k.findIndex(({dummy:$})=>$!==!0),[k]),mt=(0,h.useMemo)(()=>rt===-1?[]:k.slice(rt),[rt,k]),it=(0,h.useMemo)(()=>rt===-1?0:Math.max(C-rt,0),[C,rt]),Nt=A.gt(it,0),Vt=A.mul(f,it),tt=Ko({coinId:o,fromAddr:p,satBytes:E}),st=(0,h.useCallback)(async()=>{try{if(!E)return;N(!0);let $=await tt({inputs:mt,outputs:Array.from({length:it}).map(()=>({address:p,amount:f}))});U(!1),Pt($)}catch{U(!0)}finally{N(!1)}},[f,tt,p,mt,it,E,U,N]);(0,h.useEffect)(()=>{st()},[st]);let ct=(0,h.useMemo)(()=>S===void 0||!v?!0:A.gt(S,v),[S,v]),jt=(0,h.useMemo)(()=>B?{type:Q.TIP_TYPE.COMMON_ERROR,message:i("wallet_extension_top_toast_dapp_comingsoon")}:b?{type:Q.TIP_TYPE.FEE_ERROR}:ct?{type:Xt.TYPE.warn,message:w}:{coinId:o,type:Q.TIP_TYPE.FEE_BALANCE_INSUFFICIENT},[o,b,B,ct,w]),Ft=$o({coinId:o,walletId:c,coinAmount:0,fromAddr:p,toAddr:p,localType:r?.localType,networkFee:v,extJson:JSON.stringify({}),txSource:qt.DAPP,txType:P.BTC_SPLIT_UTXO}),At=Se({coinId:o,txType:P.BTC_SPLIT_UTXO,address:p}),et=ie(c),[zt,Yt]=(0,h.useState)(!1),Kt=(0,h.useCallback)(async()=>{await l(J(t.id)),await l(nt()),Yt(!1)},[l,t.id]),Jt=(0,h.useCallback)(async()=>{if(Nt)try{if(!await ae({walletId:c,callback:async()=>{await l(J(t.id))}}))return;await At(mt),Yt(!0);let{signed:Gt,utxos:qe}=await So().splitUtxo({splitAmount:it,inputs:Ne(mt),amount:f,feePerB:m.satBytes},p,c);await Ft(Gt);let He=k.filter(Qt=>Qt.dummy),Ze=[...Ne(He),...qe.map(Qt=>({...Qt,rawTransaction:Gt}))];await l(at(t.id,{utxos:Ze}))}catch($){console.log($)}finally{Yt(!1)}else{let $=k.slice(0,C);await l(at(t.id,{utxos:Ne($)}))}},[C,l,f,k,p,Nt,mt,Ft,it,m.satBytes,t.id,At,c]),fe=(0,h.useMemo)(()=>{let $={actionType:G.ACTION_TYPE.CANCEL,btnText:i("wallet_dapp_connection_btn_reject"),onClick:Kt},Gt={actionType:G.ACTION_TYPE.CONFIRM,disabled:H||F||Ct||b||yt||!Number(v)||B,onClick:Jt};return ct||(Gt={coinId:o,walletId:c,address:p,actionType:G.ACTION_TYPE.FILL_UP}),[$,Gt]},[o,v,b,F,p,B,ct,H,Kt,Jt,yt,Ct,c]);return h.default.createElement(u.Container,null,h.default.createElement(Ot,{backable:!1,closeable:!1,title:i("wallet_extension_send_title_send")}),h.default.createElement(X,null,h.default.createElement(le,{title:i("wallet_extension_send_colored_send"),summaryList:[{coinId:o,coinAmount:Vt}]})),h.default.createElement(X,null,h.default.createElement(Rt,{walletId:c,address:p,title:i("wallet_extension_network_address_title_walletused")},!!S&&h.default.createElement(ke,{coinBalance:S,tooltip:i("extension_defi_bot_popuptext_avail_amount"),coinId:o}))),h.default.createElement(X,{bordered:!1},h.default.createElement(me,{coinId:o,loading:F,feeError:b,networkFee:v,onClick:O})),h.default.createElement(Dt,{placeholder:!0,offsetBottom:0,borderTop:!0},h.default.createElement(Q,{coinId:o,...jt}),h.default.createElement(G,{buttonGroup:fe})),h.default.createElement(be,{coinId:o,visible:D,signInfo:y,value:m,estimatedFee:v,onChange:I,onToggleVisible:O}),h.default.createElement(Le,{visible:et&&zt}))},En=Br;s();a();var bn=d(W());var Bn=({unapproved:t})=>{let e=t.params?.message,n=fn({unapproved:t});return bn.default.createElement(_n,{needCheckMpc:!0,message:e,unapproved:t,tipMessage:n})};s();a();var gt=d(W()),kn=d(re()),Ln=d(Ve()),Pn=d(bt());we();hr();ne();s();a();var $t={AMOUNT:1,CONFIRM:2};var to=$t.AMOUNT;function kr({unapproved:t}){let{from:e,type:n=P.BRC20_INSCRIBE,tick:o="",tid:r,amount:l,txSource:c=qt.DAPP}=t?.params?.transaction||{},p=t?.localType||po,[B,C]=(0,gt.useState)(to),y=(0,kn.useDispatch)(),w=(0,Ln.useHistory)(),m=ft({localType:p})?.netWorkId;m===void 0?m=oe(p):m=+m;let I=(0,Pn.useCreation)(()=>n===P.BRC20_INSCRIBE?{chainId:m,coinType:ge(m),symbol:o}:null,[n,r,o,m]),D=wt(void 0,{},I)?.coinId,O=(0,gt.useCallback)(async()=>{await y(J(t.id)),await y(nt()),w.push(Ht)},[y,w,t.id]),F=(0,gt.useCallback)(()=>{C($t.CONFIRM),to=$t.CONFIRM},[]),N=(0,gt.useCallback)(async({txIds:U,commitTx:v,revealTxs:Pt})=>{await y(at(t.id,{txIds:U,commitTx:v,revealTxs:Pt})),await y(nt()),w.push(Ht)},[y,w,t.id]),b=(0,gt.useCallback)(()=>{C($t.AMOUNT),to=$t.AMOUNT},[]);return gt.default.createElement(In,{fromAddress:e,coinId:D},B===$t.AMOUNT?gt.default.createElement(gn,{amount:l,walletId:t.walletId,onCancel:O,onConfirm:F,headerProps:{closeable:!1,backable:!1}}):gt.default.createElement(Cn,{txSource:c,onCancel:O,onConfirm:N,walletId:t.walletId,headerProps:{onBack:b,closeable:!1,backable:!0}}))}var Fn=kr;s();a();var _=d(W()),sr=d(re()),ar=d(Ve());R();s();a();var eo=d(W()),Mn=d(bt());s();a();function vn(t=[]){if(!Array.isArray(t))throw new Error("assetChange should be an array");return t.map(e=>{let{direction:n,amount:o,usdAmount:r,symbol:l,logo:c}=e;return{operator:n===1?"+":"-",usdValue:r,rawValue:o,asset:{assetType:Ro.NATIVE,amount:o,symbol:l,imageUrl:c}}})}var Lr=({address:t,hexStringList:e=[],chainIndex:n=0},o={})=>{let r=e?.toString(),l={ready:n!==void 0&&!!e?.length,refreshDeps:[t,r,n],...o},{loading:c,data:p,error:B}=(0,Mn.useRequest)(async()=>(await qo({address:t,hexStringList:e,chainIndex:n})).data,l);return{loading:c,data:p,error:B}},Pr=t=>(0,eo.useMemo)(()=>!t||!t.length?[]:t.map(e=>{let{assetChange:n=[],assetInversion:o}=e;return{status:e.analysisStatus,gasFee:e?.gasFee||0,isShowFee:e?.isShowFee,exploreUrl:e?.exploreUrl,inputInfo:e?.inputInfo||[],outputInfo:e?.outputInfo||[],assetChange:vn(n),assetInversion:o||!1}}),[t]),Fr=(t=[])=>(0,eo.useMemo)(()=>!t||!t.length?null:t.some(n=>n.status>0)?Et.EXECUTE_ERROR:null,[t]);function Dn(t={},e={}){let{loading:n,data:o,error:r}=Lr(t,e),{utxoAllInfos:l}=o||{},c=Pr(l),p=Fr(c);return{loading:n,error:r||p,data:c}}s();a();var dt=d(W()),Me=d(bt());R();s();a();var j=d(W()),oo=d(bt());R();s();a();R();var On=t=>{typeof t!="string"&&(t=t.toString());let e=t?.length;return e<=9?36:e>=10&&e<12?32:e===12?30:e>=13&&e<=15?24:e>=16&&e<=18?20:e>=19&&e<=24?16:12},Un=(t,e)=>t?!1:e===""?!0:!A.gte(`${e||0}`,0);s();a();var ht={AuthorizationToken:"_AuthorizationToken_g68hx_1",authorizationToken:"_AuthorizationToken_g68hx_1",title:"_title_g68hx_1",content:"_content_g68hx_4",unlimited_text:"_unlimited_text_g68hx_13",unlimitedText:"_unlimited_text_g68hx_13",balance:"_balance_g68hx_17",amount:"_amount_g68hx_22",checkAll:"_checkAll_g68hx_26",checkAll__text:"_checkAll__text_g68hx_30",checkAllText:"_checkAll__text_g68hx_30",footerActions:"_footerActions_g68hx_33"};s();a();var vr=({chainId:t,address:e,walletId:n})=>{let o=wt(void 0,void 0,{chainId:t,address:e}),{coinId:r}=o||{};return en(r,n)},Wn=vr;var Mr=({txType:t,chainId:e,address:n,walletId:o,authAmount:r,onConfirm:l})=>{let c=Wn({chainId:e,address:n,walletId:o}),{symbol:p,decimals:B}=c||{},C=sn(p,10),y=t===P.INCREASE_ALLOWANCE?"extension_approve_text_increase_approvals":"wallet_contract_interaction_approval_permission_authorized_amount",w=Uo(r),[f,m]=(0,j.useState)(!1),[I,E]=(0,j.useState)(w?"0":r),D=(0,j.useMemo)(()=>Un(f,I),[f,I]),O=(0,oo.useMemoizedFn)(async()=>{l?.(f?Oo:I)}),F=(0,oo.useMemoizedFn)(()=>{E(c?.coinAmount)}),N=A.thousandFormat(c?.coinAmount);return j.default.createElement(u.FlexBox,{className:ht.AuthorizationToken,direction:u.DIRECTION.vertical,align:u.ALIGN.center},j.default.createElement(T.Text,{strong:700,className:ht.title},i(y)),j.default.createElement(u.Box,{className:ht.content},f?j.default.createElement(T.Text,{strong:500,size:T.SIZE.xl,className:ht.unlimited_text},i("wallet_extension_transfer_title_unlimited_amount",{token:C})):j.default.createElement(Zo,{symbol:C,autoSize:On,placeholder:"0",decimals:B||0,value:I,onChange:E,style:{fontWeight:500,height:"48px"}}),!!Number(c?.coinAmount)&&j.default.createElement(T.Text,{nowrap:!0,type:T.TYPE.secondary,size:T.SIZE.xs,onClick:F,className:ht.balance},i("wallet_extension_transfer_dialog_text_balance_amount",{amount:j.default.createElement(T.Text,{inherit:!0,component:"span",className:ht.amount,ellipsis:{tooltip:N}},N),token:C}))),j.default.createElement(xo,{className:ht.checkAll,checked:f,textClass:ht.checkAll__text,onChange:({target:{checked:b}})=>{m(b)}},i("wallet_extension_transfer_dialog_checkbox_set_to_unlimited")),j.default.createElement(Dt.FooterActions,{affixStyle:{position:"none"},placeholder:!1,className:ht.footerActions},j.default.createElement(z,{disabled:D,category:z.CATEGORY.fill,type:z.TYPE.primary,size:z.SIZE.lg,onClick:O},i("commonall_filter_btn_save"))))},zn=Mr;s();a();var ve={edit_btn:"_edit_btn_rw6lw_1",editBtn:"_edit_btn_rw6lw_1",authorization_token_dialog:"_authorization_token_dialog_rw6lw_5",authorizationTokenDialog:"_authorization_token_dialog_rw6lw_5",authorization_token_dialog__content:"_authorization_token_dialog__content_rw6lw_5",authorizationTokenDialogContent:"_authorization_token_dialog__content_rw6lw_5"};var Dr=t=>{let[e,{toggle:n}]=(0,Me.useBoolean)(!1),{txType:o,loading:r,dappInfo:l,walletId:c,analyzeRet:p,approveToken:B,onAuthTokenAmountChange:C,showDappInfo:y=!0,noFold:w=!1}=t,{approveList:f,assetChange:m=[]}=p,I=f?.[0]||{},E=(0,Me.useMemoizedFn)(D=>{n(),C?.(D)});return r?dt.default.createElement(cn,null):nn(o)?dt.default.createElement(pn,{approveInfo:I}):on(o)?dt.default.createElement(dt.default.Fragment,null,dt.default.createElement(un,{approveInfo:I,authAmount:B?.authAmount,editBtnSlot:[P.AUTHORIZATION,P.INCREASE_ALLOWANCE].includes(I?.approvalType)?dt.default.createElement(z,{size:z.SIZE.xs,type:z.TYPE.primary,category:z.CATEGORY.outline,className:ve.edit_btn,onClick:n},i("wallet_extension_transfer_text_edit")):null}),dt.default.createElement(vt,{alignBottom:!0,noContentPadding:!0,visible:e,onClose:n,className:ve.authorization_token_dialog,windowClass:ve.authorization_token_dialog__content},dt.default.createElement(zn,{txType:o,walletId:c,...B,onConfirm:E}))):rn(o)?dt.default.createElement(mn,{assetChange:m,dappInfo:l,showDappInfo:y,noFold:w}):y?dt.default.createElement(X,null,dt.default.createElement(ln,{...l})):null},De=Dr;s();a();var g=d(W()),ue=d(Ce());R();s();a();var pe=d(W());var Gn=d(Ar());R();var no=d(bt());s();a();var Yn={address:"_address_11ipy_1"};function ro({children:t,addresses:e=[],exploreUrl:n=""}){let o=e[0],r=(0,no.useMemoizedFn)(()=>{(0,Gn.default)(o),yo.success({title:i("wallet_receive_toast_address_copied"),desc:""})},[o]),l=(0,no.useMemoizedFn)(()=>{n&&globalThis.platform.openTab({url:`${n}${o}`})},[o,n]);return e.length>1?t:pe.default.createElement(je.WhiteBoard,{rebirthPopper:!0,popupStyle:{marginLeft:16,marginRight:16,padding:12,borderRadius:8},content:pe.default.createElement(u.FlexBox,{align:u.ALIGN.center,justify:"center"},pe.default.createElement(T.Text,{forceWrap:!0,size:T.SIZE.sm,className:Yn.address},o),pe.default.createElement(ot,{size:ot.SIZE.xs,icon:"okds-copy",onClick:r,style:{marginLeft:8}}),pe.default.createElement(ot,{size:ot.SIZE.sm,icon:"okx-wallet-plugin-open-link",onClick:l,style:{marginLeft:8}})),trigger:je.TRIGGER.hover},t)}s();a();we();function io(t){return t===Eo.XRC_NFT}s();a();var M={content:"_content_1i550_1",none:"_none_1i550_4",title:"_title_1i550_10",input:"_input_1i550_15",utxoContainer:"_utxoContainer_1i550_18",isCurrentAddr:"_isCurrentAddr_1i550_18",signTag:"_signTag_1i550_18",addrContainer:"_addrContainer_1i550_24",address:"_address_1i550_29",amount:"_amount_1i550_38",xrcAssetsContainer:"_xrcAssetsContainer_1i550_50",xrcAssetsTitle:"_xrcAssetsTitle_1i550_56",xrcAssetContainer:"_xrcAssetContainer_1i550_62",logo:"_logo_1i550_65",isNFT:"_isNFT_1i550_72",isNft:"_isNFT_1i550_72",amountText:"_amountText_1i550_75",protocol:"_protocol_1i550_78",moreXRCContainer:"_moreXRCContainer_1i550_85",moreXrcContainer:"_moreXRCContainer_1i550_85",showMoreTitle:"_showMoreTitle_1i550_89",moreAssetsLogos:"_moreAssetsLogos_1i550_95",moreAssetsLogo:"_moreAssetsLogo_1i550_95",expandContainer:"_expandContainer_1i550_106",expandContainer_title:"_expandContainer_title_1i550_110",expandContainerTitle:"_expandContainer_title_1i550_110",expandContainer_leftTotal:"_expandContainer_leftTotal_1i550_116",expandContainerLeftTotal:"_expandContainer_leftTotal_1i550_116",expandContainer_icon:"_expandContainer_icon_1i550_123",expandContainerIcon:"_expandContainer_icon_1i550_123"};var so="inputInfo",Xn="outputInfo",Oe={xrcAsset:10,utxo:50},Or=({coinId:t,data:e={},currentAddr:n})=>{let[o,r]=(0,g.useState)({}),[,l]=Ho(t,{withPrice:!0}),c=(0,g.useMemo)(()=>[so,Xn].map(m=>{let I=e[m]||[],E=o[m]||!1;return I.map((D,O)=>{let F=o[`${m}-${O}`]||!1,N=D.xrcAssets||[];return D.xrcToShow=F?N:N.slice(0,Oe.xrcAsset),D.moreXRC=N.slice(Oe.xrcAsset),D}),{key:m,exploreUrl:e.exploreUrl,allData:I,dataToShow:E?I:I.slice(0,Oe.utxo),moreData:I.slice(Oe.utxo)}}),[e,o]),p=(0,g.useCallback)((f=[])=>f.reduce((m,{amount:I})=>A.add(m,I),0),[]),B=(0,g.useCallback)(f=>{switch(f){case so:return i("wallet_extension_asset_input_inputs_num",{amount:c[0].allData.length});case Xn:return i("wallet_extension_asset_outputs",{amount:c[1].allData.length});default:return""}},[c]),C=(0,g.useCallback)(f=>{r(m=>({...m,[f]:!0}))},[]),y=f=>{let{protocolType:m}=f||{};return io(m)?f.logo||ho:f.logo||wo},w=g.default.memo(({xrcAssets:f=[]})=>g.default.createElement(u.FlexBox,{align:u.ALIGN.center,className:M.moreAssetsLogos},f.slice(0,3).map(m=>g.default.createElement("img",{className:M.moreAssetsLogo,src:m.logo||"",alt:m.symbol}))));return g.default.createElement(Be,{copyable:!1,title:i("wallet_extension_asset_btn_transaction_details")},c.map(f=>g.default.createElement("div",{className:(0,ue.default)(M.content,f.key===so?M.input:"",f.dataToShow.length===0?M.none:"")},g.default.createElement("div",{className:(0,ue.default)(M.title)},B(f.key)),f.dataToShow.map((m,I)=>g.default.createElement(g.default.Fragment,null,g.default.createElement(u.FlexBox,{align:u.ALIGN.center,justify:"space-between",className:(0,ue.default)(M.utxoContainer,n===m.address[0]?M.isCurrentAddr:"")},g.default.createElement("div",{className:(0,ue.default)(M.addrContainer)},g.default.createElement(ro,{addresses:m.address,exploreUrl:f.exploreUrl},g.default.createElement("div",{className:M.address},m.address.length>1?i("wallet_extension_asset_title_multisig"):uo(m.address[0]))),g.default.createElement(Io,{className:M.signTag,size:Ke.SIZE.sm},i("wallet_extension_asset_tag_sign"))),g.default.createElement("div",{className:M.amount},g.default.createElement(T.DisplayAmount,{noStyle:!0,amount:m.amount,mode:T.CRYPTO,symbol:l?.symbol,decimals:l?.decimals}))),m.xrcToShow.length>0&&g.default.createElement("div",{className:M.xrcAssetsContainer},g.default.createElement(T.Text,{size:T.SIZE.xs,className:M.xrcAssetsTitle},i("wallet_extension_asset_include_asset")),m.xrcToShow.map(E=>g.default.createElement(u.FlexBox,{align:u.ALIGN.center,className:M.xrcAssetContainer},g.default.createElement("img",{className:(0,ue.default)(M.logo,io(E.protocolType)?M.isNFT:""),src:y(E),alt:E.symbol}),g.default.createElement(T.Text,{nowrap:!0,size:T.SIZE.xs,ellipsis:{tooltip:!0},className:M.amountText},`${E.amount} ${E.symbol}`),g.default.createElement(Co,{className:M.protocol,size:Ke.SIZE.sm},E.protocolName))),m.moreXRC.length>0&&!o[`${f.key}-${I}`]?g.default.createElement(u.FlexBox,{align:u.ALIGN.center,onClick:()=>{C(`${f.key}-${I}`)},className:M.moreXRCContainer},g.default.createElement(w,{xrcAssets:m.moreXRC}),g.default.createElement("div",{className:M.showMoreTitle},i("wallet_extension_asset_btn_show_num_asset",{amount:A.thousandFormat(m.moreXRC.length)})),g.default.createElement(ot,{icon:"okds-arrow-chevron-down-md",size:ot.SIZE.xs})):null))),f.moreData.length>0&&!o[f.key]?g.default.createElement("div",{className:M.expandContainer,onClick:()=>{C(f.key)}},g.default.createElement(u.FlexBox,{align:u.ALIGN.center,justify:"space-between"},g.default.createElement("div",{className:M.expandContainer_title},i("wallet_extension_asset_more_amount_inputs",{amount:A.thousandFormat(f.moreData.length)})),g.default.createElement(u.FlexBox,null,g.default.createElement("div",{className:M.expandContainer_leftTotal},g.default.createElement(T.DisplayAmount,{noStyle:!0,amount:p(f.moreData),mode:T.CRYPTO,symbol:l?.symbol,decimals:l?.decimals})),g.default.createElement(ot,{icon:"okds-arrow-chevron-down-md",size:No.xs,className:M.expandContainer_icon})))):null)))},qn=Or;s();a();var Z=d(W()),Hn=d(Ce());R();s();a();var lt={main:"_main_asg9r_1",title:"_title_asg9r_8",scrollArea:"_scrollArea_asg9r_17",item:"_item_asg9r_22",subTitle:"_subTitle_asg9r_25",content:"_content_asg9r_32",loading:"_loading_asg9r_38",arrow:"_arrow_asg9r_43",icon:"_icon_asg9r_48"};function Ur({psbts:t=[],loading:e,onClick:n}){let o=(0,Z.useCallback)(l=>{n(l)},[n]),r=()=>e?Z.default.createElement("div",{className:lt.scrollArea},Z.default.createElement("div",{className:lt.loading},Z.default.createElement(fo.Circle,null))):t.length===0?Z.default.createElement(To.State,{className:lt.empty}):Z.default.createElement("div",{className:lt.scrollArea},(t||[]).map((l,c)=>Z.default.createElement(u.FlexBox,{className:lt.item,align:u.ALIGN.center,key:l,onClick:()=>{o(c)}},Z.default.createElement(u.FlexBox,{className:lt.content,direction:u.DIRECTION.vertical},Z.default.createElement("div",{className:lt.subTitle},i("wallet_extension_asset_transaction_confirmation",{amount:Je(c+1)})),Z.default.createElement("div",{className:lt.content},_o(l))),Z.default.createElement("div",{className:lt.arrow},Z.default.createElement(ot,{className:(0,Hn.default)("okx-wallet-plugin-arrow-small-right",lt.icon)})))));return Z.default.createElement(u.FlexBox,{className:lt.main},Z.default.createElement("div",{className:lt.title},i("",{number:Je(t.length)})),r())}var Zn=(0,Z.memo)(Ur);Fo();ne();s();a();var xt=d(W()),Rn=d(Ce());R();s();a();var Ut={main:"_main_1w6ta_1",box:"_box_1w6ta_6",tipImg:"_tipImg_1w6ta_12",tipImgIcon:"_tipImgIcon_1w6ta_21",title:"_title_1w6ta_25",decs:"_decs_1w6ta_33",w100:"_w100_1w6ta_39",footerWrap:"_footerWrap_1w6ta_42"};var Wr=({visible:t,onCancel:e,onConfirm:n,headerProps:o,psbtHasMultiXRCAsset:r,paymentUseXRCAsset:l,assetInversion:c})=>{let p=(0,xt.useMemo)(()=>r?i("wallet_extension_tip_multiple_inscription_use"):l?i("wallet_extension_desc_inscription_asset"):c?i("wallet_extension_transaction_desc_risky_greater_pay"):"",[c,l,r]);return xt.default.createElement(vt,{visible:t,alignBottom:!0,noMargin:!0,maskClosable:!0,noContentPadding:!0,transitionProps:{type:"slide",placement:"bottom",timeout:300},confirmBtnProps:{size:z.SIZE.lg},cancelBtnProps:{size:z.SIZE.lg},cancelText:i("wallet_extension_function_btn_continue_transaction"),confirmText:i("wallet_extension_mid_dialog_btn_cancel"),onCancel:e,onConfirm:n,onClose:e},xt.default.createElement(u.FlexBox,{className:Ut.main,direction:u.DIRECTION.vertical},xt.default.createElement(u.Box,{className:Ut.box},xt.default.createElement(u.Box,{className:Ut.tipImg},xt.default.createElement(Ie,{className:(0,Rn.default)("okx-wallet-plugin-risk-trading",Ut.tipImgIcon)})),xt.default.createElement(T.Text,{className:Ut.title,align:T.ALIGN.center},i("wallet_extension_title_transaction_risk")),xt.default.createElement(T.Text,{className:Ut.decs,size:T.SIZE.sm,align:T.ALIGN.center},p)),xt.default.createElement(u.Box,{className:Ut.w100},xt.default.createElement(De,{...o,showDappInfo:!1,loading:!1,noFold:!0}))))},$n=Wr;s();a();br();Er();var Ue=d(W()),zr=()=>{let[t,e]=(0,Ue.useState)(""),n=async()=>{let{data:o}=await Lo(Po.getSignPrompt);o.assetReminder?e(o.assetReminder):e(null)};return(0,Ue.useEffect)(()=>{n()},[]),{assetReminder:t}},Vn=zr;s();a();var jn=d(W());R();var Yr=({onConfirm:t})=>(0,jn.useCallback)(()=>{vt.warn({title:i("wallet_extension_asset_alertbanner_title_alert"),alignBottom:!1,maskClosable:!1,hideCloseBtn:!0,text:i("wallet_extension_asset_alertbanner_desc_utxo_lost"),confirmBtnProps:{type:z.TYPE.outline,size:z.SIZE.lg},cancelBtnProps:{type:z.TYPE.highlight,size:z.SIZE.lg},onConfirm(e){e.destroy(),t()},async onCancel(e){e.destroy()},cancelText:i("commonall_text_btn_cancel"),confirmText:i("wallet_extension_asset_btn_continue")})},[t]),Kn=Yr;s();a();var _e=d(W());s();a();var q=d(W()),ao=d(Ce());s();a();var Tt={main:"_main_1fewt_1",box:"_box_1fewt_6",isPureScreen:"_isPureScreen_1fewt_12",tipImg:"_tipImg_1fewt_15",tipImgIcon:"_tipImgIcon_1fewt_24",title:"_title_1fewt_28",decs:"_decs_1fewt_36",extLink:"_extLink_1fewt_42",footerWrap:"_footerWrap_1fewt_46",screenOneButtons:"_screenOneButtons_1fewt_49",extButton:"_extButton_1fewt_53"};var Jn=t=>{let{children:e,desc:n,title:o,isPureScreen:r}=t;return q.default.createElement(u.FlexBox,{className:Tt.main,direction:u.DIRECTION.vertical},q.default.createElement(u.Box,{className:(0,ao.default)(Tt.box,{[Tt.isPureScreen]:r})},q.default.createElement(u.Box,{className:Tt.tipImg},q.default.createElement(Ie,{className:(0,ao.default)("okx-wallet-plugin-risk-trading",Tt.tipImgIcon)})),q.default.createElement(T.Text,{className:Tt.title,align:T.ALIGN.center},o),q.default.createElement(T.Text,{className:Tt.decs,size:T.SIZE.sm,align:T.ALIGN.center},n)),q.default.createElement(u.Box,{className:Tt.footerWrap},e))},Gr=({modalParams:t,handleCancel:e,handleNext:n})=>{let{screenOne:o,screenTwo:r}=t,[l,c]=(0,q.useState)(!1),p=async()=>{c(!0),await e(),c(!1)};return q.default.createElement(Jn,{desc:o.desc,title:o.title},q.default.createElement(u.Box,{className:Tt.screenOneButtons},q.default.createElement(z,{block:!0,loading:l,size:z.SIZE.lg,onClick:p,type:z.TYPE.highlight,category:z.CATEGORY.fill},o.mainBtnText),r?q.default.createElement(u.Box,{className:Tt.extButton,onClick:n},o.subBtnText):null))},Xr=({handleCancel:t,handleNext:e,modalParams:n})=>{let{screenTwo:o={}}=n,r=[{actionType:G.ACTION_TYPE.CANCEL,btnText:o.subBtnText,onClick:e},{actionType:G.ACTION_TYPE.CONFIRM,btnText:o.mainBtnText,onClick:t}];return q.default.createElement(Jn,{isPureScreen:!0,desc:o.desc,title:o.title},q.default.createElement(u.Box,{className:Tt.screenTwoButtons},q.default.createElement(G,{buttonGroup:r})))},qr=({handleCancel:t,closeModal:e,modalParams:n})=>{let[o,r]=(0,q.useState)(1);return o===2?q.default.createElement(Xr,{modalParams:n,handleCancel:t,handleNext:e}):q.default.createElement(Gr,{modalParams:n,handleCancel:t,handleNext:()=>{r(2)}})},Qn=qr;s();a();var er=d(W());R();s();a();var tr={extLink:"_extLink_1eb1z_1"};var Hr=()=>{let t=Xo(),e=r=>({title:i("wallet_extension_fractal_title_transaction_risky"),desc:i(r,{case:er.default.createElement(Ao,{className:tr.extLink,href:t?.scamsUrl},i("wallet_extension_function_link_case"))}),mainBtnText:i("wallet_extension_function_btn_cancel"),subBtnText:i("wallet_extension_function_btn_advanced")}),n={title:i("wallet_extension_fractal_title_transaction_risky"),desc:i("wallet_extension_function_desc_developer_continue"),mainBtnText:i("wallet_extension_mid_dialog_btn_cancel"),subBtnText:i("wallet_extension_function_btn_continue_transaction")};return{getUTXONotFoundModalParams:()=>({screenOne:e("wallet_extension_fractal_desc_transaction_risky"),screenTwo:n})}},or=Hr;var Zr=({psbtsInfoErr:t,handleCancel:e})=>{let{getUTXONotFoundModalParams:n}=or(),o=(0,_e.useRef)(),r=l=>{o.current||(o.current=vt.action({hideCloseBtn:!0,maskClosable:!1,noContentPadding:!0,children:_e.default.createElement(Qn,{modalParams:l,handleCancel:async()=>{await e(),o.current.destroy(),o.current=null},closeModal:()=>{o.current.destroy(),o.current=null}})}))};(0,_e.useEffect)(()=>{t?.code==Et.UTXO_NOT_FOUND&&r(n())},[t])},nr=Zr;s();a();R();s();a();var lo=d(Wo());var rr=t=>{try{return lo.Psbt.fromHex(t).toBase64()}catch{return lo.Psbt.fromBase64(t),t}};var We=d(Wo()),Bt={LIST:"list",UNLIST:"unlist",TRADE:"trade",RUNES:"runes"},ir=t=>{try{let e=We.Psbt.fromBase64(rr(t)),n=e?.data?.inputs||[],o=e?.data?.globalMap?.unsignedTx?.tx?.outs||[],r=[];return n.forEach((l,c)=>{if(l.witnessUtxo)r.push({...l,value:l.witnessUtxo.value});else if(l.nonWitnessUtxo){let p=We.Transaction.fromBuffer(l.nonWitnessUtxo),B=e?.data?.globalMap?.unsignedTx?.tx?.ins||[],y=p.outs[B[c]?.index]?.value;r.push({...l,value:y})}}),{inputs:r,outputs:o}}catch{return{inputs:[],outputs:[]}}},Wt=(t,e=0,n)=>!Array.isArray(t)||n===0?0:t.slice(e,n?e+n:void 0).reduce((o,{value:r})=>A.add(o,r),0);var lr=({unapproved:t})=>{let{psbt:e,psbts:n,type:o,from:r,amount:l=1,psbtOpts:c,broadcast:p=!1}=t.params.transaction,{origin:B}=t,C=t.method===K.SIGNPSBTS,y=t?.walletId,w=t?.localType,m=ft({localType:w})?.coinId;m===void 0&&(m=It(w));let I=ie(y),E=se(y),D=ce(y),{loading:O,data:F,error:N}=Dn({address:r,hexStringList:C?n:[e],chainIndex:oe(w)}),[b,U]=(0,_.useState)(!1),[v,Pt]=(0,_.useState)(0),H=(0,_.useMemo)(()=>C&&!b,[C,b]),S=(0,_.useMemo)(()=>F[v]||{},[F,v]),{assetReminder:Ct}=Vn(),k=(0,sr.useDispatch)(),yt=(0,ar.useHistory)(),rt=an(t),{name:mt,icon:it,host:Nt}=rt,{inputs:Vt,outputs:tt}=ir(C?n[v]:e),st=(0,_.useMemo)(()=>A.sub(Wt(Vt),Wt(tt)),[Vt,tt]),ct=wn(),jt=(0,_.useMemo)(()=>{if(o!==Bt.TRADE&&o!==Bt.RUNES)return null;let V=Number(l);if(o===Bt.RUNES){let te=Wt(tt,1,V),ee=A.add(Wt(tt,0,1),Wt(tt,tt.length-V+1,V-1));return`${A.sub(ee,A.add(te,st))}`}let St=Wt(tt,V+1,V),pt=Wt(tt,1,V);return`${A.sub(pt,A.add(St,st))}`},[l,st,tt,o]),Ft=(0,_.useMemo)(()=>I&&C?{type:Q.TIP_TYPE.COMMON_ERROR,message:i("extension_wallet_contractual_interaction_wallet_unavailable")}:E?{type:Q.TIP_TYPE.COMMON_ERROR,message:i("wallet_extension_top_toast_dapp_comingsoon")}:N?{type:Xt.TYPE.warn,message:i("wallet_extension_asset_alert_trust_network")}:Ct&&!B?.includes("okx.com")?{type:Xt.TYPE.warn,message:Ct}:{},[E,I,Ct,N,B]),At=(0,_.useCallback)(async()=>{await k(J(t.id)),await k(nt()),await xe(k)},[k,t.id]),et=(0,_.useCallback)(async()=>{if(!await ae({walletId:y,callback:async()=>{await k(J(t.id))}}))return;let St=co(w);try{let pt=await zo(C?n:e,r,y,{localType:St,isPsbts:C},c);await k(at(t.id,{signedTx:pt,broadcast:p}))}catch(pt){await ct({id:t.id,error:pt?.message||"Error"})}await k(nt()),yt.push(Ht)},[yt,r,ct,k,C,w,e,c,n,t.id,y]);nr({psbtsInfoErr:N,handleCancel:At});let zt=Kn({onConfirm:et}),[Yt,Kt]=(0,_.useState)(!1),Jt=(0,_.useMemo)(()=>{let V=S?.inputInfo||[],St=S?.outputInfo||[],pt=V.filter(ut=>ut.address?.includes(r)),te=St.filter(ut=>ut.address?.includes(r)),ee=[],ye=[];return pt.forEach(ut=>{ut.xrcAssets&&ut.xrcAssets.forEach(_t=>{ee.some(de=>de.symbol===_t.symbol&&de.protocolId===_t.protocolId)||ee.push({symbol:_t.symbol,protocolId:_t.protocolId})})}),te.forEach(ut=>{ut.xrcAssets&&ut.xrcAssets.forEach(_t=>{ye.some(de=>de.symbol===_t.symbol&&de.protocolId===_t.protocolId)||ye.push({symbol:_t.symbol,protocolId:_t.protocolId})})}),ee.length>0&&ye.length>0?!ee.every(ut=>ye.some(_t=>ut.symbol===_t.symbol&&ut.protocolId===_t.protocolId)):!1},[S,r]),fe=(0,_.useMemo)(()=>{let V=S.inputInfo||[],St=S.outputInfo||[];return[...V,...St].some(pt=>!!(pt.xrcAssets&&pt.xrcAssets.length>1))},[S]),$=(0,_.useMemo)(()=>F.some(V=>{let St=V.inputInfo||[],pt=V.outputInfo||[];return[...St,...pt].some(te=>!!(te.xrcAssets&&te.xrcAssets.length>1))}),[F]);(0,_.useEffect)(()=>{H||(fe||Jt||S.assetInversion)&&Kt(!0)},[F,H,fe,Jt,S.assetInversion]);let Gt=(0,_.useCallback)(()=>{if(!$||!H){et();return}zt()},[$,et,zt,H]),qe=(0,_.useCallback)(V=>{U(!0),Pt(V)},[U]),He=(0,_.useMemo)(()=>[{actionType:G.ACTION_TYPE.CANCEL,btnText:H?i("wallet_extension_asset_btn_cancel_all"):i("wallet_dapp_connection_btn_reject"),onClick:At},{disabled:E||O||Ft.type===Q.TIP_TYPE.COMMON_ERROR,actionType:G.ACTION_TYPE.CONFIRM,btnText:H?i("wallet_extension_asset_btn_confirm_all"):i("extension_transactions_btn_confirm"),onClick:Gt}],[E,At,Ft,H,O]),Ze=(0,_.useMemo)(()=>{switch(o){case Bt.LIST:return i("extension_wallet_transfer_maintitle_list");case Bt.UNLIST:return i("extension_wallet_transfer_maintitle_cancel_listing");case Bt.TRADE:return i("extension_wallet_transfer_maintitle_transaction");default:return i("extension_wallet_transfer_maintitle_transaction")}},[o]),Qt=(0,_.useMemo)(()=>o==="list"||S&&!S.isShowFee?!1:A.gt(S.gasFee,0)||A.gt(st,0),[st,S,o]),Ir=(0,_.useMemo)(()=>!N||N===Et.EXECUTE_ERROR&&S.status!==Et.PSBT_ANALYSIS_FAILED,[N,S]),wr=(0,_.useMemo)(()=>N&&N!==Et.EXECUTE_ERROR||S?.status===Et.PSBT_ANALYSIS_FAILED,[N,S]);return _.default.createElement(u.Container,null,_.default.createElement(Ot,{title:Ze,backable:C&&b,closeable:!1,onBack:()=>{U(!1)}}),H?_.default.createElement("div",null,_.default.createElement(X,null,_.default.createElement(Qe,{summaryList:[{title:mt,desc:Nt,icon:{src:it}}],title:i("extension_contract_interaction_maintitle_request_from")})),_.default.createElement(Zn,{psbts:n,loading:O,onClick:qe})):null,H?null:_.default.createElement(_.default.Fragment,null,Ir&&_.default.createElement(De,{coinId:m,txType:P.TRANS_OUT,loading:O,dappInfo:{name:mt,host:Nt,icon:it},analyzeRet:S}),wr&&_.default.createElement(X,null,(o===Bt.TRADE||o===Bt.RUNES)&&_.default.createElement(le,{summaryList:[{coinId:m,coinAmount:jt}],tooltip:i("extension_infor_tooltip_asset_changestips"),title:i("extension_contract_interaction_maintitle_asset_changes")}),_.default.createElement(Qe,{summaryList:[{title:mt,desc:Nt,icon:{src:it}}],title:i("extension_contract_interaction_maintitle_request_from")})),Qt&&_.default.createElement(X,null,_.default.createElement(me,{coinId:m,networkFee:S.gasFee||st})),_.default.createElement(X,null,_.default.createElement(Rt,{title:i("wallet_extension_network_address_title_walletused"),address:r,walletId:y,onCopyCallback:()=>{D({trade:"approve",all_confirmation:"wallet_used_address"})}})),!Qt&&_.default.createElement(X,null,_.default.createElement(Nn,{coinId:m})),_.default.createElement(X,null,_.default.createElement(qn,{coinId:m,data:S,currentAddr:r})),_.default.createElement(X,null,_.default.createElement(Be,{data:C?n[v]:e,copyable:{hideDesc:!0}}))),b?null:_.default.createElement(Dt,{placeholder:!0,offsetBottom:0,borderTop:!0},_.default.createElement(Q,{coinId:m,...Ft}),_.default.createElement(G,{buttonGroup:He})),_.default.createElement($n,{visible:Yt,onCancel:()=>{Kt(!1)},onConfirm:()=>{Kt(!1),At()},headerProps:{coinId:m,txType:P.TRANS_OUT,analyzeRet:S},psbtHasMultiXRCAsset:fe,paymentUseXRCAsset:Jt,assetInversion:S.assetInversion}))};s();a();var L=d(W()),mr=d(re()),cr=d(Ve()),pr=d(bt());R();ne();var ur=({unapproved:t})=>{let e=t.walletId,{localType:n}=t,r=ft({localType:n})?.coinId;r===void 0&&(r=It(n));let l=se(e),{memo:c,value:p,memoPos:B,to:C,satBytes:y,from:w,extraParams:f}=t.params.transaction,m=wt(r),[I,{toggle:E}]=(0,pr.useBoolean)(!1),[D,O]=(0,L.useState)(y?{level:Mt.CUSTOM,satBytes:y}:{}),F=D?.satBytes,N=(0,mr.useDispatch)(),b=(0,cr.useHistory)(),[,U]=he({coinId:r,address:w,chainId:m?.chainId}),v=U?.transferReminder;(0,L.useEffect)(()=>{if(!F&&U?.normal&&O({level:Mt.STANDARD,satBytes:U?.normal}),F&&D?.level!==Mt.CUSTOM){let et=U[Ee[D?.level]?.satBytes];O({...D,satBytes:et})}},[U]);let[Pt,H]=Ae({coinId:r,walletId:e,address:w,satBytes:F},{}),S=ce(e),[Ct,k,yt]=Jo({coinId:r,toAddr:C,walletId:e,fromAddr:w,satBytes:F,coinAmount:p,canTransferAmount:H},{}),rt=(0,L.useMemo)(()=>H===void 0||k===void 0?!0:A.gte(H,A.add(k,p)),[H,p,k]),mt=Se({coinId:r,txType:P.TRANS_OUT,address:w}),it=Qo({memo:c,memoPos:B,coinId:r,toAddr:C,walletId:e,coinAmount:p,fromAddr:w,localType:m?.localType,dustSize:U?.minOutput,networkFee:k,satBytes:D.satBytes}),Nt=Vo({coinId:r,walletId:e,satBytes:F,address:w,utxoType:Zt.TRANSFER}),Vt=ie(e),[tt,st]=(0,L.useState)(!1),ct=(0,L.useCallback)(async()=>{await N(J(t.id)),await N(nt()),st(!1),b.push(Ht)},[N,b,t.id]),jt=(0,L.useCallback)(async()=>{if(!await ae({walletId:e,callback:async()=>{await N(J(t.id))}}))return;let zt=await Nt(p,k);await mt(zt,()=>{ct()}),st(!0);let Yt=await it({utxoList:zt});t.id&&(await N(at(t.id,{signedTx:Yt,coinAmount:p,serviceCharge:k,satPerByte:F,coinId:r,...f})),await N(nt())),st(!1)},[mt,p,N,k,f,Nt,ct,F,it,t.id]),Ft=(0,L.useMemo)(()=>l?{type:Q.TIP_TYPE.COMMON_ERROR,message:i("wallet_extension_top_toast_dapp_comingsoon")}:rt?yt?{type:Q.TIP_TYPE.FEE_ERROR}:{type:Xt.TYPE.warn,message:v}:{type:Q.TIP_TYPE.FEE_BALANCE_INSUFFICIENT},[yt,l,rt,v]),At=(0,L.useMemo)(()=>{let et=[{actionType:G.ACTION_TYPE.CANCEL,btnText:i("wallet_dapp_connection_btn_reject"),onClick:ct}];return rt?et=[...et,{disabled:Pt||Ct||yt||l||!Number(k),actionType:G.ACTION_TYPE.CONFIRM,onClick:jt}]:et=[...et,{coinId:r,address:w,walletId:e,actionType:G.ACTION_TYPE.FILL_UP}],et},[r,k,yt,Ct,w,l,rt,Pt,ct,jt,e]);return L.default.createElement(u.Container,null,L.default.createElement(Ot,{title:i("wallet_trade_maintitle_transaction_confirm"),backable:!1,closeable:!1}),L.default.createElement(X,null,L.default.createElement(le,{title:i("wallet_extension_send_colored_send"),summaryList:[{coinId:r,coinAmount:p}]})),L.default.createElement(X,null,L.default.createElement(Rt,{walletId:e,address:w,title:i("extension_send_mid_text_from"),onCopyCallback:()=>{S({trade:"send",all_confirmation:"wallet_used_address"})}},!!H&&L.default.createElement(ke,{coinBalance:H,coinId:r})),L.default.createElement(Rt,{address:C,title:i("extension_send_mid_text_to"),onCopyCallback:()=>{S({trade:"send",all_confirmation:"to_address"})}})),L.default.createElement(X,{bordered:!1},L.default.createElement(me,{coinId:r,loading:Ct,estimateFailed:yt,networkFee:k,level:D?.level,onClick:()=>{E(),S({trade:"send",all_confirmation:"network_fee"})}})),L.default.createElement(Dt,{placeholder:!0,offsetBottom:0,borderTop:!0},L.default.createElement(Q,{coinId:r,...Ft}),L.default.createElement(G,{buttonGroup:At})),L.default.createElement(be,{coinId:r,visible:I,signInfo:U,value:D,estimatedFee:k,onChange:O,onToggleVisible:E}),L.default.createElement(Le,{visible:Vt&&tt}))};s();a();var Te=d(W()),Tr=d(bt());we();ne();s();a();function _r(t){try{return[JSON.parse(t),null]}catch{return[null,new Error("Illegal JSON string")]}}Nr();s();a();var Ge=d(W()),dr=d(re());R();ne();s();a();var Y=d(W());R();var Ye=d(bt());s();a();var kt={"inscription-preview":"_inscription-preview_yy6vc_1",inscriptionPreview:"_inscription-preview_yy6vc_1","inscription-preview__inner":"_inscription-preview__inner_yy6vc_13",inscriptionPreviewInner:"_inscription-preview__inner_yy6vc_13","inscription-preview-text":"_inscription-preview-text_yy6vc_21",inscriptionPreviewText:"_inscription-preview-text_yy6vc_21","inscription-preview-image":"_inscription-preview-image_yy6vc_26",inscriptionPreviewImage:"_inscription-preview-image_yy6vc_26","inscription-item__content":"_inscription-item__content_yy6vc_30",inscriptionItemContent:"_inscription-item__content_yy6vc_30","inscription-exceedTip":"_inscription-exceedTip_yy6vc_34",inscriptionExceedTip:"_inscription-exceedTip_yy6vc_34","inscription-extend":"_inscription-extend_yy6vc_39",inscriptionExtend:"_inscription-extend_yy6vc_39","inscription-extend__icon":"_inscription-extend__icon_yy6vc_43",inscriptionExtendIcon:"_inscription-extend__icon_yy6vc_43"};var mo=24,ze={TEXT:"text",IMAGE:"image"},Rr=Y.default.memo(({type:t,contentType:e,body:n})=>{let[{inscriptionType:o,inscriptionContent:r},l]=(0,Ye.useSetState)({inscriptionType:ze.TEXT,inscriptionContent:n});return(0,Y.useEffect)(()=>{if(t===P.ORDINAL_NFT||e?.startsWith("image/"))try{let c=URL.createObjectURL(new Blob([n]));l({inscriptionType:ze.IMAGE,inscriptionContent:c})}catch{l({inscriptionType:ze.TEXT,inscriptionContent:n})}finally{l({initing:!1})}},[n,e,l,t]),Y.default.createElement(u.Box,{className:kt["inscription-preview"]},o===ze.IMAGE?Y.default.createElement("img",{alt:"",src:r,className:kt["inscription-preview-image"]}):Y.default.createElement(u.Box,{className:kt["inscription-preview__inner"]},Y.default.createElement(T.Text,{forceWrap:!0,className:kt["inscription-preview-text"]},r)))}),$r=({type:t,contentType:e,body:n,rawBody:o})=>{let r=(0,Y.useMemo)(()=>{let p=n?.length;return A.lt(p,1024)?`${p} B`:`${A.floorTruncate(A.div(p,1024),3)} KB`},[n?.length]),l=t===P.ORDINAL_NFT||e?.startsWith("image/"),c=l?o?.slice(0,200):o;return Y.default.createElement(u.FlexBox,null,Y.default.createElement(Rr,{type:t,body:n,contentType:e}),Y.default.createElement(u.FlexBox,{direction:u.DIRECTION.vertical,className:kt["inscription-item__content"]},Y.default.createElement(T.Text,{strong:!0,ellipsis:{tooltip:!l},size:T.SIZE.xs},c),Y.default.createElement(T.Text,{size:T.SIZE.xs,type:T.TYPE.secondary},r)))},Vr=({type:t,dataSource:e=[]})=>{let n=e?.length||0,[o,{toggle:r}]=(0,Ye.useBoolean)(!1),l=(0,Y.useMemo)(()=>o?e?.slice(0,mo):e?.slice(0,3),[e,o]),c=(0,Y.useMemo)(()=>Mo(t),[t]);return Y.default.createElement(tn,{space:16,title:i(c,{num:n})},Y.default.createElement(Go,{space:24,renderEmpty:!1,dataSource:l,renderItem:p=>Y.default.createElement($r,{...p,type:t})}),o&&n>mo&&Y.default.createElement(T.Text,{size:T.SIZE.xs,type:T.TYPE.secondary,className:kt["inscription-exceedTip"]},i("wallet_info_dialog_desc_replicate_hide",{num:A.sub(n,mo)})),n>3&&Y.default.createElement(u.FlexBox,{justify:"center",className:kt["inscription-extend"],onClick:r},Y.default.createElement(ot,{size:ot.SIZE.xs,className:kt["inscription-extend__icon"],icon:o?"okds-arrow-chevron-up-md":"okx-wallet-plugin-add-arrow-chevrons"})))},fr=Vr;function jr({unapproved:t}){let e=(0,dr.useDispatch)(),{id:n}=t,{type:o}=t.params?.transaction||{},r=vo[o],{localType:l}=t,p=ft({localType:l})?.coinId;p===void 0&&(p=It(l));let B=async()=>{await e(nt()),await e(J(t.id))},C=async w=>{await e(at(t.id,w)),await e(nt())},{inscriptions:y}=xn();return Ge.default.createElement(Tn,{txId:n,headerProps:{title:r?i(r):null,closeable:!1,backable:!1},confirmButtonProps:{onCancel:B,onConfirm:C},slot:{top:Ge.default.createElement(X,null,Ge.default.createElement(fr,{type:o,dataSource:y}))},netWorkCoinId:p})}var xr=jr;var Kr=[P.BRC20_MINT,P.BRC20_INSCRIBE,P.BRC20_DEPLOY],Jr=[P.RUNES_ETCH];function Qr(t,e){let n=Bo(e);return Kr.includes(t)?n=bo(e):Jr.includes(t)&&(n=ko(e)),n}function ti(t,e){return e.map(({contentType:n,body:o})=>{let r=o;try{(t===P.ORDINAL_NFT||typeof t!="number"&&n?.startsWith("image/"))&&(r=x.Buffer.from(o,"hex"))}catch{}return{contentType:n,body:r,rawBody:o}})}function ei({unapproved:t}){let{tick:e,type:n,from:o,to:r,txSource:l,inscriptions:c=[],amount:p,mintType:B=Do.parallel,noBroadCast:C=!1}=t.params?.transaction||{},{localType:y}=t,w=(0,Te.useMemo)(()=>ti(n,c),[n,c]),f=ft({localType:y}),m=f?.netWorkId;m===void 0?m=oe(y):m=+m;let I=f?.coinId;I===void 0&&(I=It(y));let E=(0,Tr.useCreation)(()=>{if(n===P.RUNES_ETCH){let[b,U]=_r(c[0]?.body);if(U)return{chainId:m,coinType:$e(m),symbol:e,address:"btc-runesMain-invalid-inscriptions"};let v=b?.id||"";return{chainId:m,coinType:$e(m),symbol:e,address:`btc-runesMain-${v}`}}return e?{chainId:m,coinType:ge(m),symbol:e}:null},[e,n,m]),D=Qr(n,m),O=wt(void 0,{},E),F=(b,U)=>{let v=0;if(n===P.RUNES_ETCH){b.coinAmount=Re(p,10**O?.decimals),b.coinId=O?.coinId||I,b.txSource=l||qt.DAPP;return}p&&O?.decimals&&(v=Re(p,10**O?.decimals)),b.coinAmount=v,b.coinId=U?I:O?.coinId||I,b.txSource=l||qt.DAPP},N=(b,U)=>(b&&F(b,!0),Array.isArray(U)&&U.forEach(v=>{F(v,!1)}),C);return Te.default.createElement(yn,{params:{walletId:t.walletId,utxoType:Zt.INSCRIPTION_USE_NFT_UTXO,from:o,to:r,inscriptions:w,txType:n,protocolId:D,mintType:B,netWorkCoinId:I},lifecycle:{beforePostTx:N}},Te.default.createElement(xr,{unapproved:t}))}var yr=ei;s();a();var Xe=d(W()),gr=d(re());R();Fo();var oi=({unapproved:t})=>{let e=(0,gr.useDispatch)(),{targetCoin:n}=t.params||{},o={image:n.logo,decimals:n.decimals,name:n.name,address:n.contractAddress,symbol:n.symbol},r=ce(),l=(0,Xe.useMemo)(()=>{let c={actionType:G.ACTION_TYPE.CANCEL,async onClick(){r({all_confirmation:"cancel",trade:"add_token"}),await e(J(t.id)),await xe(e)},btnText:i("wallet_dapp_connection_btn_reject")},p={actionType:G.ACTION_TYPE.CONFIRM,async onClick(){try{r({all_confirmation:"confirm",trade:"add_token"}),await Yo(n),await e(at(t.id)),await xe(e)}catch(B){go.error(B?.data?.originalError?.msg||i("wallet_extenshion_toast_add_failed"))}}};return[c,p]},[r,e,n,t.id]);return Xe.default.createElement(hn,{token:o,networkName:n.blockChain||n.localType,buttonGroup:l})},Cr=oi;var fu=({unapproved:t})=>{switch(t.method){case K.TRANSFER_NFT:case K.SEND_INSCRIPTION:return Lt.default.createElement(An,{unapproved:t});case K.SPLITUTXO:return Lt.default.createElement(En,{unapproved:t});case K.INSCRIBE:case K.INSCRIBE_TRANSFER:return Lt.default.createElement(Fn,{unapproved:t});case K.SIGNPSBT:case K.SIGNPSBTS:return Lt.default.createElement(lr,{unapproved:t});case K.SIGN_MESSAGE:return Lt.default.createElement(Bn,{unapproved:t});case K.MINT:return Lt.default.createElement(yr,{unapproved:t});case K.WATCHASSET:return Lt.default.createElement(Cr,{unapproved:t});case K.SEND:case K.SEND_BTC:return Lt.default.createElement(ur,{unapproved:t});default:return""}};export{fu as default};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=Bitcoin-J4RHATXD.js.map
