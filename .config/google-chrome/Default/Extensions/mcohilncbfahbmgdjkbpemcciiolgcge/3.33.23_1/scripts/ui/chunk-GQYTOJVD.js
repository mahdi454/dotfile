import{a as $}from"./chunk-TJW4EUGS.js";import{a as ue,b as le,d as me,g as v}from"./chunk-E2MXYP3A.js";import{I as fe,M as Ce,N as E,O as Z}from"./chunk-FPV6XIHQ.js";import{c as X,d as Y}from"./chunk-MZXFJMVC.js";import{a as J,b as D,c as ae}from"./chunk-M5PVKGM6.js";import{h as G}from"./chunk-QHZHYX4V.js";import{a as _}from"./chunk-C53RLQYB.js";import{l as z}from"./chunk-FZCNSMLW.js";import{o as H}from"./chunk-KCWFMCND.js";import{K as ce,sa as ie,w as oe}from"./chunk-3TDWET6C.js";import{Eb as R,Fb as Q,Ra as re,Wa as te,Ya as Ae,dc as V,sc as se,vc as Be}from"./chunk-O3CM75EN.js";import{F as U,K as ee,pa as Te,x as O}from"./chunk-VFHYER2K.js";import{L as ne,l as w,q as j}from"./chunk-KJIO572I.js";import{a as K}from"./chunk-EAZTJZU7.js";import{f as B,m as P,o as b}from"./chunk-ZCHLW7CF.js";P();b();var M=B(K()),C=B(H());Te();ne();P();b();var pe=B(K());V();function ye(){let e=D();return(0,pe.useCallback)(async n=>{let t=await ue(n),r={};return t&&Object.entries(t).forEach(([o,c])=>{let s=[];c.forEach(i=>{let a;"childrenCoin"in i&&i.childrenCoin?.length&&(a=i.childrenCoin?.map(l=>({...l,currencyAmount:R(l.currencyAmountUSD,e.usdToThisRate)}))),s.push({...i,childrenCoin:a,currencyAmount:R(i.currencyAmountUSD,e.usdToThisRate)})}),r[o]=s}),r},[e.usdToThisRate])}P();b();var de=B(K()),he=B(oe()),F=B(H());V();var q=()=>{let e=(0,he.useSelector)(ie),n=v();return(0,F.useCreation)(()=>{let t={},{symbol:r}=e;return Object.keys(n).forEach(o=>{t[o]={currencySymbol:r,usdPrice:n?.[o]?.coinToUSDRate,currencyPrice:R(n?.[o]?.coinToUSDRate,e?.usdToThisRate),priceChangePercent24h:n?.[o]?.coinPriceChangePercent24h}}),t},[n,e])},ge=e=>{let n=q(),t=D(),{data:r,run:o}=(0,F.useRequest)(E,{manual:!0,ready:!0,retryCount:3,staleTime:36e5,cacheTime:864e5});return(0,de.useEffect)(()=>{!n[e]&&fe(e)&&o(+e)},[n,e]),(0,F.useCreation)(()=>{let c=n[e];if(c)return c;if(r&&t){let{currencyAmount:s,priceChangePercent24h:i}=r;return{currencySymbol:t.symbol,usdPrice:s,currencyPrice:R(s,t.usdToThisRate),priceChangePercent24h:i}}return null},[n,e,t,r])};P();b();var Pe=B(oe());function I(){return(0,Pe.useSelector)(ce)}Ae();Be();V();var Ne=e=>!!e&&!Number.isNaN(e),W=(e={})=>{let n=$(),t=J(),r=I(),o=q(),c=v(),s=(0,C.useLatest)(n),i=(0,C.useLatest)(o),a=(0,C.useLatest)(c),{withPrice:l=!1,withPriceChangePercent24h:f=!1}=e||{},[p,d]=(0,M.useState)(void 0),{runAsync:g}=(0,C.useRequest)(Z,{manual:!0,cacheKey:p,retryCount:3,staleTime:36e5,cacheTime:864e5});return(0,M.useCallback)(async(h,u)=>{if(h===0||!r||Number.isNaN(h))return null;let y;if(typeof h<"u")y=s?.current?.[h];else if(u){let m=Object.values(n);if(u.aggregation&&u.symbol)return t[u.symbol]?{...t[u.symbol][0],childrenCoin:t[u.symbol]}:null;if(Y(u)){let N=j(m,u);N.length>0&&(y=N[0])}}if(!y&&h!==0){let m;typeof h<"u"&&!Number.isNaN(h)?m={coinId:h}:u&&(m=!U(u)&&Ce(u)?u:null),m&&(d(X(m)),y=await g(m))}if(!y)return null;let T;if((l||f)&&!s?.current?.[h]&&(T=await E(y.coinId)),l){let{currencySymbol:m,usdPrice:A,currencyPrice:N}=i?.current?.[h]??T??{};y={...y,currencySymbol:m,usdPrice:A,currencyPrice:N}}if(f){let m=a?.current?.[h]?.coinPriceChangePercent24h??T?.priceChangePercent24h;y={...y,priceChangePercent24h:m}}return y},[l,f,n,t,g,r])},we=(e,n,t)=>(0,C.useCreation)(()=>{let r;if(!(t||e===0)&&(typeof e<"u"&&!Number.isNaN(e)?r={coinId:e}:r=U(n)?null:n,r))return X(r)},[e,n,t]),x=(e,n={},t)=>{let r=J(),o=$(),c=I(),{withPrice:s,withPriceChangePercent24h:i}=n,a=ae(t),l=[e,o,r,a,c],f=[],p=(0,C.useCreation)(()=>{let m;if(e===0||!c||Number.isNaN(e))return null;if(typeof e<"u")m=o?.[e];else if(a){let A=Object.values(o);if(a.aggregation&&a.symbol)return r[a.symbol]?{...r[a.symbol][0],childrenCoin:r[a.symbol]}:null;if(Y(a)){let k=j(A,a);k.length>0&&(m=k[0])}}return m||null},l),d=!!p,g=we(e,a,d),{data:h,run:u}=(0,C.useRequest)(Z,{manual:!0,ready:!0,cacheKey:g,retryCount:3,staleTime:36e5,cacheTime:864e5});(0,M.useEffect)(()=>{if(!d&&c&&!!g){let m=Ne(e)?{coinId:e}:a;u(m)}},[d,c,g,e,a]);let y=p||h,T=ge(s||i?y?.coinId:null);return f.push(y,T),(0,C.useCreation)(()=>{if(!y)return null;let m=y;if(s&&T){let{currencySymbol:A,usdPrice:N,currencyPrice:k}=T;m={...m,currencySymbol:A,usdPrice:N,currencyPrice:k}}if(i){let{priceChangePercent24h:A}=T;m={...m,priceChangePercent24h:A}}return m},f)};var Me=e=>{let n=W(e),t=G(),r=me(),o=ye();return(0,C.useMemoizedFn)(async(c,s)=>{let i=await n(c);if(!i)return null;let a;s&&s!==t?a=(await o({walletIds:[s],coinId:c,chainId:i.chainId,flatten:!0}))[s]??[]:a=r;let{coinAmountInt:l="0",currencyAmount:f="0",currencyAmountUSD:p="0"}=O(a,d=>d?.coinId===c)||{};return{...i,coinAmountInt:l,currencyAmount:f,currencyAmountUSD:p,coinAmount:Q(l,10**i?.decimals)}},[r,t,n])};function Re(e,{key:n,coinId:t,addressType:r,localType:o}){return O(e,c=>{let s;if(n?s=c.key===n:s=c.coinId===t,r){let i=se[te(o)]?.[r];s=s&&i===c?.addressType}return s})}var xe=(e,n,t)=>{let{addressType:r,key:o,withBalanceStatus:c}=t||{},s=x(e,t,o?{key:o}:void 0),i=G(),a=n||i,l=le(a,{withBalanceStatus:c}),f=!1,p;c?(p=l?.balance?.coins,f=!l?.loading):(p=l?.coins,f=!!l),p=p||[];let d=(0,C.useCreation)(()=>Re(p,{key:o,coinId:e,addressType:r,localType:s?.localType}),[p,a,e,r,o,s?.localType]),{coinAmountInt:g,currencyAmount:h}=d||{};return(0,C.useCreation)(()=>{if(!s)return null;let u={...s,coinAmountInt:g,currencyAmount:h};return c&&(u.requestBalance=l?.request,u.isBalanceLoading=!f,u.isBalanceLoadError=!!l?.error),ee(g)?f?(u.coinAmountInt="0",u.coinAmount="0",u.currencyAmount="0",u.currencyAmountUSD="0",u):(u.coinAmount=void 0,u):(u.coinAmount=Q(g,10**s.decimals),u)},[s,g,f,l,c])},Se=(e,n)=>{let t=x(e,n),r=x(t?.baseCoinId,n);return[t,r||t]},be=e=>{let n=W(e);return(0,C.useMemoizedFn)(async t=>{let r=await n(t),o=await n(r?.baseCoinId);return[r,o||r]},[n])};var Fe=(e={})=>{let n=be(e);return(0,C.useMemoizedFn)(async t=>{let[,r]=await n(t),o=r?.coinId;return re.indexOf(o)!==-1},[n])},hn=(e,n={})=>{let t=Fe(n),[r,o]=(0,M.useState)(!1);return(0,C.useAsyncEffect)(async()=>{let c=await t(e);o(c)},[t]),r};P();b();P();b();ne();var L=B(H());var We=(e={})=>{let{currencyId:n,formatted:t=!0,useApproximate:r}=e||{},o=_(n),{symbol:c,usdToThisRate:s}=o,i=W({withPrice:!0});return(0,L.useMemoizedFn)(async(a,l)=>{let f=await i(a),p=w.div(l,10**f?.decimals),d=w.mul(f?.usdPrice,s),g=w.mul(p,d);return t?z(g,{useApproximate:r,symbol:c}):g},[c,t,i,s,r])},ke=(e,n,t={})=>{let{currencyId:r,formatted:o=!0,useApproximate:c,useMinPrecision:s=!0}=t||{},i=x(e,{withPrice:!0}),{usdToThisRate:a,symbol:l}=_(r);return(0,L.useCreation)(()=>{if(!i||!i?.usdPrice)return null;let f=s?w.div(n,10**i?.decimals):n,p=w.mul(i?.usdPrice,a),d=w.mul(f,p);return o?z(d,{useApproximate:c,symbol:l}):d},[l,o,a,n,c,i?.usdPrice,i?.decimals])};export{ye as a,I as b,W as c,x as d,Me as e,xe as f,Se as g,hn as h,We as i,ke as j};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-GQYTOJVD.js.map
