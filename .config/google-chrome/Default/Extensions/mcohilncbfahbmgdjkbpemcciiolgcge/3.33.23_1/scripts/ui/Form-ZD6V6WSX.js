import{a as Ce}from"./chunk-4AVGSFYH.js";import{a as Ne}from"./chunk-QTEBOXIQ.js";import{a as ke,c as W,d as U}from"./chunk-FXQ35K27.js";import{b as Te,c as O,d as z,e as Se,f as Ue,g as De,h as Pe,i as Le,j as $e,k as Ae,l as A,m as j,n as G,o as Be,p as K,q as ne,r as ze,s as Re,t as We,u as Me}from"./chunk-2QZMXYJR.js";import{A as be}from"./chunk-6UFIPREK.js";import"./chunk-G4OIO3Z6.js";import{a as Ie}from"./chunk-JEIYTQ5E.js";import"./chunk-TOO5SEJU.js";import{b as ie}from"./chunk-DUWPYFAS.js";import"./chunk-PXWV5LKL.js";import"./chunk-M5PVKGM6.js";import"./chunk-AK34CZMZ.js";import"./chunk-QHZHYX4V.js";import"./chunk-FLFVNMKM.js";import"./chunk-YJ2NGJXA.js";import{a as Ee}from"./chunk-ZUBNNPBM.js";import{a as xe}from"./chunk-LXIBKSOK.js";import"./chunk-C53RLQYB.js";import"./chunk-72NGWMH2.js";import"./chunk-VRXSSD45.js";import{R as ve,a as we,va as ye}from"./chunk-DUKP4BLI.js";import{b as oe}from"./chunk-S3O4LR55.js";import"./chunk-FZCNSMLW.js";import"./chunk-WANYNTD6.js";import"./chunk-QMGTBJAL.js";import{o as ge}from"./chunk-KCWFMCND.js";import{w as $}from"./chunk-3TDWET6C.js";import"./chunk-EBR3PGFZ.js";import"./chunk-UDGUBKMO.js";import{a as pe}from"./chunk-VPGNJAK6.js";import"./chunk-W6Q44ZHW.js";import"./chunk-3HS6AHPS.js";import{b as H}from"./chunk-JUXPONKW.js";import{i as fe}from"./chunk-WSUAESF2.js";import"./chunk-O2FUKKO3.js";import"./chunk-GQJVAWGG.js";import"./chunk-WO5B666G.js";import"./chunk-GCXT25LW.js";import"./chunk-TW63K7CB.js";import"./chunk-FDCWN4NG.js";import"./chunk-5YGMD6KK.js";import{Pc as de,Rc as _e,Uc as ue,Vc as he,Wc as lr,ob as me,wb as sr}from"./chunk-O3CM75EN.js";import"./chunk-ZGRAPBBU.js";import{A as te,b as re,q as y}from"./chunk-J3CEQI22.js";import"./chunk-VFHYER2K.js";import{L,w as t}from"./chunk-KJIO572I.js";import"./chunk-HJXNXGYU.js";import"./chunk-77ECUYXV.js";import"./chunk-4BZBCAHV.js";import{T as ce,Z as C,c as ar,ca as T}from"./chunk-KALFZBR5.js";import"./chunk-V55FEIYE.js";import{a as P}from"./chunk-EAZTJZU7.js";import"./chunk-VOT7VHG3.js";import"./chunk-SYQUJKIR.js";import"./chunk-WPMHLM7C.js";import"./chunk-P7DU4NJA.js";import"./chunk-KW7JYBDS.js";import"./chunk-224G4QSH.js";import{c as nr,f as v,m as u,n as E,o as h}from"./chunk-ZCHLW7CF.js";var se=nr((hr,qe)=>{u();h();(function(o){"use strict";o.exports.is_uri=c,o.exports.is_http_uri=r,o.exports.is_https_uri=i,o.exports.is_web_uri=w,o.exports.isUri=c,o.exports.isHttpUri=r,o.exports.isHttpsUri=i,o.exports.isWebUri=w;var s=function(a){var e=a.match(/(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/);return e};function c(a){if(!!a&&!/[^a-z0-9\:\/\?\#\[\]\@\!\$\&\'\(\)\*\+\,\;\=\.\-\_\~\%]/i.test(a)&&!/%[^0-9a-f]/i.test(a)&&!/%[0-9a-f](:?[^0-9a-f]|$)/i.test(a)){var e=[],n="",f="",l="",_="",d="",p="";if(e=s(a),n=e[1],f=e[2],l=e[3],_=e[4],d=e[5],!!(n&&n.length&&l.length>=0)){if(f&&f.length){if(!(l.length===0||/^\//.test(l)))return}else if(/^\/\//.test(l))return;if(!!/^[a-z][a-z0-9\+\-\.]*$/.test(n.toLowerCase()))return p+=n+":",f&&f.length&&(p+="//"+f),p+=l,_&&_.length&&(p+="?"+_),d&&d.length&&(p+="#"+d),p}}}function r(a,e){if(!!c(a)){var n=[],f="",l="",_="",d="",p="",b="",m="";if(n=s(a),f=n[1],l=n[2],_=n[3],p=n[4],b=n[5],!!f){if(e){if(f.toLowerCase()!="https")return}else if(f.toLowerCase()!="http")return;if(!!l)return/:(\d+)$/.test(l)&&(d=l.match(/:(\d+)$/)[0],l=l.replace(/:\d+$/,"")),m+=f+":",m+="//"+l,d&&(m+=d),m+=_,p&&p.length&&(m+="?"+p),b&&b.length&&(m+="#"+b),m}}}function i(a){return r(a,!0)}function w(a){return r(a)||i(a)}})(qe)});u();h();var g=v(P()),er=v($()),rr=v(pe()),tr=v(ge()),or=v(ar());L();u();h();var M=v(P()),V=v($());L();var Ze=(0,M.memo)(o=>{let{disabled:s}=o,c=(0,V.useDispatch)(),r=({target:{value:n}})=>{c(Le(n))},{name:i,nameErr:w}=(0,V.useSelector)(Te),a=()=>{c($e(t(i?"":"developer_mode_network_errortip_cannotspace")))},e=t("extension_wallet_addnetwork_placeholder_network");return M.default.createElement("div",{className:"net-form__wrap-input"},M.default.createElement(y,{value:i,onBlur:a,disabled:s,size:y.SIZE.xl,errorType:y.TIP_TYPE.always,error:w,onChange:r,placeholder:e,label:t("wallet_transaction_history_subtitle_network_name")}))});u();h();var B=v(P()),Z=v($()),Ye=v(se());L();u();h();u();h();ue();async function Fe(o,s,c=[]){let r=o,i={"Content-Type":"application/json"},{origin:w,pathname:a,username:e,password:n,search:f}=new URL(o);if(e&&n){let p=E.Buffer.from(`${e}:${n}`).toString("base64");i.Authorization=`Basic ${p}`,r=`${w}${a}${f}`}let{data:l}=await _e(r,{id:Date.now().toString(),jsonrpc:"2.0",method:s,params:c},{timeout:3e4,cache:"default",headers:i});if(!l||Array.isArray(l)||typeof l!="object")throw new Error(`RPC endpoint ${o} returned non-object response.`);let{error:_,result:d}=l;if(_)throw new Error(_?.message||_);return d}var Q=o=>{try{let s=new URL(o);return s.protocol==="http:"||s.protocol==="https:"}catch{return!1}},X=((o={})=>s=>new Promise((c,r)=>o[s]?c(o[s]):Fe(s,"eth_chainId").then(i=>{o[s]=i,c(i)}).catch(i=>{r(i)})))();var He=B.default.memo(o=>{let{disabled:s,modify:c}=o,r=(0,Z.useDispatch)(),[i,w]=(0,B.useState)(!1),a=({target:{value:p}})=>{r(Ae(p.trim()))},{rpcUrl:e,rpcUrlErr:n}=(0,Z.useSelector)(O),{rpcNetworks:f}=U(),{chainId:l}=(0,Z.useSelector)(z),_=()=>{if(!e)return r(A(t("developer_mode_network_errortip_cannotspace")));if(!Q(e))return r(A(t("developer_mode_infor_errortip_https")));if(!Ye.default.isWebUri(e))return r(A(t("developer_mode_infor_errortip_rpcurl")));let b=f.find(m=>m.rpcUrl===e);return b&&!c?r(A(t("developer_mode_infor_errortip_used_network",{network:b.name}))):(w(!0),X(e).then(m=>{try{m=parseInt(m,16).toString(10),c?m!==l&&r(G({err:t("developer_mode_infor_errortip_chainid",{chainID:m}),validChainId:l})):r(j(m))}catch{}w(!1),r(A(""))}).catch(()=>{r(A(t("developer_mode_infor_errortip_rpcurl"))),w(!1)}))},d=t("extension_wallet_addnetwork_placeholder_prcurl");return B.default.createElement("div",{className:"net-form__wrap-input"},B.default.createElement(y,{value:e,onBlur:_,disabled:s,size:y.SIZE.xl,errorType:y.TIP_TYPE.always,error:n,onChange:a,placeholder:d,label:t("developer_mode_network_title_rpcurl"),suffix:i&&B.default.createElement(C.Circle,{size:C.SIZE.sm})}))});u();h();var D=v(P()),q=v($()),Oe=v(ge());L();lr();ue();var mr=async o=>{let{data:s}=await de(he.getRpcNetworkByChainId,{chainIds:[o]});return s?.[0]?.nativeCurrency?.symbol},je=D.default.memo(o=>{let{disabled:s,modify:c}=o,r=(0,q.useDispatch)(),i=({target:{value:m}})=>{r(K(m.trim()))},{symbol:w,symbolErr:a,symbolTip:e}=(0,q.useSelector)(Se),[n,f]=(0,D.useState)(!1),{chainId:l}=(0,q.useSelector)(z),[_,d]=(0,D.useState)(!0),p=()=>{let m="";if(!l){r(ne(m));return}w||(m=t("developer_mode_network_errortip_cannotspace"),r(ne(m)))};(0,Oe.useDebounceEffect)(()=>{(async()=>{if(!l||c)return;let m;f(!0);try{r(K("")),m=await mr(l),r(K(m))}catch{}finally{d(m),f(!1)}})()},[l],{wait:500});let b=t("extension_wallet_addnetwork_placeholder_symbol");return D.default.createElement("div",{className:"net-form__wrap-input"},D.default.createElement(y,{value:w,disabled:s||c||_,onBlur:p,size:y.SIZE.xl,errorType:y.TIP_TYPE.always,error:a,tips:e,onChange:i,suffix:n&&D.default.createElement(C.Circle,{size:C.SIZE.sm}),placeholder:b,label:t("developer_mode_network_title_tokenname")}))});u();h();var N=v(P()),F=v($());L();u();h();sr();function Ge(o){return Number.isSafeInteger(o)&&o>0&&o<=me}var Ke=N.default.memo(o=>{let{disabled:s,modify:c}=o,r=(0,F.useDispatch)(),i=({target:{value:x}})=>{r(j(x.trim()))},[w,a]=(0,N.useState)(!1),{chainId:e,chainIdErr:n,chainIdTip:f,fieldUpdated:l}=(0,F.useSelector)(z),{rpcUrl:_}=(0,F.useSelector)(O),{rpcNetworks:d}=U(),p=(x,I,k=e)=>{r(G({err:x,validChainId:k})),r(Be({tip:I,validChainId:k}))},b=()=>{let x="",I="";if(!e)return x=t("developer_mode_network_errortip_cannotspace"),p(x,I);let k=e,ae=10;if(!k.startsWith("0x"))try{k=`0x${H(k)}`}catch{x=t("developer_mode_infor_errortip_errorchainid")}let[le]=d.filter(S=>S.chainId===k&&S.rpcUrl!==_);if(le?I=t("developer_mode_infor_errortip_network",{network:le.name}):e.startsWith("0x")?(ae=16,/^0x[0-9a-f]+$/iu.test(e)||(x=t("developer_mode_infor_errortip_errornum"))):/^[0-9]+$/u.test(e)?e.startsWith("0")?x=t("developer_mode_infor_errortip_errornum"):Ge(parseInt(e,ae))||(x=t("developer_mode_infor_errortip_errorchainid")):x=t("developer_mode_infor_errortip_errornum"),!_||w||x)return p(x,I);a(!0),X(_).then(S=>{if(k!==S){if(!e.startsWith("0x"))try{S=parseInt(S,16).toString(10)}catch(ir){console.log(ir)}x=t("developer_mode_infor_errortip_chainid",{chainID:S})}p(x,I,e),a(!1)}).catch(()=>{I=t("developer_mode_infor_errortip_rpcurl_confirm"),a(!1),p(x,I,e)})},m=t("extension_wallet_addnetwork_placeholder_chainid");return N.default.createElement("div",{className:"net-form__wrap-input"},N.default.createElement(y,{value:e,disabled:s||!!c,size:y.SIZE.xl,errorType:y.TIP_TYPE.always,error:n,onBlur:b,tips:f,onChange:i,suffix:w&&l&&N.default.createElement(C.Circle,{size:C.SIZE.sm}),placeholder:m,label:N.default.createElement(N.default.Fragment,null,t("developer_mode_network_title_chainid"),N.default.createElement(te,{title:t("developer_mode_network_tooltip_display_decimal"),placement:te.DIRECTION.topRight},N.default.createElement(ce,{className:"okx-wallet-plugin-information-circle"})))}))});u();h();var R=v(P()),Y=v($()),Ve=v(pe());L();u();h();var Qe=o=>{let{modify:s,uniqueId:c,onDeleteNet:r}=o,i=(0,Ve.useHistory)(),w=(0,Y.useSelector)(Pe),a=be(),{rpcNetworks:e,updateRpcNetwork:n,addRpcNetwork:f}=U(),{extensionConfig:l,setExtensionConfig:_}=Ie("rpc_info"),d=(0,Y.useDispatch)(),p=(0,Y.useSelector)(De),b=e.find(I=>W(I,{uniqueId:c}))||{},m=(0,R.useRef)(!1),x=async()=>{if(!m.current){if(m.current=!0,s){let I=await n({...b,...p});W(I,l)&&await _(I);let k={...p,chainId:`0x${H(p.chainId)}`};a(k),i.replace(`${ve}?tab=2`)}else{let I=await f(p);await d(ie("isRpcMode",!0)),await d(ie("currentNetworkUniqueId",I?.uniqueId)),await _(I),i.replace(ye)}m.current=!1}};return R.default.createElement(xe.FooterActions,{usePortal:!0},s&&R.default.createElement(T,{category:T.CATEGORY.outline,type:T.TYPE.primary,size:T.SIZE.lg,onClick:r,className:"net-form__footer-delete-btn",contentClassName:"net-form__footer-delete-btn__text"},t("commonall_resultpage_btn_delete")),R.default.createElement(T,{disabled:w,category:T.CATEGORY.fill,type:T.TYPE.highlight,size:T.SIZE.lg,onClick:x},t("developer_mode_bot_btn_save")))};u();h();var J=v(P()),ee=v($()),Xe=v(se());L();var Je=J.default.memo(o=>{let{disabled:s}=o,c=(0,ee.useDispatch)(),r=({target:{value:n}})=>{c(ze(n.trim()))},{explorerUrl:i,explorerUrlErr:w}=(0,ee.useSelector)(Ue),a=()=>{let n="";i&&(Xe.default.isWebUri(i)||(Q(i)?n=t("developer_mode_infor_errortip_invalidurl"):n=t("developer_mode_infor_errortip_https1"))),c(Re(n))},e=t("extension_wallet_addnetwork_placeholder_blockchain");return J.default.createElement("div",{className:"net-form__wrap-input"},J.default.createElement(y,{value:i,onBlur:a,disabled:s,size:y.SIZE.xl,errorType:y.TIP_TYPE.always,error:w,onChange:r,placeholder:e,label:t("developer_mode_network_title_blockchain_explorer")}))});var Vt=()=>{let o=(0,er.useDispatch)(),s=(0,rr.useHistory)(),c=Ne(),r=c.get("modify"),i=r===ke.CANT,w=decodeURIComponent(c.get("id")),{rpcNetworks:a}=U(),e=a.find(d=>W(d,{uniqueId:w}))||{};(0,g.useEffect)(()=>{let d={...e};d.chainId&&(d.chainId=`${Number.parseInt(d.chainId,16)}`),o(We(d))},[e]),(0,tr.useUnmount)(()=>{o(Me())});let n=(0,g.useCallback)(()=>{s.action==="POP"?s.replace(we):s.goBack()},[s]),f=Ce(),l=(0,g.useCallback)(()=>{f({editRpcInfo:e,onDeleted:n})},[f,n,e]),_=(0,g.useMemo)(()=>g.default.createElement("div",{className:"net-form__title"},e.name?g.default.createElement(g.default.Fragment,null,g.default.createElement(oe,{size:oe.SIZE.md,src:e.icon,text:e.name,className:"net-form__title-icon",defaultIcon:fe}),g.default.createElement("div",{className:"net-form__title-text net-form__title-text-top"},e.name)):g.default.createElement("div",{className:"net-form__title-text"},t("wallet_extension_settings_header_custom_network"))),[e]);return g.default.createElement("div",{className:(0,or.default)("net-form",{disabled:i})},g.default.createElement(Ee,{onBack:n,closeable:!1}),i||r?null:g.default.createElement(re,{className:"net-form__warn",desc:t("developer_mode_network_errortip_trust_network"),type:re.TYPE.warn,closable:!1}),_,g.default.createElement("div",{className:"net-form__wrap"},g.default.createElement(Ze,{disabled:i}),g.default.createElement(He,{disabled:i,modify:r}),g.default.createElement(Ke,{disabled:i,modify:r}),g.default.createElement(je,{disabled:i,modify:r}),g.default.createElement(Je,{disabled:i}),!i&&g.default.createElement(Qe,{modify:r,uniqueId:w,onDeleteNet:l})))};export{Vt as default};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=Form-ZD6V6WSX.js.map
