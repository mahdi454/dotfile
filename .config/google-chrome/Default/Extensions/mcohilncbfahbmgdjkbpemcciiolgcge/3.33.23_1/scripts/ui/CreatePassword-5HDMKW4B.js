import{b as Te}from"./chunk-72HNLK2F.js";import{a as Ce}from"./chunk-W34TCTDQ.js";import{d as be}from"./chunk-3RXI6HAM.js";import{a as U,b as Pe}from"./chunk-AXG7YOIX.js";import{a as pe}from"./chunk-QTEBOXIQ.js";import{b as ce,c as de,d as ue,e as fe,f as we,g as _e,l as he,m as ge,n as Ee,o as Ie}from"./chunk-5EKAQ7RI.js";import"./chunk-VCDGXBMA.js";import"./chunk-WTLSVELU.js";import{a as ne,b as ie}from"./chunk-4HHM4J4U.js";import"./chunk-CA4PB6NG.js";import"./chunk-SCXRHDUG.js";import{L as le}from"./chunk-5STCPPZU.js";import{a as me}from"./chunk-UA4GAS73.js";import"./chunk-ZUBNNPBM.js";import{l as te,m as re,n as se,o as ae}from"./chunk-2SHHGXPQ.js";import"./chunk-UK4SAM7E.js";import{a as oe}from"./chunk-LXIBKSOK.js";import"./chunk-72NGWMH2.js";import{F as J,Sa as ee,a as L,ga as X}from"./chunk-DUKP4BLI.js";import"./chunk-S3O4LR55.js";import"./chunk-FZCNSMLW.js";import"./chunk-WANYNTD6.js";import"./chunk-QMGTBJAL.js";import{o as Ze}from"./chunk-KCWFMCND.js";import{A as G,ja as Q,w as Y}from"./chunk-3TDWET6C.js";import"./chunk-EBR3PGFZ.js";import"./chunk-UDGUBKMO.js";import{a as Ve}from"./chunk-VPGNJAK6.js";import{na as z,oa as $e,ta as Z,ya as je}from"./chunk-W6Q44ZHW.js";import{d as j,f as Ye}from"./chunk-3HS6AHPS.js";import"./chunk-WSUAESF2.js";import"./chunk-O2FUKKO3.js";import"./chunk-GCXT25LW.js";import"./chunk-FDCWN4NG.js";import{Gc as q,Mc as ze,Ya as Ke,gc as V,mc as ve,o as H,ta as K,wa as v,y as He}from"./chunk-O3CM75EN.js";import"./chunk-ZGRAPBBU.js";import{D as w,H as $,q as y}from"./chunk-J3CEQI22.js";import{F as x,pa as Be}from"./chunk-VFHYER2K.js";import{L as De,w as n}from"./chunk-KJIO572I.js";import"./chunk-HJXNXGYU.js";import"./chunk-77ECUYXV.js";import"./chunk-4BZBCAHV.js";import{ca as E}from"./chunk-KALFZBR5.js";import"./chunk-V55FEIYE.js";import{a as D}from"./chunk-EAZTJZU7.js";import"./chunk-YTRW5WTJ.js";import"./chunk-VOT7VHG3.js";import"./chunk-SYQUJKIR.js";import"./chunk-WPMHLM7C.js";import"./chunk-P7DU4NJA.js";import"./chunk-KW7JYBDS.js";import"./chunk-224G4QSH.js";import{f as _,m as h,o as g}from"./chunk-ZCHLW7CF.js";h();g();var t=_(D()),k=_(Y()),O=_(Ze());Be();De();Ye();ve();h();g();var I=_(D()),N=_(Y()),Ae=_(Ve());$e();function Se(){let c=(0,N.useDispatch)(),i=(0,Ae.useHistory)(),f=(0,N.useSelector)(Q),[d,A]=(0,I.useState)(!1);return(0,I.useEffect)(()=>{f&&!d&&(c(z(!1)),i.push(L))},[f,d,i,c]),(0,I.useCallback)(()=>{A(!0)},[])}h();g();var Re=c=>{let{onboardingTabs:i}=c.metamask;if(!i||Object.keys(i).length!==1)return null;let f=Object.keys(i)[0],d=i[f];return{location:f,tabId:d}};He();ze();je();Ke();var p={SEED:"seed",KEY:"key",HARDWARE:"hardware",CREATE:"create",MPC:"mpc",BULK:"bulk"},No=({history:c})=>{let i=pe(),f=w.useForm(),[d,{set:A}]=(0,O.useBoolean)(!1),[m,Le]=(0,t.useState)({}),r=(0,k.useDispatch)(),{seedPhrase:P,privateKey:b,mpcInfo:Ne,unlockHardwareWallets:S,chooseNetworkList:M,chainList:ke,isTonMnemonic:Oe}=(0,k.useSelector)(e=>({seedPhrase:ce(e),privateKey:de(e),mpcInfo:fe(e),unlockHardwareWallets:ue(e),chooseNetworkList:we(e),onboardingInitiator:Re(e),chainList:G(e),isTonMnemonic:_e(e)})),Me=Se(),B=i.get("from"),Fe=B===p.HARDWARE,R=B===p.BULK,{setValue:We}=be(),C=async(e,l)=>{try{r(Te(!0)).then(async()=>{if(Me(),await r(me()),e===p.CREATE){c.push({pathname:X,search:`?type=${q.INITIALIZE}`});return}let s=`${J}/${e}`,{keyringName:a="",walletName:o=""}=l||{},u=`${a}-${o}`;if(e===p.HARDWARE&&V()===H){globalThis.platform.openExtensionInPopup(`${s}?anim=1`);return}c.push({pathname:s,state:{walletName:u,anim:"1",next:L}})}).catch(console.log)}catch(s){console.error(s.message)}},F=t.default.useMemo(()=>{let{password:e,confirmPassword:l}=m;return!(e?.length>=ne&&e===l)},[d,b,P,S,m]),xe=(0,O.useMemoizedFn)(async()=>{if(!(d||F)){A(!0),le();try{if(P){let o=await r(re(m.password,P?.trim().toLowerCase().match(/\w+/gu)?.join(" ")||"",{isTonMnemonic:Oe}));C(p.SEED,o),r(he())}if(b){let o=await r(se(m.password,M,b));C(p.KEY,o,M),r(ge())}if(R){We(m.password),c.push(ee);return}let{cipherText:e,privateKey:l,mpcId:s,userInfo:a}=Ne;if(e&&l&&s){let o=await r(ae(m.password,{cipherText:e,privateKey:l},{mpcId:s,userInfo:a},!0)),u=ke.filter(W=>W.factionType===K).map(W=>W.baseChain),T=[...v,...u];C(p.MPC,o,T),r(Ie())}if(!x(S)){await j().setPassword(m.password);let o=await r(Ce(S)),{hdPathMap:u}=o,T=Object.keys(u);C(p.HARDWARE,o,T),r(Ee())}if(!P&&!b&&!(e&&l&&s)&&x(S)){let o=await r(te(m.password));C(p.CREATE,o)}}catch(e){e.message===Z&&$.error(n("wallet_home_toast_network_error"))}finally{A(!1)}}},[F,m,P,b,M]);(0,t.useEffect)(()=>{if(R){let e=document.querySelector("#app");e&&(e.classList.remove("fullscreen"),e.classList.add("popup"))}return()=>{if(R){let e=document.querySelector("#app");e&&(e.classList.remove("popup"),e.classList.add("fullscreen"))}}},[]);let Ue=R?{position:"absolute",bottom:0,left:0}:{};return t.default.createElement(Pe,{title:n("wallet_signup_maintitle_set_password"),desc:n(Fe?"wallet_extension_signup_subtitle_set_password_hardware":"wallet_extension_subtitle_password_unlock")},({formClass:e,formErrorClass:l,itemClass:s})=>t.default.createElement(w,{form:f,size:E.SIZE.lg,onSubmit:xe,validateTrigger:["onChange"],className:e,errorClassName:l,onValuesChange:(a,o)=>{Le(o)}},t.default.createElement(w.Item,{name:"password",style:{marginBottom:0},className:s,label:n("wallet_set_password_subtitle_password")},t.default.createElement(y.Password,{autoFocus:!0,autoComplete:"off",inputClassName:U.passwordInput,size:y.SIZE.xl,placeholder:n("wallet_settings_reset_passord_placeholder_input_desc")})),t.default.createElement(w.Item,{noStyle:!0,shouldUpdate:(a,o)=>a.password!==o.password},({getFieldValue:a})=>{let o=a("password");return t.default.createElement(ie,{password:o})}),t.default.createElement(w.Item,{name:"confirmPassword",style:{flex:1,marginTop:"32px"},dependencies:["password"],className:s,rules:[({getFieldValue:a})=>({validator:(o,u)=>{let T=a("password");return u&&T!==u?Promise.reject(n("wallet_set_password_errortip_password_not_match")):Promise.resolve()}})],label:n("wallet_set_password_subtitle_confirm_password")},t.default.createElement(y.Password,{autoComplete:"off",inputClassName:U.passwordInput,size:y.SIZE.xl,placeholder:n("wallet_settings_reset_passord_placeholder_input_desc")})),t.default.createElement(oe.FooterActions,{affixStyle:Ue},t.default.createElement(w.Item,{noStyle:!0},t.default.createElement(E,{block:!0,htmlType:"submit",disabled:F,size:E.SIZE.lg,type:E.TYPE.highlight,loading:d,category:E.CATEGORY.fill},n("wallet_set_password_btn_confirm"))))))};export{No as default};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=CreatePassword-5HDMKW4B.js.map
