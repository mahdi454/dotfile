import{h as To,k as ho}from"./chunk-SUU55JAC.js";import{a as Ke,b as yo,c as xo,d as vo}from"./chunk-4RVQOPYQ.js";import{a as _o,b as fo}from"./chunk-CCXOIJJY.js";import{a as Le}from"./chunk-KTRYKYE5.js";import{a as uo}from"./chunk-V2A2AEVZ.js";import{d as co,e as po}from"./chunk-5NP5YBP7.js";import{a as Rt,b as Pe,d as eo,e as io,g as ro,i as so,k as lo,m as ve}from"./chunk-AFGI3MHV.js";import{b as Xt}from"./chunk-3QYKNWJE.js";import{e as $t}from"./chunk-TSGQQ5QA.js";import{a as go}from"./chunk-3YTH2U6Q.js";import{a as no}from"./chunk-UUX3UNZW.js";import{c as je,e as Vt}from"./chunk-QCTV4R7X.js";import{a as oo,e as ao}from"./chunk-SIIB3XCZ.js";import{a as qt,d as Jt,q as Je}from"./chunk-UTVBVZWC.js";import{h as to}from"./chunk-GL4YYTXQ.js";import{b as Zt}from"./chunk-4MDR2IS2.js";import{c as Kt}from"./chunk-GZN3TPOZ.js";import{d as xe}from"./chunk-GQYTOJVD.js";import{b as Yt}from"./chunk-SJRV5U24.js";import{a as St}from"./chunk-L4BR2EHM.js";import{a as ke,d as mo}from"./chunk-FAJ2Q5PZ.js";import{a as Bt,b as Gt}from"./chunk-5U7ZXBMP.js";import{a as Mt,d as Ot}from"./chunk-XVPROSYE.js";import{h as Wt}from"./chunk-E2MXYP3A.js";import{b as zt,e as Ut}from"./chunk-FPV6XIHQ.js";import{c as Ht}from"./chunk-G4OIO3Z6.js";import{ha as jt,w as Qt}from"./chunk-5STCPPZU.js";import{a as Dt}from"./chunk-LXIBKSOK.js";import{b as re}from"./chunk-S3O4LR55.js";import{f as ht,h as qe,l as gt,m as Ct,q as H}from"./chunk-FZCNSMLW.js";import{o as ye}from"./chunk-KCWFMCND.js";import{T as It,X as Pt,Y as Qe,sa as kt,w as cn}from"./chunk-3TDWET6C.js";import{C as At,V as K,_ as Ie,b as Ae,d as Et,k as Nt}from"./chunk-EBR3PGFZ.js";import{a as Y}from"./chunk-JUXPONKW.js";import{d as Tt}from"./chunk-WSUAESF2.js";import{g as Lt}from"./chunk-TW63K7CB.js";import{c as g}from"./chunk-FDCWN4NG.js";import{Eb as Ue,Fb as lt,Gb as Ye,Hb as Ee,Jb as mt,Lb as fe,Mc as pn,Pc as bt,Tb as ct,Uc as un,V as st,Vc as Ft,Wc as dn,Ya as ln,dc as Ne,jc as pt,mc as mn,yc as wt}from"./chunk-O3CM75EN.js";import{A as yt,G as xt,H as vt,a as dt,c as _t,o as R,q as Ve,r as ft}from"./chunk-J3CEQI22.js";import{K as We,e as it,pa as rt}from"./chunk-VFHYER2K.js";import{L as ne,l as Q,v as ze,w as a}from"./chunk-KJIO572I.js";import{T as ut,c as Ze,ca as A}from"./chunk-KALFZBR5.js";import{a as q}from"./chunk-EAZTJZU7.js";import{f as P,m as r,o as s}from"./chunk-ZCHLW7CF.js";r();s();r();s();ne();r();s();var ge=P(q());r();s();r();s();var $=P(q()),Co=P(cn());ne();Ne();r();s();var ee={title:"_title_1xthp_1",subtitle:"_subtitle_1xthp_9",fee:"_fee_1xthp_15",feeTitle:"_feeTitle_1xthp_21",feeDetail:"_feeDetail_1xthp_26",speedDetail:"_speedDetail_1xthp_33",gasDetail:"_gasDetail_1xthp_36"};var _n=()=>{let e=Zt(),o=to(),t=Wt(),i=(0,Co.useSelector)(kt),n=Xt(),_=co(),c=async(l,y,d,b=0)=>{let{baseCoin:T}=await e(d,!0),w=t?.[T.coinId]||"0",F=Ue(l,y),E=Ct(Ye(F,b),{symbol:T.symbol,decimals:T.decimals}),x=gt(Ue(lt(Ye(F,b),10**T.decimals),w),{symbol:i.symbol});return`${E} ${x}`},u=(l,y)=>{let d=n(l);return a("wallet_extension_transaction_confirmation_gas_detail",{gasPrice:Q.thousandFormat(d),gasLimit:Q.thousandFormat(y)})},m=async(l,y)=>{try{return await _({...l,coinId:y})}catch{return""}},p=({userGasInfo:l,updateGasInfo:y,fetchParams:d})=>{let{gasPrice:b,maxFeePerGas:T,maxPriorityFeePerGas:w}=y,{supportEip1559:F,gasLimit:E,gasPrice:x,maxFeePerGas:h,maxPriorityFeePerGas:D}=l;return F?(delete d.gasPrice,{...d,value:d?.amount,maxFeePerGas:T||h,maxPriorityFeePerGas:w||D,gasLimit:E}):{...d,value:d?.amount,gasPrice:b||x,gasLimit:E}};return async({coinId:l,baseCoinAmountUse:y,userGasInfo:d,updateGasInfo:b,serverSignInfo:T,fetchParams:w})=>{let{gasPrice:F,maxFeePerGas:E}=b,{supportEip1559:x,gasLimit:h,gasPrice:D,maxFeePerGas:k}=d,G=0;T?.needExtFee&&(G=await m(p({userGasInfo:d,updateGasInfo:b,fetchParams:w}),l));let O=x?k:D,U=await c(O,h,l),W=u(O,h),j=x?E:F,z=await c(j,h,l,G),J=u(j,h);return new Promise((Z,oe)=>{let ae=R.prompt({hideCloseBtn:!1,alignBottom:!1,titleCenter:!1,infoType:null,confirmText:a("extension_toast_btn_confirmgasfee"),confirmBtnProps:{type:A.TYPE.highlight,size:A.SIZE.lg},onConfirm:async()=>{ae.destroy();let{baseCoin:I}=await e(l,!0),{coinAmountInt:V}=o(I.coinId),X=Ee(V,y);lo({userGasInfo:d,updateGasInfo:b,baseCoinAmountAvailable:X,L1FEE:G})?(xt.error({title:a("extension_toast_text_insufficient_balance")}),oe(new Error(ve))):Z(b)},onClose:()=>{ae.destroy(),oe(new Error(ve))},renderContent:I=>$.default.createElement(I,null,$.default.createElement("div",{className:ee.title},a("extension_toast_title_transaction_replace")),$.default.createElement("div",{className:ee.subtitle},a("extension_toast_subtitle_gasincrease")),$.default.createElement("div",{className:ee.feeTitle},a("extension_toast_title_current_transaction")),$.default.createElement("div",{className:ee.fee},$.default.createElement("div",{className:ee.feeDetail},U),$.default.createElement("div",{className:ee.gasDetail},W)),$.default.createElement("div",{className:ee.feeTitle},a("extension_toast_title_gasprice")),$.default.createElement("div",{className:ee.fee},$.default.createElement("div",{className:ee.speedDetail},z),$.default.createElement("div",{className:ee.gasDetail},J)))})})}},wo=_n;var fn=()=>{let e=wo();return async({coinId:t,baseCoinAmountUse:i,userGasInfo:n,serverGasInfo:_,serverSignInfo:c,originTxGasInfo:u,fetchParams:m})=>{let p=so({userGasInfo:n,serverGasInfo:_,originTxGasInfo:u});return p?.gasPrice||p?.maxFeePerGas?(await e({coinId:t,baseCoinAmountUse:i,userGasInfo:n,updateGasInfo:p,serverSignInfo:c,fetchParams:m}),Promise.resolve(p)):Promise.resolve()}},bo=fn;r();s();var Se={content:"_content_18w99_1",title:"_title_18w99_4",text:"_text_18w99_10"};var yn=()=>{let e=bo();return async({coinId:t,baseCoinAmountUse:i="0",showSelectNonceDialog:n=!1,onChainNonce:_="0",newNonce:c="0",userGasInfo:u={},serverGasInfo:m={},serverSignInfo:p={},originTxGasInfo:f={},fetchParams:l={},title:y="",text:d="",confirmText:b="",cancelText:T=""})=>new Promise((w,F)=>{if(n){let E=R.prompt({hideCloseBtn:!0,alignBottom:!1,titleCenter:!1,infoType:null,cancelBtnProps:{category:A.CATEGORY.outline,size:A.SIZE.lg},confirmBtnProps:{type:A.TYPE.highlight,size:A.SIZE.lg},confirmText:b,cancelText:T,onConfirm:async()=>{E.destroy();try{let x=await e({coinId:t,baseCoinAmountUse:i,userGasInfo:u,serverGasInfo:m,serverSignInfo:p,originTxGasInfo:f,fetchParams:l});w(x?{nonce:_,updateGasInfo:x}:{nonce:_})}catch(x){F(x)}},onCancel:()=>{E.destroy(),w({nonce:c})},renderContent:x=>ge.default.createElement(x,null,ge.default.createElement("div",{className:Se.content},ge.default.createElement("div",{className:Se.title},y),ge.default.createElement("div",{className:Se.text},d)))})}else w({nonce:c})})},Be=yn;var xn=()=>{let e=Be();return async({coinId:t,baseCoinAmountUse:i,hasFailedTx:n,onChainNonce:_,newNonce:c,userGasInfo:u,serverGasInfo:m,originTxGasInfo:p,serverSignInfo:f,fetchParams:l})=>e({coinId:t,baseCoinAmountUse:i,showSelectNonceDialog:n,onChainNonce:_,newNonce:c,userGasInfo:u,serverGasInfo:m,serverSignInfo:f,originTxGasInfo:p,fetchParams:l,title:a("wallet_extension_transaction_popup_failed_transaction"),text:a("wallet_extension_transaction_popup_replace_failed_transaction"),confirmText:a("wallet_extension_transaction_popup_btn_replace"),cancelText:a("wallet_extension_transaction_popup_btn_skip")})},Fo=xn;r();s();ne();var vn=()=>{let e=Be();return async({coinId:t,baseCoinAmountUse:i,hasPendingTx:n,onChainNonce:_,newNonce:c,userGasInfo:u,serverGasInfo:m,originTxGasInfo:p,serverSignInfo:f,fetchParams:l})=>e({coinId:t,baseCoinAmountUse:i,showSelectNonceDialog:n,onChainNonce:_,newNonce:c,userGasInfo:u,serverGasInfo:m,serverSignInfo:f,fetchParams:l,originTxGasInfo:p,title:a("wallet_extension_transaction_popup_pending_transaction"),text:a("wallet_extension_transaction_popup_replace_pending_transaction"),confirmText:a("wallet_extension_transaction_popup_btn_replace"),cancelText:a("wallet_extension_transaction_popup_btn_continue_wait")})},Eo=vn;r();s();ne();rt();var Tn=()=>async({isRepeat:o,onCancel:t})=>new Promise((i,n)=>{if(o){let _=R.prompt({alignBottom:!1,hideCloseBtn:!0,infoType:R.Prompt.INFO_TYPE.warn,confirmBtnProps:{type:A.TYPE.highlight,size:A.SIZE.lg},cancelBtnProps:{category:A.CATEGORY.outline,size:A.SIZE.lg},title:a("wallet_extension_popup_repeat_order"),confirmText:a("wallet_extension_popup_repeat_order_btn_continue"),cancelText:t?a("wallet_extension_popup_repeat_order_btn_viewhistory"):null,text:a("wallet_extension_popup_repeat_order_desc"),onConfirm:()=>{_.destroy(),i()},onCancel:()=>{_.destroy(),it(t)&&t(),n(new Error(ve))}})}else i()}),No=Tn;var Ao="FetchError";var Io=()=>{let e=Fo(),o=Eo(),t=No(),i=async({coinId:c,from:u,to:m,amount:p,gasPrice:f})=>{let[{data:l=[]},{data:y={}}]=await Promise.all([Ut({checkTypes:[Ie.REPEAT,Ie.OVERWRITTEN],coinId:c,from:u,to:m,amount:p,gasPrice:f}),zt({coinId:c,address:u},{fromAddr:u,scenario:Nt.SCENARIO_SEND_COIN})]);return{txToastCheckData:l,signInfoData:y}},n=c=>{let{hasFailedTx:u,hasPendingTx:m,nonce:p,newNonce:f,originGasPrice:l,originPriorityFee:y}=ro(c),d=io(c,Ie.REPEAT);return{hasFailedTx:u,hasPendingTx:m,nonce:p,newNonce:f,originGasPrice:l,originPriorityFee:y,isRepeat:d}};return async({coinId:c,from:u,to:m,amount:p,gasPrice:f,baseCoinAmountUse:l,userGasInfo:y,whetherCheckRepeat:d,onRepeatCancel:b})=>{let T=[],w={};try{let z=await i({coinId:c,from:u,to:m,amount:p,gasPrice:f});if(!Array.isArray(z.txToastCheckData)||typeof z.signInfoData!="object")throw new Error(Ao);T=z.txToastCheckData,w=z.signInfoData?.info||{}}catch{throw new Error(Ao)}let F=n(T),{nonce:E,newNonce:x,originGasPrice:h,originPriorityFee:D,hasFailedTx:k,hasPendingTx:G,isRepeat:O}=F,U={originGasPrice:h,originPriorityFee:D},W={coinId:c,baseCoinAmountUse:l,onChainNonce:E,newNonce:x,userGasInfo:y,serverGasInfo:w.gasPrice,serverSignInfo:w,originTxGasInfo:U,fetchParams:{amount:p,coinId:c,from:u,gasPrice:f,to:m}},j={nonce:x};return k?j=await e({...W,hasFailedTx:k}):G&&(j=await o({...W,hasPendingTx:G})),d&&await t({isRepeat:O,onCancel:b}),j}};r();s();var Do=P(q());r();s();var v=P(q()),Ce=P(ye()),$e=P(Ze());ne();r();s();var te=P(q());var Po=P(ye());r();s();var L={"mev-control-enter":"_mev-control-enter_1h6im_1",mevControlEnter:"_mev-control-enter_1h6im_1","mev-control-content":"_mev-control-content_1h6im_6",mevControlContent:"_mev-control-content_1h6im_6","mev-control-content-title":"_mev-control-content-title_1h6im_9",mevControlContentTitle:"_mev-control-content-title_1h6im_9","mev-control-content-desc":"_mev-control-content-desc_1h6im_14",mevControlContentDesc:"_mev-control-content-desc_1h6im_14","list-content":"_list-content_1h6im_18",listContent:"_list-content_1h6im_18","list-item":"_list-item_1h6im_21",listItem:"_list-item_1h6im_21","item-icon":"_item-icon_1h6im_24",itemIcon:"_item-icon_1h6im_24","list-item-text":"_list-item-text_1h6im_28",listItemText:"_list-item-text_1h6im_28","mev-control-title":"_mev-control-title_1h6im_32",mevControlTitle:"_mev-control-title_1h6im_32","mev-control-sub-title":"_mev-control-sub-title_1h6im_37",mevControlSubTitle:"_mev-control-sub-title_1h6im_37","mev-control-picture":"_mev-control-picture_1h6im_42",mevControlPicture:"_mev-control-picture_1h6im_42","mev-control-divider":"_mev-control-divider_1h6im_46",mevControlDivider:"_mev-control-divider_1h6im_46","mev-control-text-content":"_mev-control-text-content_1h6im_50",mevControlTextContent:"_mev-control-text-content_1h6im_50","mev-status":"_mev-status_1h6im_54",mevStatus:"_mev-status_1h6im_54","mev-status__text":"_mev-status__text_1h6im_58",mevStatusText:"_mev-status__text_1h6im_58","mev-status__text__active":"_mev-status__text__active_1h6im_63",mevStatusTextActive:"_mev-status__text__active_1h6im_63","mev-tooltip":"_mev-tooltip_1h6im_66",mevTooltip:"_mev-tooltip_1h6im_66"};var hn=({mevList:e,mevChecked:o,setMevChecked:t,...i})=>{let n=(0,te.useRef)(null);if(!e.length)return null;let _=(0,Po.useSize)(n),c=m=>{t(m)},u=m=>te.default.createElement(Mt,{icon:{size:re.SIZE.lg,src:m.vendorIcon||Tt,type:re.TYPE.image},className:L["list-item"],onClick:()=>{c(m)},...i},te.default.createElement(g.FlexBox,{direction:g.DIRECTION.vertical},te.default.createElement(g.FlexBox,{align:g.ALIGN.center},te.default.createElement(H.Text,{className:L["list-item-text"]},m.name))),m.name===o.name&&te.default.createElement(g.FlexBox,{className:L["item-icon"],justify:"flex-end"},te.default.createElement(re,{icon:"okds-success-circle-fill",size:re.SIZE.sm})));return te.default.createElement("div",{ref:n,className:L["list-content"]},te.default.createElement(Ot,{itemKey:"id",height:_?.height??408,searchable:!1,dataSource:e,renderItem:u}))},ko=hn;var Lo="mevOperated",gn=2e3,Cn=({isMev:e,needTooltip:o=!0,isShowBlockSwapMevTooltip:t,onMevChange:i,mevChecked:n,mevList:_,setMevChecked:c,className:u="",children:m})=>{let[p,{setFalse:f,setTrue:l}]=(0,Ce.useBoolean)(!1),[y,{toggle:d}]=(0,Ce.useBoolean)(!1),[b,T]=(0,v.useState)(""),[w]=(0,v.useState)(e);(0,v.useEffect)(()=>{let h=!e&&t,D=!e&&ze.get(Lo)===void 0,k=()=>{f()},G=()=>{ze.set(Lo,1)};return h?(T("wallet_extension_trade_tooltip_enable_mev"),l(),document.addEventListener("click",k,!1)):D&&(T("wallet_extension_mev_pop_turnon_mev"),l(),document.addEventListener("click",k,!1),document.addEventListener("click",G,!1)),()=>{document.removeEventListener("click",k,!1),document.removeEventListener("click",G,!1)}},[]);let F=()=>{window.localStorage.setItem("mevCheckedName",n.name)};(0,v.useEffect)(()=>{w&&n&&(F(),i(w,n))},[w,n]);let E=(0,Ce.useMemoizedFn)(()=>{typeof i=="function"&&(F(),i(!e,n)),jt({mev:!e}),T(e?"wallet_extension_mev_pop_mev_off":"wallet_extension_mev_pop_mev_on"),d(),l(),setTimeout(()=>{f()},gn)}),x=Lt({dark:"/cdn/assets/imgs/245/127CAD27DF691613.png",light:"/cdn/assets/imgs/2311/700F36AE20EC394E.png"});return n?v.default.createElement(v.default.Fragment,null,v.default.createElement("div",{className:(0,$e.default)(L["mev-status"],u),onClick:d},v.default.createElement(ht,{show:p,title:o&&a(b),placement:yt.DIRECTION.bottomRight},m||v.default.createElement(oo,{clickable:!0,title:a("wallet_extension_mev_subtitle_protection")},v.default.createElement(H.Text,{className:(0,$e.default)(L["mev-status__text"],{[L["mev-status__text__active"]]:e})},a(e?"wallet_extension_mev_desc_open":"wallet_extension_mev_desc_closed"))))),v.default.createElement(R.Action,{visible:y,onClose:d,onCancel:d,title:v.default.createElement(v.default.Fragment,null),isFull:!0,noContentPadding:!0,noMargin:!0,onConfirm:E,confirmBtnProps:e?{size:A.SIZE.lg,type:A.TYPE.primary,category:A.CATEGORY.outline}:{size:A.SIZE.lg,type:A.TYPE.highlight,category:A.CATEGORY.fill},confirmText:e?a("wallet_extension_mev_btn_disable_mev"):a("wallet_extension_mev_btn_activate_protection")},v.default.createElement(g.Box,{className:L["mev-control-content"]},v.default.createElement(g.FlexBox,{justify:"space-between",align:g.ALIGN.center},v.default.createElement(g.Space,{direction:g.DIRECTION.vertical,space:12},v.default.createElement(H.Text,{className:L["mev-control-title"]},a("wallet_extension_mev_grouptitle_mev_protection")),v.default.createElement(H.Text,{style:{color:e?"var(--okd-color-semantic-positive)":"var(--okd-color-content-primary)"},className:L["mev-control-sub-title"]},a(e?"wallet_extension_mev_label_enabled":"wallet_extension_mev_label_disabled"))),v.default.createElement(_t,{className:L["mev-control-picture"],src:x})),v.default.createElement(qe,{className:L["mev-control-divider"],style:{marginTop:24}}),v.default.createElement(g.Space,{className:L["mev-control-text-content"],direction:g.DIRECTION.vertical,space:24},v.default.createElement(g.Box,null,v.default.createElement(H.Text,{className:L["mev-control-content-title"]},a("wallet_extension_mev_title_provider")),v.default.createElement(ko,{mevList:_,mevChecked:n,setMevChecked:c})),v.default.createElement(qe,{className:L["mev-control-divider"]}),v.default.createElement(g.Box,null,v.default.createElement(H.Text,{className:L["mev-control-content-title"]},a("wallet_extension_mev_title_mev_attack")),v.default.createElement(H.Text,{className:L["mev-control-content-desc"]},a("wallet_extension_mev_subtitle_mev_attack"))),v.default.createElement(g.Box,null,v.default.createElement(H.Text,{className:L["mev-control-content-title"]},a("wallet_extension_mev_title_prevent_attacks")),v.default.createElement(H.Text,{className:L["mev-control-content-desc"]},a("wallet_extension_mev_subtitle_prevent_attacks"))),v.default.createElement(g.Box,null,v.default.createElement(H.Text,{className:L["mev-control-content-desc"]},a("wallet_extension_mev_subtitle_mev_reset"))))))):null},So=Cn;r();s();r();s();var Ge=P(q()),Bo=P(ye());un();dn();var wn=()=>{let[e,{setFalse:o}]=(0,Bo.useBoolean)(!0),[t,i]=(0,Ge.useState)([]),n=async()=>{try{let _=await bt(Ft.getMevList,{},{});return i(_.data),_.data}catch{return[]}finally{o()}};return(0,Ge.useEffect)(()=>{n()},[]),[e,t]},Go=wn;var me=P(q()),bn=e=>{let[o,t]=Go(),[i,n]=(0,me.useState)(""),[_,c]=(0,me.useState)([]);(0,me.useEffect)(()=>{let m=t.find(l=>window.localStorage.getItem("mevCheckedName")===l.name&&l.chainIds.includes(Number(e))),p=t.find(l=>l.chainIds.includes(Number(e))),f=t.filter(l=>l.chainIds.includes(Number(e)));c(f),n(m||p)},[t,e]);let u=(0,me.useMemo)(()=>i&&t.length>0&&!o,[i,t,o]);return[i,_,u,n]},Mo=bn;var Fn=({isMev:e,chainId:o,className:t,needTooltip:i,isShowBlockSwapMevTooltip:n,onMevChange:_,children:c})=>{let[u,m,p,f]=Mo(o);return p&&Do.default.createElement(So,{isMev:e,needTooltip:i,className:t,isShowBlockSwapMevTooltip:n,onMevChange:_,mevChecked:u,mevList:m,setMevChecked:f},c)},Oo=Fn;r();s();var M=P(q()),ue=P(ye());rt();ne();r();s();var we=P(q()),ce=P(Ze());ne();r();s();var se={root:"_root_wpiv5_1",title:"_title_wpiv5_4",header:"_header_wpiv5_8",icon:"_icon_wpiv5_12",content:"_content_wpiv5_16",textarea:"_textarea_wpiv5_19",errorTip:"_errorTip_wpiv5_22",errorBordered:"_errorBordered_wpiv5_29"};function En({className:e,value:o,onChange:t,error:i,titleClass:n,errorTipClass:_,headerClassName:c,contentClassName:u,...m}){return we.default.createElement(dt,{defaultExpanded:!0,className:(0,ce.default)(se.root,e),titleClass:(0,ce.default)(se.title,n),headerClassName:(0,ce.default)(se.header,c),contentClassName:(0,ce.default)(se.content,u),customHeaderIcon:p=>we.default.createElement(re,{icon:"okds-arrow-chevron-down-md",size:re.SIZE.xs,className:(0,ce.default)({"okui-accordion-header-icon-expanded":p},se.icon)}),title:a("wallet_extension_inscription_text_hex_data_optional")},we.default.createElement(Ve.TextArea,{...m,inputClassName:se.textarea,errorType:Ve.TIP_TYPE.always,error:!!i,value:o,onChange:p=>{let f=p.target.value||"";t?.(f.trim())}}),!!i&&we.default.createElement(H.Text,{className:(0,ce.default)(se.errorTip,_)},i))}var Ho=En;r();s();ne();function Wo(e){return!!e&&(e.toLowerCase()==="0x"||!mo(e)||e.length%2!==0)?a("wallet_extension_inscription_text_input_formatting_error"):null}r();s();var zo=[{constant:!0,inputs:[],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"value",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"from",type:"address"},{name:"to",type:"address"},{name:"value",type:"uint256"}],name:"transferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"addedValue",type:"uint256"}],name:"increaseAllowance",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[],name:"unpause",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"account",type:"address"}],name:"isPauser",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"paused",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[],name:"renouncePauser",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"owner",type:"address"}],name:"balanceOf",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"account",type:"address"}],name:"addPauser",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[],name:"pause",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"subtractedValue",type:"uint256"}],name:"decreaseAllowance",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"to",type:"address"},{name:"value",type:"uint256"}],name:"transfer",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"owner",type:"address"},{name:"spender",type:"address"}],name:"allowance",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{inputs:[{name:"name",type:"string"},{name:"symbol",type:"string"},{name:"decimals",type:"uint8"},{name:"totalSupply",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,name:"account",type:"address"}],name:"Paused",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"account",type:"address"}],name:"Unpaused",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"}],name:"PauserAdded",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"}],name:"PauserRemoved",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Approval",type:"event"}];r();s();var C=P(q()),pe=P(ye()),Yo=P(Ze());ne();Ne();r();s();var S={root:"_root_14625_1",icon:"_icon_14625_1",editApproveAmountModal:"_editApproveAmountModal_14625_10",content:"_content_14625_22",txTypeInfo:"_txTypeInfo_14625_25",editArea:"_editArea_14625_28",unlimitedText:"_unlimitedText_14625_33",unlimitedSymbol:"_unlimitedSymbol_14625_42",symbolClassName:"_symbolClassName_14625_59",quickHandler:"_quickHandler_14625_62",balanceWrap:"_balanceWrap_14625_69",balance:"_balance_14625_69",maxBalance:"_maxBalance_14625_91",unlimited:"_unlimited_14625_33",text:"_text_14625_104",authQuantityWarnTip:"_authQuantityWarnTip_14625_111",danger:"_danger_14625_118",info:"_info_14625_121",approveTip:"_approveTip_14625_124",footerActions:"_footerActions_14625_132"};var Uo=Q.toPlainString(10**40),Nn=e=>{typeof e!="string"&&(e=e.toString());let o=e?.length;return o<=9?36:o>=10&&o<12?32:o===12?30:o>=13&&o<=15?24:o>=16&&o<=18?20:o>=19&&o<=24?16:12},Zo=({address:e,coins:o,baseCoinId:t})=>{if(Array.isArray(o))return o.find(i=>i?.baseCoinId===t&&St(i?.address,e,{baseCoinId:t})||Zo({address:e,baseCoinId:t,coins:i?.childrenCoin}))},An=({txTypeInfo:e,walletAccount:o,approve:t,baseCoin:i,onAuthTokenAmountChange:n,updateApproveInfo:_})=>{let{walletId:c}=o,{tokenInfo:u,id:m,amount:p,authQuantity:f}=t||{},{autoEdit:l,defaultAmount:y,warnTip:d}=f||{},{address:b,decimals:T,symbol:w}=u,F=vo(w,12),[E,x]=(0,C.useState)(!1),[h,D]=(0,C.useState)(!1),[k,G]=(0,C.useState)(0),O=(0,pe.useMemoizedFn)((B=p)=>{D(Qe(B)),G(_o(B,T)),x(!0)}),U=(0,C.useMemo)(()=>d?{type:S.info,text:d}:h&&!Qe(y)?{type:S.danger,text:a("wallet_extension_approve_alert_high_risk_unlimited")}:!h&&Q.eq(k||0,0)?{type:S.info,text:a("wallet_extension_approve_cannot_zero")}:null,[d,h,y,k]),{chainId:W}=i||{},{coinId:j}=xe(void 0,void 0,{chainId:W,address:b})||{},z=Le(j,c)?.coinAmount,J=Q.thousandFormat(z),Z=(0,pe.useMemoizedFn)(()=>{D(!1),G(z)}),oe=(0,C.useMemo)(()=>!(h||Q.gt(`${k||0}`,0)),[h,k]),ae=(0,pe.useMemoizedFn)(()=>{let B=h?Pt:fo(k,T);n(B),_(m,{amount:B}),x(!1)}),I=go(),V=Yt({},c),X=(0,C.useMemo)(()=>V?.find(B=>B.localType===i?.localType),[i?.localType,V?.length]),le=(0,pe.useMemoizedFn)(async(B=0)=>{if(!Zo({address:b,coins:I,baseCoinId:i?.coinId}))try{let he=await Bt({contractAddress:b,chainInfo:X});await Gt(he)}catch(he){++B<3?le(B):vt.error({title:he?.msg||a("wallet_home_toast_network_error")})}});return(0,pe.useMount)(()=>{l&&O(y),le()}),C.default.createElement(g.Box,{className:S.root},C.default.createElement(g.Box,{className:S.icon,onClick:()=>{O()}},C.default.createElement(ut,{className:"okx-wallet-plugin-draw-20"})),C.default.createElement(R.Action,{hideCloseBtn:!0,noContentPadding:!0,visible:E},C.default.createElement(g.Box,{className:S.editApproveAmountModal},C.default.createElement(g.Box,{className:S.content},C.default.createElement(To,{bordered:!1,txTypeInfo:e,className:S.txTypeInfo}),C.default.createElement(g.Box,{className:S.editArea},h?C.default.createElement(H.Text,{className:S.unlimitedText},a("wallet_extension_transfer_title_unlimited_amount",{token:C.default.createElement(H.Text,{className:S.unlimitedSymbol},F)})):C.default.createElement(Kt,{symbol:F,autoSize:Nn,placeholder:"0",max:Uo,decimals:T,value:k,onChange:B=>{mt(B,Uo)&&G(B)},style:{fontWeight:700,height:"42px"},symbolClassName:S.symbolClassName})),C.default.createElement(g.Box,{className:S.quickHandler},!!Number(z)&&C.default.createElement(g.Box,{className:S.balanceWrap},C.default.createElement(H.Text,{className:S.balance,ellipsis:{tooltip:J}},a("wallet_extension_approve_label_balance",{amount:J})),C.default.createElement(g.Box,{className:S.maxBalance,onClick:Z},a("commonall_enterfield_btn_max"))),C.default.createElement(g.Box,{onClick:()=>{D(B=>!B),G(0)},className:S.unlimited},C.default.createElement(g.Box,{className:S.text},a("wallet_extension_transfer_dialog_checkbox_set_to_unlimited")),C.default.createElement(ft,{checked:h}))),!!U&&C.default.createElement(g.Box,{className:(0,Yo.default)(S.authQuantityWarnTip,U.type)},U.text)),C.default.createElement(g.Box,{className:S.approveTip},a("wallet_extension_approve_desc_dapp_right")),C.default.createElement(Dt,{affixStyle:{position:"none"},placeholder:!1,className:S.footerActions},C.default.createElement(A,{block:!0,disabled:oe,category:A.CATEGORY.fill,type:A.TYPE.primary,size:A.SIZE.lg,onClick:ae},a("wallet_extension_approve_btn_amount_confirmation"))))))},Vo=An;r();s();var Me=P(q()),qo=P(ye());pn();ln();var In=({coinId:e,txType:o,txParams:t,isMev:i,mevInfo:n,localType:_,modifiedData:c,walletAccount:u,customGasInfo:m,gasReturnActivity:p,modifiedDataError:f,isSufficientGas:l,isSufficientBalance:y,reportGasReturnActivityDataInConfirm:d,canConfirm:b,silentLoading:T,onCancel:w,onConfirm:F,onConfirmReplace:E,isBalanceLoadError:x,isBalanceLoading:h})=>{let{walletId:D}=u||{},k=Io(),{networkFee:G,gasType:O,gasPrice:U}=m||{},W=po({coinId:e,walletId:D,localType:_,fromAddr:t?.from}),j=$t({coinId:e,toAddr:t?.to,fromAddr:t?.from,txSource:wt.DAPP,coinAmount:(ke(t?.value)?Y(t?.value):t?.value)||0,serviceCharge:G,inputData:c,mev:i?n?.name:"",activityId:p?.activityId}),z=(0,Me.useMemo)(()=>m?.isNetworkFeeLoading||Pe(m,o)||x||f||T||b===!1||!l||!y,[T,m,o,f,b,l,y,x]),J=(0,qo.useMemoizedFn)(async()=>{if(E&&typeof F=="function")return F({isMev:i,coinId:e,mevInfo:n,txParams:t,customGasInfo:m,modifiedData:c,gasReturnActivity:p,reportGasReturnActivityDataInConfirm:d});let{nonce:oe,updateGasInfo:ae}=await k({to:t?.to,from:t?.from,coinId:e,gasPrice:U,userGasInfo:m,amount:Y(t?.value)||0,baseCoinAmountUse:Y(t?.value||0)});d();let I={...t,...m,...ae||{},nonce:oe,data:c};try{let V=await W(I),X=await qt(st,V);return await j(V,{txHash:X,extJson:JSON.stringify({to:I?.to,gasType:O,from:I?.from,value:ke(I?.value)?Y(I?.value):I?.value,nonce:ke(I?.nonce)?Y(I?.nonce):I?.nonce,data:I?.data,gas:I?.gasLimit,oldTxHash:"",gasPrice:I?.supportEip1559?I?.maxFeePerGas:I?.gasPrice,repeatTxType:Et.CONFIRMING,priorityFee:I?.supportEip1559?I.maxPriorityFeePerGas:0})}),F?.({txHash:X})}catch(V){return F?.({error:V})}}),Z=(0,Me.useMemo)(()=>({disabled:z,loading:h,actionType:Je.ACTION_TYPE.CONFIRM,onClick:J}),[z,J,h]);return(0,Me.useMemo)(()=>[{onClick:w,actionType:Je.ACTION_TYPE.CANCEL},Z],[Z,w])},Qo=In;r();s();var De=P(q());ne();var Pn=e=>{let[o,t]=(0,De.useState)({isNetworkFeeLoading:!0,gasLimit:"0",gasPrice:"0",maxFeePerGas:"0",maxPriorityFeePerGas:"0",supportEip1559:!1,gasType:K.STANDARD}),{gasLimitInfo:i={},gasLimit:n,gasPrice:_,maxFeePerGas:c,gasType:u,supportEip1559:m,customConfirmed:p,isGasLimitLoading:f,isNetworkFeeLoading:l,networkFee:y,maxPriorityFeePerGas:d,gasPriceInfo:b,extFee:T}=o,{minGasFee:w}=Rt({gasLimit:n,gasPrice:_,maxPriorityFeePerGas:d,maxFeePerGas:c,supportEip1559:m,extFee:T,gasPriceInfo:b,gasLimitInfo:i,gasType:u}),F=(0,De.useMemo)(()=>u===K.CUSTOM&&!p?a("extension_send_mid_text_dapps_suggested_fee"):u||K.STANDARD,[p,u]),E=Pe(o,e),x=l&&f&&!i?.gasLimit;return{level:F,estimateFailed:E,customGasInfo:o,loading:l,networkFee:x?void 0:w,maxNetworkFee:x?void 0:y,onCustomGasInfoChange:t}},jo=Pn;r();s();var Te=P(q());mn();Ne();var kn=({txType:e,walletId:o,coinId:t,txParams:i,customGasInfo:n,preExecuteLoading:_})=>{let[c,u]=(0,Te.useState)(""),m=xe(t),{from:p,to:f}=i||{},[l,y]=(0,Te.useState)("");(0,Te.useEffect)(()=>{_||(Ke(e)||yo(e)?(u(je.approval),y(Ke(e)?"approve":"revoke_approve")):(u(je.dapp),y("Contract interaction")))},[_,e]);let d=Vt({walletId:o,coinId:t,fromAddress:p,toAddress:f,txType:c,fee:ct(n?.networkFee),disabled:!f,unavailable:n.gasType===K.CUSTOM&&n.customConfirmed}),{status:b,activity:T,activityId:w,tip:F,clear:E}=d,x=()=>{pt({activityId:w,activity:T,status:b,tip:F,walletId:o,address:p})},h=T?.errorCode;return(0,Te.useEffect)(()=>{!l||h===0&&Qt({wallet_address:p,interactive_address:f,chain_id:m?.chainId,transaction_type:l})},[h,l,p,f,m?.chainId]),{gasReturnActivity:d,clearGasReturnInfo:E,reportGasReturnActivityDataInConfirm:x}},Jo=kn;r();s();Ne();var Ln=e=>{let{txParams:o={}}=e,{gasPrice:t,maxFeePerGas:i,maxPriorityFeePerGas:n}=o,_=o.gas||o.gasLimit,c=K.STANDARD,u,m,p,f=Y(_),l=Y(t),y=Y(i),d=Y(n);return fe(l,0)&&(c=K.CUSTOM,u=l),fe(y,0)&&fe(d,0)&&fe(y,d)&&(c=K.CUSTOM,m=y,p=d),fe(f,0)&&(c=K.CUSTOM),!o.to&&o.data&&(c=K.CUSTOM),{initialGasType:c,initialCustomMaxPriorityFee:p,initialCustomGasLimit:f,initialCustomGasPrice:u,initialCustomMaxBaseFee:Ee(m,p)}},Ko=Ln;r();s();var Oe={"data-input":"_data-input_dry9a_1",dataInput:"_data-input_dry9a_1","data-input-error-tip":"_data-input-error-tip_dry9a_5",dataInputErrorTip:"_data-input-error-tip_dry9a_5","mev-status__wrap":"_mev-status__wrap_dry9a_10",mevStatusWrap:"_mev-status__wrap_dry9a_10"};var Sn=e=>Number(e)===Ae.INCREASE_ALLOWANCE?zo:[],Bn=e=>{let{txId:o,chainId:t,walletId:i,txParams:n,dappInfo:_={},needMev:c=!1,openMev:u=!1,coinId:m,isShowBlockSwapMevTooltip:p,onMevChange:f,onConfirm:l,onConfirmReplace:y,onCancel:d}=e||{},[b,T]=(0,ue.useSetState)({mevInfo:{},isMev:u}),[w,{toggle:F}]=(0,ue.useBoolean)(!1),{from:E,to:x,value:h="0x0",data:D}=n||{},[k,G]=(0,M.useState)(""),O=xe(m,void 0,{chainId:t}),U=O?.coinId,[W,j]=(0,M.useState)({}),z=W.loading,J=(0,M.useMemo)(()=>!x&&D?Jt.DEPLOY_CONTRACT:W?.approveInfoList?.[0]?.spender?.approvalType||"",[x,D,W]),Z=Ht(O?.localType,i),oe=Y(h),ae=Ko({txParams:n}),I=uo(Z.walletId),V=(0,M.useMemo)(()=>Wo(k),[k]),{isMev:X,mevInfo:le}=b,B=k||D||"",Xe=(0,M.useMemo)(()=>({dappData:JSON.stringify({to:x,from:E,value:h,data:B}),from:E,dappInfo:_,chainIndex:O?.chainId,method:At.SIGN_TRANSACTION}),[O?.chainId,E,B,x,h]),he=(0,ue.useMemoizedFn)((ie,_e)=>{T({isMev:ie,mevInfo:_e}),f?.(ie,_e)}),{level:$o,networkFee:Xo,maxNetworkFee:be,customGasInfo:Re,estimateFailed:et,loading:Ro,onCustomGasInfoChange:en}=jo(J),{gasReturnActivity:tt,reportGasReturnActivityDataInConfirm:tn}=Jo({txType:J,coinId:U,txParams:n,customGasInfo:Re,preExecuteLoading:z,walletId:Z.walletId}),{coinAmountInt:de,coinAmount:on,isBalanceLoadError:ot,isBalanceLoading:nn,requestBalance:an}=Le(U,i),nt=(0,M.useMemo)(()=>(We(de)||Q.gte(de,be))&&W?.needFillUp!==!0,[de,be,W?.needFillUp]),at=(0,M.useMemo)(()=>!Q.eq(oe,0)&&!We(de)?Q.lte(oe,Q.sub(de,be)):!0,[de,be,oe]),rn=Qo({coinId:U,txType:J,txParams:n,isMev:X,mevInfo:le,isBalanceLoadError:ot,isBalanceLoading:nn,canConfirm:W?.canConfirm,silentLoading:W?.silentLoading,isSufficientGas:nt,isSufficientBalance:at,walletAccount:Z,customGasInfo:Re,gasReturnActivity:tt,modifiedDataError:V,localType:O?.localType,modifiedData:B,walletId:Z?.walletId,reportGasReturnActivityDataInConfirm:tn,onCancel:d,onConfirm:l,onConfirmReplace:y}),sn=(0,ue.useMemoizedFn)(ie=>{let _e=Sn(J),Fe=It(n?.data,_e);if(Fe){let He=xo(n?.data,{approveAmount:ie},Fe);G(He)}});return M.default.createElement(M.default.Fragment,null,M.default.createElement(ho,{handleCancel:d,preExecParams:Xe,walletAccount:Z,buttonGroup:rn,onUpdatePreExecInfo:j,txState:{txId:o,baseCoin:O,estimateFailed:et,isSufficientBalance:at,isSufficientGas:nt,baseCoinAmount:on,isBalanceLoadError:ot,requestBalance:an},slot:{mev:!!c&&M.default.createElement(Oo,{isMev:X,needTooltip:!1,className:Oe["mev-status__wrap"],chainId:O?.chainId,onMevChange:he,isShowBlockSwapMevTooltip:p}),networkFeeEntry:M.default.createElement(no,{level:$o,coinId:U,networkFee:Xo,loading:Ro,estimateFailed:et,onClick:()=>{F(),I({trade:"contract_interaction",all_confirmation:"network_fee"})}}),interactWith:!!x&&M.default.createElement(ao,{address:x,title:a("wallet_extension_popup_text_interact_with")}),advancedEntry:!D&&M.default.createElement(Ho,{value:k,error:V,onChange:G,className:Oe["data-input"],errorTipClass:Oe["data-input-error-tip"]})},renderEditApproveAmount:(ie,_e)=>{let Fe=ie?.authQuantity?.canEdit,He=ie?.spender?.approvalType;return[Ae.INCREASE_ALLOWANCE,Ae.AUTHORIZATION].includes(He)&&Fe?M.default.createElement(Vo,{txTypeInfo:W?.txTypeInfo,walletAccount:Z,approve:ie,baseCoin:O,onAuthTokenAmountChange:sn,updateApproveInfo:_e}):null}}),M.default.createElement(eo,{visible:w,coinId:U,address:E,inputData:B,tokenAddress:x,value:Y(h),onBack:F,onClose:null,initialGasData:ae,onGasChange:en,minimumGasLimit:X?le.gas:0,isMev:X,mevInfo:le,gasReturn:tt,gasLimitOptions:{disabled:V}}))},js=Bn;export{Io as a,Ho as b,Wo as c,Oo as d,js as e};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-JWQGMLG5.js.map
