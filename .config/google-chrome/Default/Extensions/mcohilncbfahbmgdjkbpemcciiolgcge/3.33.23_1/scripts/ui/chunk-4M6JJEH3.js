import{n as so}from"./chunk-SAKTBF4N.js";import{a as J}from"./chunk-HOITYUNE.js";import{a as j}from"./chunk-3OHPQNDG.js";import{a as mo}from"./chunk-H3WNV4JD.js";import{a as dt}from"./chunk-ZCIPA4CD.js";import{a as ro}from"./chunk-V2C2H4YP.js";import{b as no}from"./chunk-F7YYSTTZ.js";import{a as E}from"./chunk-SYQTAGUC.js";import{a as io}from"./chunk-X6LGMUFV.js";import{c as $t,d as V}from"./chunk-6M2GCKDH.js";import{c as eo,j as ft,k as ut}from"./chunk-SUU55JAC.js";import{a as oo}from"./chunk-KTRYKYE5.js";import{a as A}from"./chunk-V2A2AEVZ.js";import{f as lt,g as Xt,h as Rt,i as to}from"./chunk-5NP5YBP7.js";import{a as I,d as b,e as pt,g as z}from"./chunk-SIIB3XCZ.js";import{q as d}from"./chunk-UTVBVZWC.js";import{c as Qt}from"./chunk-FWZNHZQB.js";import{d as ao}from"./chunk-FXQ35K27.js";import{a as ct}from"./chunk-FSQDFL3V.js";import{a as mt}from"./chunk-SJRV5U24.js";import{a as jt}from"./chunk-4BUFJ3ZT.js";import{b as zt}from"./chunk-XZ6AHFH2.js";import{a as Kt}from"./chunk-3DEZPDXQ.js";import{a as Zt}from"./chunk-6UFIPREK.js";import{a as v}from"./chunk-ZUBNNPBM.js";import{a as U}from"./chunk-LXIBKSOK.js";import{d as Jt}from"./chunk-C53RLQYB.js";import{b as Nt}from"./chunk-S3O4LR55.js";import{i as Ot,p as Yt,q as G}from"./chunk-FZCNSMLW.js";import{o as Wo}from"./chunk-KCWFMCND.js";import{Va as vt,Z as R,ga as Ht,la as Ut,w as H}from"./chunk-3TDWET6C.js";import{Na as N,Ra as st}from"./chunk-W6Q44ZHW.js";import{d as qt,f as Fo}from"./chunk-3HS6AHPS.js";import{a as Vt}from"./chunk-JUXPONKW.js";import{i as kt}from"./chunk-WSUAESF2.js";import{c as w}from"./chunk-FDCWN4NG.js";import{Nb as Wt,Za as it,dc as So,w as O,wb as Mo,y as Pt}from"./chunk-O3CM75EN.js";import{G as Et,b as bt,c as at}from"./chunk-J3CEQI22.js";import{e as Ft,pa as Bo}from"./chunk-VFHYER2K.js";import{L as Y,w as i}from"./chunk-KJIO572I.js";import{T as Lt,c as Gt,ca as S}from"./chunk-KALFZBR5.js";import{a as P}from"./chunk-EAZTJZU7.js";import{f,m as a,o as s}from"./chunk-ZCHLW7CF.js";a();s();var Tt=f(P());Pt();a();s();var Z=f(P()),lo=f(H());Bo();Pt();a();s();var ot=f(P());var Go=t=>{let[o,e]=(0,ot.useState)(null),[n,r]=(0,ot.useState)(!1),m=mt();return(0,ot.useEffect)(()=>{if(m?.length){let c=m.find(p=>p.realChainIdHex===t);c?(e(c?.chainId),r(!1)):(e(+Vt(t)),r(!0))}},[m,t]),{chainIndex:o,isRpcChain:n}},_t=Go;a();s();var et=f(H());Mo();var D=(t,o)=>{let e=(0,et.useSelector)(Ut),n=(0,et.useSelector)(zt),r=(0,et.useSelector)(Ht),m=u=>({...u,address:o}),c=(0,et.useSelector)(vt);if(n[t]?.includes(r)&&e[r]?.account[it]===o)return m(e[r]||{});let p=jt(t,c);if(n[t]?.includes(p)&&e[p]?.account[it]===o)return m(e[p]);let l=n[t]?.find(u=>e[u]?.account[it]===o);return l?m(e[l]):{}};a();s();var Dt=f(H());st();a();s();var co=f(H());So();var Lo=t=>{let o=(0,co.useSelector)(R),e=Kt(),n=(r,m)=>e.find(c=>c.localType===m||Wt(c.chainId,r))||{};return t?n(t):n(o.chainId,o.type)},B=Lo;var At=t=>{let o=(0,Dt.useDispatch)(),e=J(),{walletId:n}=D(t.origin,t.msgParams?.from),r=A(n),m=B(t?.chainId);return async()=>{r({all_confirmation:"cancel",trade:"sign",dapp_url:t.origin,network:m?.chainName});let{id:c}=t;await e({id:c}),await N(o)}},Oo=t=>{let o=(0,Dt.useDispatch)(),e=j(),n=At(t),{walletId:r}=D(t.origin,t.msgParams?.from),m=lt({walletId:r}),c=A(r),p=B(t?.chainId);return async()=>{let{id:l,msgParams:u,type:x}=t;try{if(c({all_confirmation:"confirm",trade:"sign",dapp_url:t.origin,network:p?.chainName}),!await ct({walletId:r,callback:async()=>{await n(),await N(o)}}))return;let W=await m({msgParams:u,baseChain:t.localType,type:x});await e({id:l,result:W}),await N(o)}catch(y){e({id:l,error:y?.message||"Failed"})}}},Yo=({unapproved:t,preExecInfo:o={}})=>{let e=At(t),n={actionType:d.ACTION_TYPE.CANCEL,onClick:At(t)},r={actionType:d.ACTION_TYPE.CONFIRM,disabled:o?.canConfirm===!1,onClick:Oo(t)};return{buttonGroup:[n,r],handleCancel:e}},po=Yo;var qo=({unapproved:t={}})=>{let[o,e]=(0,Z.useState)({}),n=E(t),{buttonGroup:r,handleCancel:m}=po({unapproved:t,preExecInfo:o}),{type:c,msgParams:p,chainId:l}=t,{chainId:u}=(0,lo.useSelector)(R),x=l||u,{from:y}=p,W=(0,Z.useMemo)(()=>{let k=t.msgParams?.data,q={[O.ETH_SIGN](){return[{value:k}]},[O.PERSONAL_SIGN](){return[{value:Qt(k)}]},[O.ETH_SIGN_TYPED_DATA](){return k}};return Ft(q[c])?q[c]():[]},[c,t.msgParams?.data]),$=D(t.origin,y)||{},Q=_t(x),M=(0,Z.useMemo)(()=>({method:c,dappData:JSON.stringify(p),dappInfo:n,from:y,...Q}),[Q?.chainIndex]);return Z.default.createElement(ut,{txType:ft.signMessage,handleCancel:m,preExecParams:M,walletAccount:$,buttonGroup:r,onUpdatePreExecInfo:e,slot:{advanced:Z.default.createElement(io,{message:W})}})},fo=qo;a();s();var C=f(P()),wo=f(H());Y();a();s();var g=f(P());Y();a();s();var Bt=f(P()),uo=f(H());st();var Ho=({unapproved:t,walletAccount:o,preExecInfo:e={}})=>{let n=(0,uo.useDispatch)(),{walletId:r}=o,m=A(r),c=B(t.chainId),p=j(),l=J(),u=lt({walletId:r}),x=(0,Bt.useCallback)(async()=>{let{id:M}=t;m({trade:"sign",all_confirmation:"cancel",network:c?.chainName,dapp_url:t?.origin}),await l({id:M}),await N(n)},[c?.chainName,l,m,n,t]),y=(0,Bt.useCallback)(async()=>{let{msgParams:M,id:k,localType:q,type:rt}=t;try{if(m({trade:"sign",all_confirmation:"confirm",network:c?.chainName,dapp_url:t?.origin}),!await ct({walletId:r,callback:async()=>{await x()}}))return;let nt=await u({msgParams:M,baseChain:q,type:rt});await p({id:k,result:nt}),await N(n)}catch(X){p({id:k,error:X?.message||"Failed"})}},[t,m,r,n,x,c?.chainName,u,p]),W={actionType:d.ACTION_TYPE.CANCEL,onClick:x},$={actionType:d.ACTION_TYPE.CONFIRM,type:S.TYPE.highlight,disabled:e?.canConfirm===!1,onClick:y};return{buttonGroup:[W,$],handleCancel:x}},yt=Ho;a();s();var Ct=f(P());a();s();var gt={root:"_root_szca8_1",icon:"_icon_szca8_5",showValue:"_showValue_szca8_11"};var Uo=({icon:t,amount:o,symbol:e})=>Ct.default.createElement(w.Box,{className:gt.root},Ct.default.createElement(at,{src:t,className:gt.icon}),Ct.default.createElement(G.AdaptiveText,{autoSize:no,ellipsis:{tooltip:!0},className:gt.showValue},"- ",o," ",e)),_o=Uo;a();s();var It=f(P()),yo=f(Gt()),go=f(Wo());a();s();var wt={root:"_root_1wji9_1",price:"_price_1wji9_4",switchIcon:"_switchIcon_1wji9_11"};var vo=({fromSymbol:t,toSymbol:o,price:e,reversePrice:n})=>{let[r,{toggle:m}]=(0,go.useBoolean)(!1),c=r?o:t,p=r?t:o,l=r?n:e;return It.default.createElement(w.FlexBox,{className:wt.root},It.default.createElement(G.Text,{size:G.SIZE.sm,ellipsis:{tooltip:!0},className:wt.price},"1 ",c," = ",l," ",p),It.default.createElement(Nt,{size:Nt.SIZE.xs,className:(0,yo.default)("okx-wallet-plugin-switch",wt.switchIcon),onClick:m}))},Mt=vo;var zo={CREATE:"10",REVOCATION:"20"},Vo=({unapproved:t={}})=>{let o=B(t.chainId),{dexExtraData:e}=JSON.parse(t.msgParams.data),n=E(t),r=D(t.origin,t.msgParams?.from),{buttonGroup:m}=yt({unapproved:t,walletAccount:r}),{expiration:c,order:p,predictPriceFormat:l,reversePredictPrice:u,sellTokenAmountFormat:x,sellTokenImage:y,sellTokenSymbol:W,type:$}=e,Q={icon:y,symbol:W,amount:x},{fromSymbol:M,toSymbol:k,priceFormat:q,reversePrice:rt}=p,X=A(r.walletId);return g.default.createElement(w.Container,null,g.default.createElement(v,{title:$===zo.CREATE?i("swaptrade_limit_title_place_limit_order"):i("swaptrade_limit_title_cancel_limit_order"),closeable:!1,backable:!1}),g.default.createElement(b,null,g.default.createElement(I,{title:i("extension_contract_interaction_maintitle_asset_changes"),tooltip:i("extension_infor_tooltip_asset_changestips")},g.default.createElement(_o,{...Q})),g.default.createElement(V,{...n})),g.default.createElement(b,null,g.default.createElement(pt,{title:i("wallet_extension_network_address_title_walletused"),address:r.address,walletId:r.walletId,onCopyCallback:()=>{X({trade:"contract_interaction",all_confirmation:"wallet_used_address"})}})),g.default.createElement(b,{bordered:!1},g.default.createElement(I,{title:i("swaptrade_limit_text_limit_price")},g.default.createElement(Mt,{toSymbol:k,price:q,fromSymbol:M,reversePrice:rt})),g.default.createElement(I,{title:i("swaptrade_limit_text_est_execution_price"),tooltip:i("swaptrade_limit_tooltip_estimated_price")},g.default.createElement(Mt,{toSymbol:k,fromSymbol:M,price:l,reversePrice:u})),g.default.createElement(I,{title:i("swaptrade_limit_text_expiry_time")},g.default.createElement(Yt,{size:Ot.sm,dateTime:c,format:"yyyyMMddHHmm"})),g.default.createElement(mo,{coinId:o?.coinId})),g.default.createElement(U,{placeholder:!0,offsetBottom:0,borderTop:!0},g.default.createElement(d,{buttonGroup:m})))},Co=Vo;a();s();var xt={crypto:"_crypto_1jaqx_1",image:"_image_1jaqx_7",chainName:"_chainName_1jaqx_12"};var jo={Permit:"Permit",Permit2:"Permit2"},Jo=({unapproved:t})=>{let[o,e]=(0,C.useState)({}),{chainId:n,msgParams:{version:r,data:m,from:c}}=t,{chainId:p}=(0,wo.useSelector)(R),u=_t(n||p),x=E(t),y=D(t.origin,c)||{},{buttonGroup:W,handleCancel:$}=yt({unapproved:t,preExecInfo:o,walletAccount:y}),Q=(0,C.useMemo)(()=>({dappInfo:x,dappData:JSON.stringify(t?.msgParams),from:c,method:`eth_signTypedData_${r.toLowerCase()}`,...u}),[u?.chainIndex]),[M={}]=mt({chainId:u?.chainIndex})||[];if(r==="V4"){let St={};try{St=JSON.parse(m)}catch(Do){console.log(Do)}if(St.dexExtraData)return C.default.createElement(Co,{unapproved:t})}let{message:k}=JSON.parse(t?.msgParams?.data||"{}"),q=o?.txTypeInfo,X=o?.txExtInfo?.contractList||[],nt=Object.values(jo).includes(q?.strategyType);return C.default.createElement(ut,{txType:ft.signMessage,handleCancel:$,preExecParams:Q,walletAccount:y,buttonGroup:W,onUpdatePreExecInfo:e,slot:{network:nt&&M?.chainName?C.default.createElement(I,{title:i("wallet_dapp_conncetion_subtitle_network")},C.default.createElement(w.Box,{className:xt.crypto},C.default.createElement(at,{className:xt.image,src:M.imageUrl||kt,errorImg:kt}),C.default.createElement(G.Text,{ellipsis:{tooltip:!0},className:xt.chainName},M.chainName))):null,advanced:nt?C.default.createElement(C.default.Fragment,null,X?.length?C.default.createElement(eo,{advanced:{contractList:X}},C.default.createElement(dt,{message:k,noPadding:!0})):C.default.createElement(ro,null,C.default.createElement(dt,{message:k,noPadding:!0}))):C.default.createElement(I,{title:i("wallet_dapp_connection_subtitle_data_label")},C.default.createElement(dt,{noPadding:!0,message:k}))}})},Io=Jo;a();s();var F=f(P());Y();a();s();var K=f(P());Y();var Zo=({walletAccount:t,children:o,chainId:e})=>{let[n]=Jt(),{walletAsset:r}=Zt(t.walletId),m=A(t.walletId),c=B(e);return oo(c?.coinId,t.walletId),K.default.createElement(K.default.Fragment,null,K.default.createElement(b,null,K.default.createElement(pt,{title:i("wallet_extension_network_address_title_walletused"),address:t.address,walletId:t.walletId,onCopyCallback:()=>{m({trade:"contract_interaction",all_confirmation:"wallet_used_address"})}})),K.default.createElement(b,{bordered:!1},K.default.createElement(I,{title:i("wallet_dapp_connection_subtitle_balance")},K.default.createElement(G.DisplayAmount,{ellipsis:!0,size:G.SIZE.sm,mode:G.LEGAL,useApproximate:!1,hidden:n?"***":!1},r)),o))},ht=Zo;a();s();var h=f(P()),xo=f(Gt());Y();a();s();var tt={root:"_root_1xv1e_1",msgWrap:"_msgWrap_1xv1e_12",decrypted:"_decrypted_1xv1e_20",copyMsg:"_copyMsg_1xv1e_23",decryptMsg:"_decryptMsg_1xv1e_28"};var Ko=({rawData:t})=>{let o=$t({showDesc:!1});return h.default.createElement(S,{rect:!0,size:S.SIZE.xxs,type:S.TYPE.primary,category:S.CATEGORY.outline,className:tt.copyMsg,onClick:()=>{o(t)}},h.default.createElement(Lt,{className:"okx-wallet-plugin-copy"}),h.default.createElement(w.Box,null,i("wallet_extension_encrypted_text_copy")))},$o=({unapproved:t,decryptCb:o})=>{let e=Rt(),n=(0,h.useCallback)(async()=>{let{msgParams:r}=t,m=await e(r);o(m)},[o,e,t]);return h.default.createElement(S,{className:tt.decryptMsg,size:S.SIZE.sm,type:S.TYPE.primary,category:S.CATEGORY.outline,icon:"okds-locked",iconType:S.ICON_POSITION.leading,onClick:n},i("wallet_dapp_conncetion_subtitle_decrypt_metamask_information"))},Qo=({unapproved:t={}})=>{let[o,e]=(0,h.useState)(!1),[n,r]=(0,h.useState)(t.msgParams?.data),[m,c]=(0,h.useState)(!1),p=l=>{l.error?(c(!0),r(i("wallet_dapp_conncetion_errortip_decrypt_error",{errorMessage:l.error}))):r(l.rawData),e(!0)};return h.default.createElement(I,{title:i("wallet_extension_encrypted_text_encrypted_message")},h.default.createElement(w.Box,{className:tt.root},h.default.createElement(w.Box,{className:(0,xo.default)(tt.msgWrap,{[tt.decrypted]:o})},n),o?!m&&h.default.createElement(Ko,{rawData:n}):h.default.createElement($o,{unapproved:t,decryptCb:p})))},ho=Qo;a();s();var To=f(H());Y();st();var Xo=(t,o)=>{let{id:e}=t,n=(0,To.useDispatch)(),r=A(o?.walletId),m=B(),c=J(),p={actionType:d.ACTION_TYPE.CANCEL,btnText:i("wallet_dapp_connection_btn_reject"),async onClick(){r({all_confirmation:"cancel",trade:"decrypt_message",dapp_url:t.origin,network:m?.chainName}),await c({id:e}),await N(n)}},l=to(),u=j(),x={actionType:d.ACTION_TYPE.CONFIRM,async onClick(){try{r({all_confirmation:"confirm",trade:"decrypt_message",dapp_url:t.origin,network:m?.chainName});let{msgParams:y}=t,W=await l(y);await u({id:e,result:W}),await N(n)}catch(y){console.log(y),u({id:e,error:"Failed"})}}};return[p,x]},Po=Xo;var Ro=({unapproved:t})=>{let o=E(t),e=D(t.origin,t.msgParams?.from),n=E(t),r=Po(t,e),m=(0,F.useMemo)(()=>({type:z.TIP_TYPE.NORMAL,message:i("wallet_dapp_conncetion_notify_decrypt_message",{siteName:n.name||n.host})}),[n]);return F.default.createElement(w.Container,null,F.default.createElement(v,{title:i("wallet_dapp_conncetion_subtitle_decrypt_request"),closeable:!1,backable:!1}),F.default.createElement(b,null,F.default.createElement(V,{...o})),F.default.createElement(ht,{walletAccount:e,chainId:t.chainId},F.default.createElement(ho,{unapproved:t})),F.default.createElement(U,{placeholder:!0,offsetBottom:0,borderTop:!0},F.default.createElement(z,{...m}),F.default.createElement(d,{buttonGroup:r})))},bo=Ro;a();s();var L=f(P());Y();a();s();var Eo=f(H());Y();st();var te=(t,o)=>{let{id:e}=t,n=(0,Eo.useDispatch)(),r=A(o?.walletId),m=B(),c=J(),p={actionType:d.ACTION_TYPE.CANCEL,btnText:i("wallet_dapp_connection_btn_reject"),async onClick(){r({all_confirmation:"cancel",trade:"get_public_key",dapp_url:t?.origin,network:m?.chainName}),await c({id:e}),await N(n)}},l=Xt(),u=j(),x={actionType:d.ACTION_TYPE.CONFIRM,btnText:i("wallet_dapp_conncetion_btn_provide"),async onClick(){try{r({all_confirmation:"confirm",trade:"get_public_key",dapp_url:t?.origin,network:m?.chainName});let y=await l(t.msgParams);u({id:e,result:y}),await N(n)}catch(y){console.log(y),u({id:e,error:"Failed"})}}};return[p,x]},ko=te;var oe=({unapproved:t})=>{let o=D(t.origin,t.msgParams),e=ko(t,o),n=E(t),r=E(t),m=(0,L.useMemo)(()=>({type:z.TIP_TYPE.NORMAL,message:i("wallet_dapp_conncetion_notify_public_key_notice",{siteName:r.name||r.host})}),[r]);return L.default.createElement(w.Container,null,L.default.createElement(v,{title:i("wallet_dapp_conncetion_notify_public_key_request"),closeable:!1,backable:!1}),L.default.createElement(b,null,L.default.createElement(V,{...n})),L.default.createElement(ht,{walletAccount:o,chainId:t.chainId}),L.default.createElement(U,{placeholder:!0,offsetBottom:0,borderTop:!0},L.default.createElement(z,{...m}),L.default.createElement(d,{buttonGroup:e})))},No=oe;var ee=t=>{let{msgParams:{version:o},type:e}=t;return e===O.ETH_GET_ENCRYPTION_PUBLIC_KEY?No:e===O.ETH_DECRYPT?bo:e===O.ETH_SIGN_TYPED_DATA&&["V3","V4"].includes(o)?Io:fo},re=(0,Tt.memo)(t=>{let{unapproved:o={}}=t,e=ee(o);return Tt.default.createElement(e,{unapproved:o})}),ca=re;a();s();var T=f(P());Y();Pt();var ne=({unapproved:t})=>{let[o,{cancel:e,approve:n}]=so(t),r=E(o),{customNets:m}=ao(),c=m.find(l=>l.rpcUrl===o.rpcUrl),p=(0,T.useMemo)(()=>{let l={actionType:d.ACTION_TYPE.CANCEL,onClick:e},u={disabled:!!c,actionType:d.ACTION_TYPE.CONFIRM,btnText:i("developer_mode_add_network_btn_approve"),async onClick(){await n(),Et.success({duration:1.5,title:i("developer_mode_home_toast_added"),placement:Et.DIRECTION.top})}};return[l,u]},[n,e]);return T.default.createElement(w.Container,null,T.default.createElement(v,{title:i("developer_mode_add_network_maintitle_add_network"),backable:!1,closeable:!1}),T.default.createElement(b,null,T.default.createElement(V,{...r})),T.default.createElement(b,{bordered:!1},T.default.createElement(I,{title:i("developer_mode_add_network_title_network_name"),tooltip:i("wallet_dapp_conncetion_add_network_subtitle_network_name_tips")},o.type||o.chainName),o.switchType===O.ADD_ETHEREUM_CHAIN&&[T.default.createElement(I,{title:i("developer_mode_add_network_title_networkurl"),tooltip:i("wallet_dapp_conncetion_add_network_subtitle_network_url_tips")},o.rpcUrl),T.default.createElement(I,{title:i("developer_mode_add_network_title_chainid"),tooltip:i("wallet_dapp_conncetion_add_network_subtitle_chain_id_tips")},o.chainIdToDisplay),T.default.createElement(I,{title:i("developer_mode_add_network_title_currency_symbol"),tooltip:i("wallet_dapp_conncetion_add_network_subtitle_currency_symbol_tips")},o.ticker),T.default.createElement(I,{title:i("developer_mode_add_network_title_block_explorerurl"),tooltip:i("wallet_dapp_conncetion_add_network_subtitle_explorer_url_tips")},o.explorers||o.blockExplorerUrl)]),T.default.createElement(U,{placeholder:!0,offsetBottom:0,borderTop:!0},T.default.createElement(z,{type:c?bt.TYPE.error:bt.TYPE.warn,message:c?i("developer_mode_infor_errortip_used_network",{network:c.name}):i("developer_mode_add_network_errortip_risk_aware")}),T.default.createElement(d,{buttonGroup:p})))},ka=ne;a();s();var Ao=f(P());Fo();var ie=()=>(0,Ao.useCallback)(async(t,o)=>{await qt().handleErc20Token(t,o)},[]),Ma=ie;export{Ma as a,D as b,B as c,ca as d,ka as e};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-4M6JJEH3.js.map
