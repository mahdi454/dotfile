import{a as kt}from"./chunk-RE7CXNX6.js";import{a as O}from"./chunk-226IQWB4.js";import{b as Wt}from"./chunk-X5KO5BYB.js";import{a as Nt}from"./chunk-Z77JUEZJ.js";import{a as Ct}from"./chunk-QHUQYXU6.js";import{a as bt}from"./chunk-4MZS5WUT.js";import{a as wt,b as St,c as It,e as ht,f as At,g as Ft,h as Pt}from"./chunk-V4GLNYXT.js";import{d as Dt}from"./chunk-HTCS5UFP.js";import{a as gt}from"./chunk-X4Z4JMVV.js";import{f as Q,g as Tt,h as yt}from"./chunk-RMSE4KTO.js";import{a as Et,d as C}from"./chunk-R5U3NPEX.js";import{d as _t,f as xt}from"./chunk-J2H2J7IS.js";import{a as k}from"./chunk-NEFZK4RT.js";import{a as le}from"./chunk-S6JYO3D5.js";import{s as ft}from"./chunk-YC6W5MPL.js";import{e as pt}from"./chunk-HXUMX2S7.js";import{q as x}from"./chunk-WKBC6JL3.js";import{a as ie}from"./chunk-LMIOM5QK.js";import{X as ce}from"./chunk-VPDRXROE.js";import{ca as A,l as ut,ta as dt}from"./chunk-VGT27A4M.js";import{c as M}from"./chunk-RXNDJ7P3.js";import{E as K,F as it,Hc as U,Jb as ae,Kc as se,X as ne,lb as ct,z as st}from"./chunk-YT2MPR4E.js";import{A as h,G as mt,M as z,b as v}from"./chunk-LDKM7IQF.js";import{K as q,ka as nt,pa as at}from"./chunk-6O63U2D6.js";import{M as j,x as f}from"./chunk-RIOWPXBZ.js";import{E as lt}from"./chunk-OSCGYMLH.js";import{a as P}from"./chunk-O337TVCZ.js";import{f as b,m as r,o as n}from"./chunk-GLD6H5Q5.js";r();n();var m=b(P());j();r();n();var _=b(P()),Gt=b(ce()),Mt=b(ie());j();r();n();var L={tabContent:"_tabContent_klbwj_1",data:"_data_klbwj_4",abi:"_abi_klbwj_7"};var me=t=>{let{data:e,copyable:a,tooltipZIndex:i,kysRet:u}=t,d=u?.intention?.contract?.[0],s=d?.methodName,l=d?.methodParameter,p=(0,_.useMemo)(()=>s&&l?JSON.stringify({[f("wallet_extension_transaction_tab_func")]:s,[f("wallet_extension_transaction_tab_params")]:l},null,2):"",[s,l]),o=(0,Gt.useMemoizedFn)(c=>{(0,Mt.default)(c),mt.success({title:f("wallet_receive_toast_address_copied")})},[e]);return _.default.createElement(O,{data:e,copyable:a,tooltipZIndex:i,title:f("wallet_extension_transaction_tab_advanced")},_.default.createElement(z.Underline,{size:lt.xs,noLine:!0,noPadding:!0,paneSpacing:24},_.default.createElement(z.TabPane,{tab:f("wallet_dapp_connection_subtitle_data_label"),id:"wallet_dapp_connection_subtitle_data_label"},_.default.createElement(M.Box,{className:L.tabContent},_.default.createElement(h,{graspBaseDom:!0,title:f("wallet_receive_btn_copy_address"),type:h.TYPES.neutral,trigger:h.TRIGGER_TYPES.hover,zIndex:i},_.default.createElement(x.Text,{forceWrap:!0,onClick:()=>{o(e)},size:x.SIZE.sm,className:L.data},e)))),p?_.default.createElement(z.TabPane,{tab:f("wallet_extension_transaction_tab_abi"),id:"wallet_extension_transaction_tab_abi"},_.default.createElement(M.Box,{className:L.tabContent,onClick:()=>{o(p)}},_.default.createElement(h,{noWrapper:!0,graspBaseDom:!0,title:f("wallet_receive_btn_copy_address"),type:h.TYPES.neutral,trigger:h.TRIGGER_TYPES.hover,zIndex:i},_.default.createElement("pre",{className:L.abi},p)))):null))},Lt=me;se();r();n();var Z=b(P());var ue=({message:t,bordered:e=!1})=>Z.default.createElement(C,{bordered:e},Z.default.createElement(O,null,Z.default.createElement(kt,{message:t,noPadding:!0}))),Bt=ue;r();n();at();j();var w=b(P());r();n();var D={root:"_root_ap48w_1",title:"_title_ap48w_1",detail:"_detail_ap48w_4",detailText:"_detailText_ap48w_7"};var de=({permission:t})=>{let e=(0,w.useMemo)(()=>{let a=[];try{t.forEach(({after:i})=>{i.detail.forEach(({authGrous:u})=>{u.forEach(d=>{a.push(d.address)})})})}catch{}return nt(a)},[t]);return e.length?w.default.createElement(C,{className:D.root},w.default.createElement(Et,{titleType:x.TYPE.danger,title:w.default.createElement(x.Text,{size:x.SIZE.xs,className:D.title},f("wallet_extension_tronsettings_title_authorize_address"))},e.map((a,i)=>w.default.createElement(M.Box,{className:D.detail},w.default.createElement(x.Text,{size:x.SIZE.sm,className:D.detailText,type:x.TYPE.secondary},f("wallet_extension_tronsettings_subtitle_addressnum",{num:i+1})),w.default.createElement(x.Text,{forceWrap:!0,size:x.SIZE.sm,className:D.detailText},a))))):null},Yt=de;r();n();at();r();n();r();n();var N=b(P());dt();ae();async function pe(t){let e={fromAddr:t.address,scenario:ut.SCENARIO_INTERACTION,inputData:t.inputData,toAddr:t.toAddr,dataLength:t.inputData.length};t.value&&(e.value=t.value);let{info:{fee:a}}=await ft({coinId:ct,address:t.address},e);return a}var Vt=(t={},e=!1)=>{let[a,i]=(0,N.useState)("0"),[u,d]=(0,N.useState)(!0),[s,l]=(0,N.useState)(!1);return(0,N.useEffect)(()=>{(async()=>{try{let o=await pe(t);o&&i(o),l(!1)}catch{l(!0)}finally{d(!1)}})()},[t.inputData,t.toAddr,t.address,t.coinId]),e?{error:s,trxFee:a,loading:u}:a};ne();r();n();var X=b(le()),fe=t=>{let e=t.params.transaction.raw_data||{contract:[{parameter:{value:{contract_address:""}}}]},a=t?.params?.transaction?.raw_data_hex||"",{data:i="",amount:u=0,to_address:d,contract_address:s,call_value:l=0}=e.contract[0].parameter.value,p=e.contract[0].type,o=l||u,c=s,T=s||d;try{c=X.default.address.fromHex(c),T=X.default.address.fromHex(T)}catch(y){console.log(y)}return{data:i,callValue:l,finalAmount:o,contractAddress:c,finalAddress:T,tronHexData:a,txType:p}},W=fe;var _e=({coinId:t,unapproved:e,verifyGasLimitRet:a})=>{let{data:i,callValue:u,finalAmount:d,contractAddress:s}=W(e),l=k(e),{loading:p,trxFee:o=0,error:c}=Vt({coinId:t,address:l.address,inputData:i,toAddr:s,value:d},!0),{isOffline:T=!1}=e.params,y=xt(t,e.walletId)?.coinAmountInt,F=T||q(y)||K(y,o)&&!Tt(a),I=!0;return it(u,0)||(I=q(y)||K(st(y,o),u)),{loading:p,networkFee:o,networkFeeProps:{coinId:t,loading:p,estimateFailed:c,networkFee:p?void 0:o},isSufficientGas:F,estimateFailed:c,isSufficientBalance:I}},vt=_e;r();n();var S=b(P());dt();var xe=({unapproved:t})=>{let e=gt(),[a,i]=(0,S.useState)(!0),{host:u}=Dt(t),d=k(t),[s,l]=(0,S.useState)({}),{data:p,finalAmount:o,finalAddress:c,tronHexData:T}=W(t),y=(0,S.useCallback)(async Y=>{let{coinId:E,chainId:H}=Y,G=await e({coinId:E,checkTypes:[A.VERIFY_GAS_LIMIT,A.TRON_PERMISSTION,A.KYS],amount:o,from:d.address,to:c,txType:3,domain:u,tokenAddress:c,inputData:p,chainId:H,additionalData:{tronHexData:T}});l(G),i(!1)},[o,c,p,u,e,d.address,T]),F=(0,S.useMemo)(()=>s[A.VERIFY_GAS_LIMIT]||{},[s]),I=(0,S.useMemo)(()=>s[A.TRON_PERMISSTION]||{},[s]);return{kysRet:(0,S.useMemo)(()=>({loading:a,...s[A.KYS]||{}}),[a,s]),loading:a,preExecute:y,setLoading:i,preExecuteRet:s,verifyGasLimitRet:F,tronPermisstionRet:I}},zt=xe;var Te=(0,m.memo)(({unapproved:t,onCancel:e,onConfirm:a,backable:i=!1,onBack:u,asPage:d})=>{let{extraData:s,isOffline:l=!1,extParams:p}=t.params||{},o=_t(U)||{},c=o?.coinId||U,{contractAddress:T,txType:y,data:F}=W(t),{initialType:I}=k(t),B=p?.shouldSend,Y=zt({unapproved:t,coinId:c,baseCoin:o}),{kysRet:E,preExecute:H,verifyGasLimitRet:G,tronPermisstionRet:R}=Y;(0,m.useEffect)(()=>{o?.coinId&&H(o)},[o?.coinId]);let{networkFee:V,networkFeeProps:Ot,isSufficientGas:$,estimateFailed:tt,isSufficientBalance:et,loading:Zt}=vt({coinId:c,unapproved:t,verifyGasLimitRet:G}),Ht=wt({initialType:I}),ot=y==="TriggerSmartContract"&&!T,Rt=()=>ot?{type:v.TYPE.warn,message:f("wallet_extension_confirmation_toast_not_compatible")}:null,Jt=()=>Q(R)?{type:v.TYPE.error,message:R.msg}:null,{permissionMsg:J}=E,jt=()=>J?{type:v.TYPE.error,message:J}:null,qt=St({estimateFailed:tt}),Kt=It({verifyGasLimitRet:G}),Ut=ht({kysRet:E}),Qt=At({kysRet:E}),Xt=Ft({baseCoin:o,isSufficientGas:$}),$t=Pt({isSufficientBalance:et}),te=Ct({},{custom:[Rt,Ht,Jt,qt,Kt,Xt,$t,jt,Ut,Qt]}),ee=(0,m.useMemo)(()=>l?{...s,serviceCharge:V}:B?{serviceCharge:V}:{},[s,l,B,V]),{buttonGroup:oe,handleCancel:re}=Wt({coinId:c,preExecuteRet:Y,unapproved:t,feeLoading:Zt,onCancel:e,onConfirm:a,networkFee:V,estimateFailed:tt,isSufficientGas:$,isSufficientBalance:et,extParams:ee,needCheckMpc:!0,chainConfirmDisabled:ot||pt(I)||Q(R)||yt(G)}),{permission:rt}=E;return bt({kysRet:E,handleCancel:re,coinId:c}),m.default.createElement(Nt,{backable:i,onBack:u,asPage:d,kysRet:E,unapproved:t,tipMessage:te,buttonGroup:oe,networkFee:Ot,contractAddress:T,chainTxDetailSlot:m.default.createElement(m.default.Fragment,null,J?m.default.createElement(m.default.Fragment,null,m.default.createElement(Yt,{permission:rt}),m.default.createElement(Bt,{message:rt})):null,F?m.default.createElement(C,{bordered:!1},m.default.createElement(Lt,{data:F,kysRet:E,copyable:{hideDesc:!0},tooltipZIndex:101})):null)})}),Xo=Te;export{pe as a,Xo as b};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-4DKWH5GY.js.map
