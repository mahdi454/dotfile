import{a as K}from"./chunk-FBTKKNCQ.js";import{d as ee}from"./chunk-UBFVE3Q4.js";import{c as C}from"./chunk-UXLFUD7T.js";import{a as A}from"./chunk-DLRFA5AU.js";import{b as Q}from"./chunk-Y6SGFHFT.js";import{X}from"./chunk-VPDRXROE.js";import{Oa as J,q as z,w as fe}from"./chunk-JLIPSIRU.js";import{A as H,B as F,C as M,D as W,E as $,P as w,X as N,Xb as Y,Zb as pe,ac as Z,bc as V,cc as j,dc as q,w as y,y as E,z as g}from"./chunk-YT2MPR4E.js";import{ea as U,ga as _,pa as le}from"./chunk-6O63U2D6.js";import{M as me,m as k}from"./chunk-RIOWPXBZ.js";import{a as v}from"./chunk-O337TVCZ.js";import{f as x,m as f,o as d}from"./chunk-GLD6H5Q5.js";f();d();var T={UNAPPROVED:"unapproved",APPROVED:"approved",REJECTED:"rejected",SIGNED:"signed",SUBMITTED:"submitted",FAILED:"failed",DROPPED:"dropped",SUCCEED:"succeed",PENDING:"pending"},l={TRANS_OUT:1,AUTHORIZATION:2,CONTRACT_CALL:3,CANCEL_AUTHORIZATION:4,CONTRACT_DEPLOY:5},Oe={[l.TRANS_OUT]:"wallet_extension_history_list_send",[l.CONTRACT_CALL]:"wallet_extension_history_list_contract_interaction",[l.AUTHORIZATION]:"wallet_extension_history_list_approval",[l.CANCEL_AUTHORIZATION]:"wallet_extension_history_list_revoke_approval",[l.CONTRACT_DEPLOY]:"developer_mode_history_title_contract_eployment"};f();d();var oe=x(v()),R=x(X());q();N();f();d();N();var re=async(e={})=>e?.baseFeePerGas!==void 0,L=e=>parseInt(e,16);function de({baseFeePerGas:e,number:r}){return{number:r,baseFeePerGas:e,gasUsedRatio:null,priorityFeesByPercentile:null}}function Te({baseFeePerGas:e,number:r,blockIndex:o,gasUsedRatios:n,priorityFeePercentileGroups:s,percentiles:t}){let i=n[o],a=s[o],u=t.reduce((c,m,p)=>{let h=a[p];return{...c,[m]:L(h)}},{});return{number:r,baseFeePerGas:e,gasUsedRatio:i,priorityFeesByPercentile:u}}async function te({web3:e,numberOfBlocks:r,endBlockNumber:o,percentiles:n,includeNextBlock:s}){let t=await e.eth.getFeeHistory(r,o,n),i=L(t.oldestBlock);if(t.baseFeePerGas!==void 0&&t.baseFeePerGas.length>0&&t.gasUsedRatio.length>0&&(t.reward===void 0||t.reward.length>0)){let a=s?t.baseFeePerGas:t.baseFeePerGas.slice(0,r),u=t.gasUsedRatio,c=t.reward??[],m=u.length;return a.map((p,h)=>{let b=L(p),B=E(i,h);return h>=m?de({baseFeePerGas:b,number:B}):Te({baseFeePerGas:b,number:B,blockIndex:h,gasUsedRatios:u,priorityFeePercentileGroups:c,percentiles:n})})}return[]}var I=1024;function Pe(e,r){F(e,r)&&(r=e);let o=[];for(let n=g(e,r);F(n,e);n=E(n,I)){let s=g(e,n),t=s<I?s:I,i=E(n,t);o.push({numberOfBlocks:t,endBlockNumber:i})}return o}var ne=async({web3:e,numberOfBlocks:r,endBlock:o="latest",percentiles:n=[],includeNextBlock:s=!1})=>{let t=n.length>0?Array.from(new Set(n)).sort((c,m)=>c-m):[],a=Pe(o,r);return(await Promise.all(a.map(({numberOfBlocks:c,endBlockNumber:m},p)=>p===a.length-1?te({web3:e,numberOfBlocks:c,endBlockNumber:m,percentiles:t,includeNextBlock:s}):te({web3:e,numberOfBlocks:c,endBlockNumber:m,percentiles:t,includeNextBlock:!1})))).reduce((c,m)=>[...c,...m],[])};var Ee=e=>e?C(e):{},he=["0x144","0x2105"],xe=e=>(0,oe.useCallback)(async()=>e?(await Ee(e)).eth.getBlock("latest"):{},[e]),Ze=e=>(0,R.useMemoizedFn)(async({to:r,from:o,value:n,data:s=""},t)=>{let i=!t,a="";return s?j(s)?a=z(s):a=V(s):i||(a=K(r,n||0)),await(await C(e)).eth.estimateGas({from:o,to:i?r:t,value:i?n:null,data:a||null})},[e]),S=["low","medium","high"],se={low:{percentile:10,base:1.1,priority:.94,minSuggestedMaxPriorityFeePerGas:1e9,estimatedWaitTimes:{minWaitTimeEstimate:15e3,maxWaitTimeEstimate:3e4}},medium:{percentile:20,base:1.2,priority:.97,minSuggestedMaxPriorityFeePerGas:15e8,estimatedWaitTimes:{minWaitTimeEstimate:15e3,maxWaitTimeEstimate:45e3}},high:{percentile:30,base:1.25,priority:.98,minSuggestedMaxPriorityFeePerGas:2e9,estimatedWaitTimes:{minWaitTimeEstimate:15e3,maxWaitTimeEstimate:6e4}}};function _e(e){let r=e.slice().sort((s,t)=>F(g(s,t),0)?-1:1),o=r.length,n=Math.floor((o-1)/2);return r[n]}var ge=(e,r,o)=>{let n=o[e],s=r[r.length-1].baseFeePerGas,t=y(s,n.base),i=r.map(p=>"priorityFeesByPercentile"in p?p?.priorityFeesByPercentile?.[n.percentile]:null).filter(Boolean),a=_e(i),u=y(a,n.priority),c=H([u,n.minSuggestedMaxPriorityFeePerGas]),m=E(t,c);return{baseFeePerGas:w(t,0),maxFeePerGas:w(m,0),maxPriorityFeePerGas:w(c,0)}},Fe=(e,r)=>S.reduce((o,n)=>{let s=ge(n,e,r),{maxFeePerGas:t}=s;return[...o,{level:n,isSupportEip1559:!0,gasPrice:t,...s}]},[]),Ce=(e,r)=>(0,R.useMemoizedFn)(async o=>{let n=await C(e),s=await ne({web3:n,endBlock:o.number,numberOfBlocks:21,percentiles:[10,20,30]});return Fe(s,r)},[e]),Re={low:{coefficient:1.1,level:"low"},medium:{coefficient:1.35,level:"medium"},high:{coefficient:1.7,level:"high"}},ye=(e,r)=>(0,R.useMemoizedFn)(async()=>{let n=await(await C(e)).eth.getGasPrice();return S.reduce((s,t)=>{let{level:i,coefficient:a}=r[t];return[...s,{level:i,gasPrice:y(n,a)}]},[])},[e]);function we(e){let{rpcNetworks:r}=ee(),o=r.find(n=>n?.rpcUrl===e);return S.reduce((n,s)=>{let t=o?.gasNormal?.[s]||Re[s]?.coefficient,i=o?.gas1559?.[s]||se?.[s];return{evmNormalGasPrice:{...n.evmNormalGasPrice,[s]:{level:s,coefficient:t}},evm1559GasPrice:{...n.evm1559GasPrice,[s]:{...se[s],base:i?.base,priority:i?.priority}}}},{})}var Ve=e=>{let r=we(e),o=xe(e),n=ye(e,r?.evmNormalGasPrice),s=Ce(e,r?.evm1559GasPrice);return(0,R.useMemoizedFn)(async t=>{if(e){let i=await o(),a=!he.includes(t)&&await re(i),u,c=a?s:n;try{u=await c(i)}catch{u=await n(i)}return u}return[]},[e])};f();d();var P=x(v()),G=x(fe()),ie=x(X());le();me();pe();q();N();function Ge(){return(0,G.useSelector)(J,G.shallowEqual)}function D(e,r){let o=Ge(),n=Q(),{extensionConfig:s}=A("rpc_info"),t=r||s;return(0,P.useMemo)(()=>Object.values(o).filter(i=>{if(!i.txParams)return!1;let{from:a,chainId:u}=i.txParams;return n===a&&u===t.chainId&&e(i)}),[o,n,t.chainId])}function at(e){return D(r=>r.status===T.FAILED||r.status===T.SUCCEED,e)}function ae(e){let[r,o]=e,n=+r,s=+k.add(1,"d",new Date(o));return t=>$(t,n)&&M(t,s)}function ce(e={},r=null){let{dates:o}=e,n=D(s=>s.status===T.FAILED||s.status===T.SUCCEED||s.status===T.DROPPED,r);return(0,P.useMemo)(()=>{let s=n;if(o){let t=ae(o);s=s.filter(({finishTime:i})=>t(i))}return s.sort((t,i)=>i.finishTime-t.finishTime).map(t=>({...t,isShowPending:!1}))},[n,o])}function ue(e={},r=null){let o=D(s=>s.status===T.PENDING,r),{dates:n}=e;return(0,P.useMemo)(()=>{let s=U(o,[t=>Z(t.txParams.nonce)]).map((t,i)=>({...t,isShowPending:i===0}));if(n){let t=ae(n);s=s.filter(({sendTime:i})=>t(i))}return s},[o,n])}function Ne(){let e=ue(),r=ce();return(0,P.useMemo)(()=>[...e,...r],[e,r])}function ct(e){let r=Ne();return(0,P.useMemo)(()=>e?r.find(({id:o})=>e===o):null,[e,r])}function ut({tokenAddress:e}){let r=ue(),o=ce();return(0,P.useMemo)(()=>[...r,...o].filter(({type:n,txParams:s,extraParams:t})=>{if(n===l.TRANS_OUT)return!e&&!t?.tokenAddress||_(e)===_(t?.tokenAddress);if(n===l.AUTHORIZATION||n===l.CANCEL_AUTHORIZATION)return _(e)===_(t?.tokenAddress);if(n===l.CONTRACT_CALL){let{value:i}=s||{};return!e&&W(Y(i),0)}return!1}),[r,o,e])}var Ae=(e,r,o)=>{let{protocol:n,host:s,pathname:t,search:i,hash:a}=new URL(e),u=t.endsWith("/")?`${t}${r}/${o}`:`${t}/${r}/${o}`;return new URL(`${n}//${s}${u}${i}${a}`).toString()};function mt(){let{extensionConfig:e}=A("rpc_info");return(0,ie.useMemoizedFn)(r=>e?.explorerUrl?Ae(e?.explorerUrl,"tx",r):null)}export{T as a,l as b,Oe as c,at as d,ce as e,ue as f,Ne as g,ct as h,ut as i,Ae as j,mt as k,Ze as l,Ve as m};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-J5JIFWF4.js.map
