import{f as g,j as X}from"./chunk-LDX3S2CG.js";import{K as B,S as x,V as q,a as E,g as h}from"./chunk-TS5DNQFS.js";import{A as k,E as Q,a as A,y as U,z as G}from"./chunk-656GFN7J.js";import{c as m,d as l,f as z}from"./chunk-R4G6BEPF.js";import{a as v,b as V}from"./chunk-CYOQISC6.js";import{d as I,g as M,h as O}from"./chunk-TKYTZF2K.js";import{b as y}from"./chunk-RY27BWZR.js";import{Kc as J,f as u,i as H,wc as T}from"./chunk-YT2MPR4E.js";import{a as F}from"./chunk-USKTQDCY.js";import{b as w,d as N,f,l as process,m as L,o as S}from"./chunk-GLD6H5Q5.js";function D(t,e){return e===c.LOCALE_TYPE.default?t:`${e}_${t}`}async function a(t,e,r){a.cache||(a.cache={});let n=D(t,e);if(r&&a.cache[n])return a.cache[n];try{let{data:o}=await I(v.i18nConfigUrl(t,e)),s=e===c.LOCALE_TYPE.default?tt(o):o,{local:i}=P.default.storage;return i.set({[n]:s}),a.cache[n]=s,s}catch(o){p.default.error(o)}return{}}async function R(t,e){let{local:r}=P.default.storage,n=D(t,e);return new Promise((o,s)=>{r.get(n).then(i=>{o(i[n])}).catch(i=>{s(i)})})}async function et(t,e=c.LOCALE_TYPE.default){try{let r={};return(process.env.ASSETS_BUILD_TYPE===u.PREPUB||process.env.ASSETS_BUILD_TYPE===u.PUBLISH)&&(r=await R(t,e),r&&Object.keys(r).length>0)?(a(t,e,!0),r):a(t,e,!0)}catch(r){return p.default.error(`failed to fetch ${t} locale because of`,r),{}}}async function rt(t,e=c.LOCALE_TYPE.default){if(process.env.PLATFORM_WEB)return et(t,e);try{let r={};return(process.env.ASSETS_BUILD_TYPE===u.PREPUB||process.env.ASSETS_BUILD_TYPE===u.PUBLISH)&&(r=await R(t,e)),{...await(await fetch(`/${e}/${t}/messages.json`)).json(),...r}}catch(r){return p.default.error(`failed to fetch ${t} locale because of`,r),{}}}async function d(t,e=c.LOCALE_TYPE.default,r=!0){if(process.env.ASSETS_BUILD_TYPE===u.PREPUB||process.env.ASSETS_BUILD_TYPE===u.PUBLISH){let n=await a(t,e,r);if(n)return n}return rt(t,e)}async function pt(t){a(t,c.LOCALE_TYPE.default,!1),a(t,c.LOCALE_TYPE.dex,!1),a(t,c.LOCALE_TYPE.okd,!1)}var p,P,c,tt,$=w(()=>{"use strict";L();S();p=f(A()),P=f(F()),c=f(y());V();H();O();tt=(t={})=>{let e={};return Object.entries(t).forEach(([r,n])=>{e[r]={message:n}}),e}});var ft={};N(ft,{forceUpdateMetamaskState:()=>ct,getChainInfo:()=>nt,getCurrentWindowTab:()=>it,lockMetamask:()=>st,setCurrentLocale:()=>Y,setCurrentWindowTab:()=>K,setLastActiveTime:()=>ut,updateCurrentLocale:()=>W,updateMetamaskState:()=>_,updateMetamaskStateFromBackground:()=>C,updatePartialMetamaskState:()=>ot});function Y(t,e,r,n){return{type:B,value:{locale:t,messages:e,okdMessages:r,dexMessages:n}}}async function nt(){m().getChainFromServer()}function W(t){return async e=>{try{let r=await d(t),n=await d(t,b.LOCALE_TYPE.okd),o=await d(t,b.LOCALE_TYPE.dex);await l().setCurrentLocale(t),e(Y(t,r,n,o)),M(t)}catch(r){e(g(r.message))}}}function _(t){return(e,r)=>{let{metamask:n}=r(),{currentLocale:o}=n,{currentLocale:s}=t;o&&s&&o!==s&&e(W(s)),e({type:E,value:t})}}function ot(t){return e=>{t.chainList&&T(t.chainList),e({type:E,value:t})}}function st(){return j.default.debug("background.setLocked"),t=>at().then(()=>C()).catch(e=>{throw t(g(e.message)),e}).then(e=>{t(_(e)),t({type:h})}).catch(()=>{t({type:h})})}async function ct(t){let e,r;try{e=await l().getStateByDomain(),r=await U()}catch(n){throw t(g(n.message)),n}return t(k(r)),t(_(e)),e}function ut(){return t=>{m().setLastActiveTime(e=>{e&&t(g(e.message))})}}function K(t){return{type:x,value:t}}function it(){return async t=>{let e=await globalThis.platform.currentTab();t(K(e))}}var j,b,C,at,mt=w(()=>{"use strict";L();S();j=f(A());X();b=f(y());J();O();$();z();q();G();Q();C=()=>new Promise((t,e)=>{m().getState((r,n)=>{if(r){e(r);return}t(n)})});at=()=>new Promise((t,e)=>{m().setLocked(r=>{if(r){e(r);return}t()})})});export{rt as a,pt as b,$ as c,nt as d,W as e,_ as f,ot as g,st as h,ct as i,ut as j,it as k,ft as l,mt as m};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-4TYAYDA2.js.map
