import{n as ao}from"./chunk-63F6WMW7.js";import{a as Z}from"./chunk-4AGVCDBO.js";import{a as J}from"./chunk-TC3YAW4K.js";import{a as so}from"./chunk-YKXOTYDR.js";import{a as yt}from"./chunk-RE7CXNX6.js";import{a as eo}from"./chunk-226IQWB4.js";import{b as ro}from"./chunk-PKCAYJL7.js";import{a as no}from"./chunk-D7IU2MQB.js";import{c as Qt,d as E,e as j}from"./chunk-HTCS5UFP.js";import{c as oo,n as dt,o as _t}from"./chunk-P52TMJKP.js";import{a as A}from"./chunk-FCM3KMN7.js";import{f as ut,g as Xt,h as Rt,i as to}from"./chunk-SVCSAZ2J.js";import{a as x,d as b,e as ft,g as V}from"./chunk-R5U3NPEX.js";import{q as _}from"./chunk-UAHUXCQX.js";import{d as io}from"./chunk-UBFVE3Q4.js";import{a as lt}from"./chunk-STMKIE2Z.js";import{a as pt}from"./chunk-F52H34ZH.js";import{a as Jt}from"./chunk-OCCQLMQL.js";import{b as jt}from"./chunk-IRMGOW5H.js";import{a as $t}from"./chunk-CQ64XZTP.js";import{a as Kt}from"./chunk-UXLFUD7T.js";import{a as z}from"./chunk-PAER4Z2U.js";import{a as U}from"./chunk-M2F2X65U.js";import{d as Zt}from"./chunk-ZYEEMVIP.js";import{b as Dt}from"./chunk-AOXUSYRH.js";import{i as qt,p as Ht,q as G}from"./chunk-WKBC6JL3.js";import{X as Lo}from"./chunk-VPDRXROE.js";import{Va as Vt,Z as tt,ga as Ut,la as zt,w as v}from"./chunk-JLIPSIRU.js";import{i as N,m as ct}from"./chunk-4TYAYDA2.js";import{d as vt,f as Go}from"./chunk-R4G6BEPF.js";import{c as w}from"./chunk-RXNDJ7P3.js";import{F as Gt,Kc as Wo,Qb as kt,Ub as Bo,Vb as So,X as Mo,Xb as Lt,Zb as Fo,jc as st,t as Y,v as Et}from"./chunk-YT2MPR4E.js";import{G as At,b as Nt,c as mt}from"./chunk-LDKM7IQF.js";import{e as Wt,pa as Do}from"./chunk-6O63U2D6.js";import{M as q,x as i}from"./chunk-RIOWPXBZ.js";import{T as Yt,c as Ot,ca as S}from"./chunk-OSCGYMLH.js";import{a as P}from"./chunk-O337TVCZ.js";import{f,m as a,n as d,o as s}from"./chunk-GLD6H5Q5.js";a();s();var bt=f(P());Et();a();s();var K=f(P()),po=f(v()),lo=f(So());Do();Et();a();s();var nt=f(P());Fo();var Oo=t=>{let[o,e]=(0,nt.useState)(null),[n,r]=(0,nt.useState)(!1),m=pt();return(0,nt.useEffect)(()=>{if(m?.length){let c=m.find(p=>p.realChainIdHex===t);c?(e(c?.chainId),r(!1)):(e(+Lt(t)),r(!0))}},[m,t]),{chainIndex:o,isRpcChain:n}},gt=Oo;a();s();var it=f(v());Wo();var D=(t,o)=>{let e=(0,it.useSelector)(zt),n=(0,it.useSelector)(jt),r=(0,it.useSelector)(Ut),m=u=>({...u,address:o}),c=(0,it.useSelector)(Vt);if(n[t]?.includes(r)&&e[r]?.account[st]===o)return m(e[r]||{});let p=Jt(t,c);if(n[t]?.includes(p)&&e[p]?.account[st]===o)return m(e[p]);let l=n[t]?.find(u=>e[u]?.account[st]===o);return l?m(e[l]):{}};a();s();var Bt=f(v());ct();a();s();var mo=f(v());Mo();var Yo=t=>{let o=(0,mo.useSelector)(tt),e=$t(),n=(r,m)=>e.find(c=>c.localType===m||Gt(c.chainId,r))||{};return t?n(t):n(o.chainId,o.type)},L=Yo;var Mt=t=>{let o=(0,Bt.useDispatch)(),e=Z(),{walletId:n}=D(t.origin,t.msgParams?.from),r=A(n),m=L(t?.chainId);return async()=>{r({all_confirmation:"cancel",trade:"sign",dapp_url:t.origin,network:m?.chainName});let{id:c}=t;await e({id:c}),await N(o)}},qo=t=>{let o=(0,Bt.useDispatch)(),e=J(),n=Mt(t),{walletId:r}=D(t.origin,t.msgParams?.from),m=ut({walletId:r}),c=A(r),p=L(t?.chainId);return async()=>{let{id:l,msgParams:u,type:I}=t;try{if(c({all_confirmation:"confirm",trade:"sign",dapp_url:t.origin,network:p?.chainName}),!await lt({walletId:r,callback:async()=>{await n(),await N(o)}}))return;let W=await m({msgParams:u,baseChain:t.localType,type:I});await e({id:l,result:W}),await N(o)}catch(y){e({id:l,error:y?.message||"Failed"})}}},Ho=({unapproved:t,preExecInfo:o={}})=>{let e=Mt(t),n={actionType:_.ACTION_TYPE.CANCEL,onClick:Mt(t)},r={actionType:_.ACTION_TYPE.CONFIRM,disabled:o?.canConfirm===!1,onClick:qo(t)};return{buttonGroup:[n,r],handleCancel:e}},co=Ho;var vo=({unapproved:t={}})=>{let[o,e]=(0,K.useState)({}),n=E(t),{buttonGroup:r,handleCancel:m}=co({unapproved:t,preExecInfo:o}),{type:c,msgParams:p,chainId:l}=t,{chainId:u}=(0,po.useSelector)(tt),I=l||u,{from:y}=p,W=(0,K.useMemo)(()=>{let k=t.msgParams?.data,H={[Y.ETH_SIGN](){return[{value:k}]},[Y.PERSONAL_SIGN](){return[{value:(B=>{try{let R=(0,lo.stripHexPrefix)(B),rt=d.Buffer.from(R,"hex"),at=rt.length===32?B:rt.toString("utf8");return/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F\x80-\x9F]/.test(at)?B:at}catch{return B}})(k)}]},[Y.ETH_SIGN_TYPED_DATA](){return k}};return Wt(H[c])?H[c]():[]},[c,t.msgParams?.data]),Q=D(t.origin,y)||{},X=gt(I),M=(0,K.useMemo)(()=>({method:c,dappData:JSON.stringify(p),dappInfo:n,from:y,...X}),[X?.chainIndex]);return K.default.createElement(_t,{txType:dt.signMessage,handleCancel:m,preExecParams:M,walletAccount:Q,buttonGroup:r,onUpdatePreExecInfo:e,slot:{advanced:K.default.createElement(no,{message:W})}})},fo=vo;a();s();var C=f(P()),wo=f(v());q();Bo();a();s();var g=f(P());q();a();s();var St=f(P()),uo=f(v());ct();var Uo=({unapproved:t,walletAccount:o,preExecInfo:e={}})=>{let n=(0,uo.useDispatch)(),{walletId:r}=o,m=A(r),c=L(t.chainId),p=J(),l=Z(),u=ut({walletId:r}),I=(0,St.useCallback)(async()=>{let{id:M}=t;m({trade:"sign",all_confirmation:"cancel",network:c?.chainName,dapp_url:t?.origin}),await l({id:M}),await N(n)},[c?.chainName,l,m,n,t]),y=(0,St.useCallback)(async()=>{let{msgParams:M,id:k,localType:H,type:et}=t;try{if(m({trade:"sign",all_confirmation:"confirm",network:c?.chainName,dapp_url:t?.origin}),!await lt({walletId:r,callback:async()=>{await I()}}))return;let R=await u({msgParams:M,baseChain:H,type:et});await p({id:k,result:R}),await N(n)}catch(B){p({id:k,error:B?.message||"Failed"})}},[t,m,r,n,I,c?.chainName,u,p]),W={actionType:_.ACTION_TYPE.CANCEL,onClick:I},Q={actionType:_.ACTION_TYPE.CONFIRM,type:S.TYPE.highlight,disabled:e?.canConfirm===!1,onClick:y};return{buttonGroup:[W,Q],handleCancel:I}},Ct=Uo;a();s();var xt=f(P());a();s();var wt={root:"_root_szca8_1",icon:"_icon_szca8_5",showValue:"_showValue_szca8_11"};var zo=({icon:t,amount:o,symbol:e})=>xt.default.createElement(w.Box,{className:wt.root},xt.default.createElement(mt,{src:t,className:wt.icon}),xt.default.createElement(G.AdaptiveText,{autoSize:ro,ellipsis:{tooltip:!0},className:wt.showValue},"- ",o," ",e)),_o=zo;a();s();var ht=f(P()),yo=f(Ot()),go=f(Lo());a();s();var It={root:"_root_1wji9_1",price:"_price_1wji9_4",switchIcon:"_switchIcon_1wji9_11"};var Vo=({fromSymbol:t,toSymbol:o,price:e,reversePrice:n})=>{let[r,{toggle:m}]=(0,go.useBoolean)(!1),c=r?o:t,p=r?t:o,l=r?n:e;return ht.default.createElement(w.FlexBox,{className:It.root},ht.default.createElement(G.Text,{size:G.SIZE.sm,ellipsis:{tooltip:!0},className:It.price},"1 ",c," = ",l," ",p),ht.default.createElement(Dt,{size:Dt.SIZE.xs,className:(0,yo.default)("okx-wallet-plugin-switch",It.switchIcon),onClick:m}))},Ft=Vo;var jo={CREATE:"10",REVOCATION:"20"},Jo=({unapproved:t={}})=>{let o=L(t.chainId),{dexExtraData:e}=JSON.parse(t.msgParams.data),n=E(t),r=D(t.origin,t.msgParams?.from),{buttonGroup:m}=Ct({unapproved:t,walletAccount:r}),{expiration:c,order:p,predictPriceFormat:l,reversePredictPrice:u,sellTokenAmountFormat:I,sellTokenImage:y,sellTokenSymbol:W,type:Q}=e,X={icon:y,symbol:W,amount:I},{fromSymbol:M,toSymbol:k,priceFormat:H,reversePrice:et}=p,B=A(r.walletId);return g.default.createElement(w.Container,null,g.default.createElement(z,{title:Q===jo.CREATE?i("swaptrade_limit_title_place_limit_order"):i("swaptrade_limit_title_cancel_limit_order"),closeable:!1,backable:!1}),g.default.createElement(b,null,g.default.createElement(x,{title:i("extension_contract_interaction_maintitle_asset_changes"),tooltip:i("extension_infor_tooltip_asset_changestips")},g.default.createElement(_o,{...X})),g.default.createElement(j,{...n})),g.default.createElement(b,null,g.default.createElement(ft,{title:i("wallet_extension_network_address_title_walletused"),address:r.address,walletId:r.walletId,onCopyCallback:()=>{B({trade:"contract_interaction",all_confirmation:"wallet_used_address"})}})),g.default.createElement(b,{bordered:!1},g.default.createElement(x,{title:i("swaptrade_limit_text_limit_price")},g.default.createElement(Ft,{toSymbol:k,price:H,fromSymbol:M,reversePrice:et})),g.default.createElement(x,{title:i("swaptrade_limit_text_est_execution_price"),tooltip:i("swaptrade_limit_tooltip_estimated_price")},g.default.createElement(Ft,{toSymbol:k,fromSymbol:M,price:l,reversePrice:u})),g.default.createElement(x,{title:i("swaptrade_limit_text_expiry_time")},g.default.createElement(Ht,{size:qt.sm,dateTime:c,format:"yyyyMMddHHmm"})),g.default.createElement(so,{coinId:o?.coinId})),g.default.createElement(U,{placeholder:!0,offsetBottom:0,borderTop:!0},g.default.createElement(_,{buttonGroup:m})))},Co=Jo;a();s();var Tt={crypto:"_crypto_1jaqx_1",image:"_image_1jaqx_7",chainName:"_chainName_1jaqx_12"};var Zo={Permit:"Permit",Permit2:"Permit2"},Ko=({unapproved:t})=>{let[o,e]=(0,C.useState)({}),{chainId:n,msgParams:{version:r,data:m,from:c}}=t,{chainId:p}=(0,wo.useSelector)(tt),u=gt(n||p),I=E(t),y=D(t.origin,c)||{},{buttonGroup:W,handleCancel:Q}=Ct({unapproved:t,preExecInfo:o,walletAccount:y}),X=(0,C.useMemo)(()=>({dappInfo:I,dappData:JSON.stringify(t?.msgParams),from:c,method:`eth_signTypedData_${r.toLowerCase()}`,...u}),[u?.chainIndex]),[M={}]=pt({chainId:u?.chainIndex})||[];if(r==="V4"){let rt={};try{rt=JSON.parse(m)}catch(at){console.log(at)}if(rt.dexExtraData)return C.default.createElement(Co,{unapproved:t})}let{message:k}=JSON.parse(t?.msgParams?.data||"{}"),H=o?.txTypeInfo,B=o?.txExtInfo?.contractList||[],R=Object.values(Zo).includes(H?.strategyType);return C.default.createElement(_t,{txType:dt.signMessage,handleCancel:Q,preExecParams:X,walletAccount:y,buttonGroup:W,onUpdatePreExecInfo:e,slot:{network:R&&M?.chainName?C.default.createElement(x,{title:i("wallet_dapp_conncetion_subtitle_network")},C.default.createElement(w.Box,{className:Tt.crypto},C.default.createElement(mt,{className:Tt.image,src:M.imageUrl||kt,errorImg:kt}),C.default.createElement(G.Text,{ellipsis:{tooltip:!0},className:Tt.chainName},M.chainName))):null,advanced:R?C.default.createElement(C.default.Fragment,null,B?.length?C.default.createElement(oo,{advanced:{contractList:B}},C.default.createElement(yt,{message:k,noPadding:!0})):C.default.createElement(eo,null,C.default.createElement(yt,{message:k,noPadding:!0}))):C.default.createElement(x,{title:i("wallet_dapp_connection_subtitle_data_label")},C.default.createElement(yt,{noPadding:!0,message:k}))}})},xo=Ko;a();s();var F=f(P());q();a();s();var $=f(P());q();var $o=({walletAccount:t,children:o})=>{let[e]=Zt(),{walletAsset:n}=Kt(t.walletId),r=A(t.walletId);return $.default.createElement($.default.Fragment,null,$.default.createElement(b,null,$.default.createElement(ft,{title:i("wallet_extension_network_address_title_walletused"),address:t.address,walletId:t.walletId,onCopyCallback:()=>{r({trade:"contract_interaction",all_confirmation:"wallet_used_address"})}})),$.default.createElement(b,{bordered:!1},$.default.createElement(x,{title:i("wallet_dapp_connection_subtitle_balance")},$.default.createElement(G.DisplayAmount,{ellipsis:!0,size:G.SIZE.sm,mode:G.LEGAL,useApproximate:!1,hidden:e?"***":!1},n)),o))},Pt=$o;a();s();var h=f(P()),Io=f(Ot());q();a();s();var ot={root:"_root_1xv1e_1",msgWrap:"_msgWrap_1xv1e_12",decrypted:"_decrypted_1xv1e_20",copyMsg:"_copyMsg_1xv1e_23",decryptMsg:"_decryptMsg_1xv1e_28"};var Qo=({rawData:t})=>{let o=Qt({showDesc:!1});return h.default.createElement(S,{rect:!0,size:S.SIZE.xxs,type:S.TYPE.primary,category:S.CATEGORY.outline,className:ot.copyMsg,onClick:()=>{o(t)}},h.default.createElement(Yt,{className:"okx-wallet-plugin-copy"}),h.default.createElement(w.Box,null,i("wallet_extension_encrypted_text_copy")))},Xo=({unapproved:t,decryptCb:o})=>{let e=Rt(),n=(0,h.useCallback)(async()=>{let{msgParams:r}=t,m=await e(r);o(m)},[o,e,t]);return h.default.createElement(S,{className:ot.decryptMsg,size:S.SIZE.sm,type:S.TYPE.primary,category:S.CATEGORY.outline,icon:"okds-locked",iconType:S.ICON_POSITION.leading,onClick:n},i("wallet_dapp_conncetion_subtitle_decrypt_metamask_information"))},Ro=({unapproved:t={}})=>{let[o,e]=(0,h.useState)(!1),[n,r]=(0,h.useState)(t.msgParams?.data),[m,c]=(0,h.useState)(!1),p=l=>{l.error?(c(!0),r(i("wallet_dapp_conncetion_errortip_decrypt_error",{errorMessage:l.error}))):r(l.rawData),e(!0)};return h.default.createElement(x,{title:i("wallet_extension_encrypted_text_encrypted_message")},h.default.createElement(w.Box,{className:ot.root},h.default.createElement(w.Box,{className:(0,Io.default)(ot.msgWrap,{[ot.decrypted]:o})},n),o?!m&&h.default.createElement(Qo,{rawData:n}):h.default.createElement(Xo,{unapproved:t,decryptCb:p})))},ho=Ro;a();s();var To=f(v());q();ct();var te=(t,o)=>{let{id:e}=t,n=(0,To.useDispatch)(),r=A(o?.walletId),m=L(),c=Z(),p={actionType:_.ACTION_TYPE.CANCEL,btnText:i("wallet_dapp_connection_btn_reject"),async onClick(){r({all_confirmation:"cancel",trade:"decrypt_message",dapp_url:t.origin,network:m?.chainName}),await c({id:e}),await N(n)}},l=to(),u=J(),I={actionType:_.ACTION_TYPE.CONFIRM,async onClick(){try{r({all_confirmation:"confirm",trade:"decrypt_message",dapp_url:t.origin,network:m?.chainName});let{msgParams:y}=t,W=await l(y);await u({id:e,result:W}),await N(n)}catch(y){console.log(y),u({id:e,error:"Failed"})}}};return[p,I]},Po=te;var oe=({unapproved:t})=>{let o=E(t),e=D(t.origin,t.msgParams?.from),n=E(t),r=Po(t,e),m=(0,F.useMemo)(()=>({type:V.TIP_TYPE.NORMAL,message:i("wallet_dapp_conncetion_notify_decrypt_message",{siteName:n.name||n.host})}),[n]);return F.default.createElement(w.Container,null,F.default.createElement(z,{title:i("wallet_dapp_conncetion_subtitle_decrypt_request"),closeable:!1,backable:!1}),F.default.createElement(b,null,F.default.createElement(j,{...o})),F.default.createElement(Pt,{walletAccount:e},F.default.createElement(ho,{unapproved:t})),F.default.createElement(U,{placeholder:!0,offsetBottom:0,borderTop:!0},F.default.createElement(V,{...m}),F.default.createElement(_,{buttonGroup:r})))},bo=oe;a();s();var O=f(P());q();a();s();var Eo=f(v());q();ct();var ee=(t,o)=>{let{id:e}=t,n=(0,Eo.useDispatch)(),r=A(o?.walletId),m=L(),c=Z(),p={actionType:_.ACTION_TYPE.CANCEL,btnText:i("wallet_dapp_connection_btn_reject"),async onClick(){r({all_confirmation:"cancel",trade:"get_public_key",dapp_url:t?.origin,network:m?.chainName}),await c({id:e}),await N(n)}},l=Xt(),u=J(),I={actionType:_.ACTION_TYPE.CONFIRM,btnText:i("wallet_dapp_conncetion_btn_provide"),async onClick(){try{r({all_confirmation:"confirm",trade:"get_public_key",dapp_url:t?.origin,network:m?.chainName});let y=await l(t.msgParams);u({id:e,result:y}),await N(n)}catch(y){console.log(y),u({id:e,error:"Failed"})}}};return[p,I]},ko=ee;var re=({unapproved:t})=>{let o=D(t.origin,t.msgParams),e=ko(t,o),n=E(t),r=E(t),m=(0,O.useMemo)(()=>({type:V.TIP_TYPE.NORMAL,message:i("wallet_dapp_conncetion_notify_public_key_notice",{siteName:r.name||r.host})}),[r]);return O.default.createElement(w.Container,null,O.default.createElement(z,{title:i("wallet_dapp_conncetion_notify_public_key_request"),closeable:!1,backable:!1}),O.default.createElement(b,null,O.default.createElement(j,{...n})),O.default.createElement(Pt,{walletAccount:o}),O.default.createElement(U,{placeholder:!0,offsetBottom:0,borderTop:!0},O.default.createElement(V,{...m}),O.default.createElement(_,{buttonGroup:e})))},No=re;var ne=t=>{let{msgParams:{version:o},type:e}=t;return e===Y.ETH_GET_ENCRYPTION_PUBLIC_KEY?No:e===Y.ETH_DECRYPT?bo:e===Y.ETH_SIGN_TYPED_DATA&&["V3","V4"].includes(o)?xo:fo},ie=(0,bt.memo)(t=>{let{unapproved:o={}}=t,e=ne(o);return bt.default.createElement(e,{unapproved:o})}),ma=ie;a();s();var T=f(P());q();Et();var ae=({unapproved:t})=>{let[o,{cancel:e,approve:n}]=ao(t),r=E(o),{customNets:m}=io(),c=m.find(l=>l.rpcUrl===o.rpcUrl),p=(0,T.useMemo)(()=>{let l={actionType:_.ACTION_TYPE.CANCEL,onClick:e},u={disabled:!!c,actionType:_.ACTION_TYPE.CONFIRM,btnText:i("developer_mode_add_network_btn_approve"),async onClick(){await n(),At.success({duration:1.5,title:i("developer_mode_home_toast_added"),placement:At.DIRECTION.top})}};return[l,u]},[n,e]);return T.default.createElement(w.Container,null,T.default.createElement(z,{title:i("developer_mode_add_network_maintitle_add_network"),backable:!1,closeable:!1}),T.default.createElement(b,null,T.default.createElement(j,{...r})),T.default.createElement(b,{bordered:!1},T.default.createElement(x,{title:i("developer_mode_add_network_title_network_name"),tooltip:i("wallet_dapp_conncetion_add_network_subtitle_network_name_tips")},o.type||o.chainName),o.switchType===Y.ADD_ETHEREUM_CHAIN&&[T.default.createElement(x,{title:i("developer_mode_add_network_title_networkurl"),tooltip:i("wallet_dapp_conncetion_add_network_subtitle_network_url_tips")},o.rpcUrl),T.default.createElement(x,{title:i("developer_mode_add_network_title_chainid"),tooltip:i("wallet_dapp_conncetion_add_network_subtitle_chain_id_tips")},o.chainIdToDisplay),T.default.createElement(x,{title:i("developer_mode_add_network_title_currency_symbol"),tooltip:i("wallet_dapp_conncetion_add_network_subtitle_currency_symbol_tips")},o.ticker),T.default.createElement(x,{title:i("developer_mode_add_network_title_block_explorerurl"),tooltip:i("wallet_dapp_conncetion_add_network_subtitle_explorer_url_tips")},o.explorers||o.blockExplorerUrl)]),T.default.createElement(U,{placeholder:!0,offsetBottom:0,borderTop:!0},T.default.createElement(V,{type:c?Nt.TYPE.error:Nt.TYPE.warn,message:c?i("developer_mode_infor_errortip_used_network",{network:c.name}):i("developer_mode_add_network_errortip_risk_aware")}),T.default.createElement(_,{buttonGroup:p})))},Ea=ae;a();s();var Ao=f(P());Go();var se=()=>(0,Ao.useCallback)(async(t,o)=>{await vt().handleErc20Token(t,o)},[]),Ma=se;export{Ma as a,D as b,L as c,ma as d,Ea as e};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-W4RN7Y3B.js.map
