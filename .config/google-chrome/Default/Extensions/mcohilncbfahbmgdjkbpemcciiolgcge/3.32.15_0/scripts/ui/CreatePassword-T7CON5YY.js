import{b as Te}from"./chunk-TMW7F7WU.js";import{a as Ce}from"./chunk-FFX72ZTC.js";import{d as be}from"./chunk-3SGF6BWW.js";import{a as U,b as Pe}from"./chunk-PBNN4W46.js";import{a as pe}from"./chunk-L7LFNDLE.js";import{b as ce,c as de,d as ue,e as fe,f as we,g as _e,l as he,m as ge,n as Ee,o as Ie}from"./chunk-M7KSOUDU.js";import"./chunk-CVKIATYP.js";import"./chunk-HFZH6ZWL.js";import{a as ne,b as ie}from"./chunk-D6XWIX4H.js";import"./chunk-SMZ64QW3.js";import"./chunk-DQTTI4XL.js";import{L as le}from"./chunk-FF6KJRSH.js";import{a as me}from"./chunk-GUVHO63M.js";import{l as te,m as re,n as se,o as ae}from"./chunk-7ZRI3S6Z.js";import"./chunk-PAER4Z2U.js";import"./chunk-LBVWUYQX.js";import{a as oe}from"./chunk-M2F2X65U.js";import"./chunk-BOOOUD52.js";import{F as Q,Sa as X,a as L,ga as J}from"./chunk-S5DGV5WL.js";import"./chunk-AOXUSYRH.js";import"./chunk-WKBC6JL3.js";import"./chunk-3EO5SKIF.js";import"./chunk-LMIOM5QK.js";import{X as ze}from"./chunk-VPDRXROE.js";import{A as q,ja as G,w as Y}from"./chunk-JLIPSIRU.js";import"./chunk-CIDV5VJQ.js";import{a as Ve}from"./chunk-VX55KNI4.js";import"./chunk-4TYAYDA2.js";import{i as ee,j as Ze}from"./chunk-LDX3S2CG.js";import"./chunk-TS5DNQFS.js";import{o as z,t as $e}from"./chunk-656GFN7J.js";import"./chunk-VGT27A4M.js";import{d as j,f as Ye}from"./chunk-R4G6BEPF.js";import"./chunk-AYCAVTPT.js";import"./chunk-RXNDJ7P3.js";import"./chunk-CYOQISC6.js";import"./chunk-TKYTZF2K.js";import"./chunk-RY27BWZR.js";import"./chunk-WIWWLEBZ.js";import{Jb as ve,_ as K,ad as Z,db as v,ea as Ke,gb as V,gd as je,l as H,v as He}from"./chunk-YT2MPR4E.js";import"./chunk-R4ZXRZL6.js";import{D as w,H as $,q as y}from"./chunk-LDKM7IQF.js";import{F as x,pa as De}from"./chunk-6O63U2D6.js";import{M as Be,x as n}from"./chunk-RIOWPXBZ.js";import"./chunk-BAWLRI3I.js";import"./chunk-USKTQDCY.js";import"./chunk-B2L2MSSC.js";import"./chunk-OIIWKMG6.js";import{ca as E}from"./chunk-OSCGYMLH.js";import"./chunk-ADWO6K2C.js";import{a as D}from"./chunk-O337TVCZ.js";import"./chunk-BWEIB2OY.js";import"./chunk-2T657SRL.js";import"./chunk-QJAZEJHH.js";import"./chunk-LCKQ7YKT.js";import"./chunk-ZVYHIM2Y.js";import"./chunk-VBARKITZ.js";import"./chunk-NCANHNXF.js";import{f as _,m as h,o as g}from"./chunk-GLD6H5Q5.js";h();g();var t=_(D()),k=_(Y()),O=_(ze());De();Be();Ye();Ke();h();g();var I=_(D()),N=_(Y()),Ae=_(Ve());Ze();function Se(){let c=(0,N.useDispatch)(),i=(0,Ae.useHistory)(),f=(0,N.useSelector)(G),[d,A]=(0,I.useState)(!1);return(0,I.useEffect)(()=>{f&&!d&&(c(ee(!1)),i.push(L))},[f,d,i,c]),(0,I.useCallback)(()=>{A(!0)},[])}h();g();var Re=c=>{let{onboardingTabs:i}=c.metamask;if(!i||Object.keys(i).length!==1)return null;let f=Object.keys(i)[0],d=i[f];return{location:f,tabId:d}};He();je();$e();ve();var p={SEED:"seed",KEY:"key",HARDWARE:"hardware",CREATE:"create",MPC:"mpc",BULK:"bulk"},No=({history:c})=>{let i=pe(),f=w.useForm(),[d,{set:A}]=(0,O.useBoolean)(!1),[m,Le]=(0,t.useState)({}),r=(0,k.useDispatch)(),{seedPhrase:P,privateKey:b,mpcInfo:Ne,unlockHardwareWallets:S,chooseNetworkList:M,chainList:ke,isTonMnemonic:Oe}=(0,k.useSelector)(e=>({seedPhrase:ce(e),privateKey:de(e),mpcInfo:fe(e),unlockHardwareWallets:ue(e),chooseNetworkList:we(e),onboardingInitiator:Re(e),chainList:q(e),isTonMnemonic:_e(e)})),Me=Se(),B=i.get("from"),Fe=B===p.HARDWARE,R=B===p.BULK,{setValue:We}=be(),C=async(e,l)=>{try{r(Te(!0)).then(async()=>{if(Me(),await r(me()),e===p.CREATE){c.push({pathname:J,search:`?type=${Z.INITIALIZE}`});return}let s=`${Q}/${e}`,{keyringName:a="",walletName:o=""}=l||{},u=`${a}-${o}`;if(e===p.HARDWARE&&K()===H){globalThis.platform.openExtensionInPopup(`${s}?anim=1`);return}c.push({pathname:s,state:{walletName:u,anim:"1",next:L}})}).catch(console.log)}catch(s){console.error(s.message)}},F=t.default.useMemo(()=>{let{password:e,confirmPassword:l}=m;return!(e?.length>=ne&&e===l)},[d,b,P,S,m]),xe=(0,O.useMemoizedFn)(async()=>{if(!(d||F)){A(!0),le();try{if(P){let o=await r(re(m.password,P?.trim().toLowerCase().match(/\w+/gu)?.join(" ")||"",{isTonMnemonic:Oe}));C(p.SEED,o),r(he())}if(b){let o=await r(se(m.password,M,b));C(p.KEY,o,M),r(ge())}if(R){We(m.password),c.push(X);return}let{cipherText:e,privateKey:l,mpcId:s,userInfo:a}=Ne;if(e&&l&&s){let o=await r(ae(m.password,{cipherText:e,privateKey:l},{mpcId:s,userInfo:a},!0)),u=ke.filter(W=>W.factionType===v).map(W=>W.baseChain),T=[...V,...u];C(p.MPC,o,T),r(Ie())}if(!x(S)){await j().setPassword(m.password);let o=await r(Ce(S)),{hdPathMap:u}=o,T=Object.keys(u);C(p.HARDWARE,o,T),r(Ee())}if(!P&&!b&&!(e&&l&&s)&&x(S)){let o=await r(te(m.password));C(p.CREATE,o)}}catch(e){e.message===z&&$.error(n("wallet_home_toast_network_error"))}finally{A(!1)}}},[F,m,P,b,M]);(0,t.useEffect)(()=>{if(R){let e=document.querySelector("#app");e&&(e.classList.remove("fullscreen"),e.classList.add("popup"))}return()=>{if(R){let e=document.querySelector("#app");e&&(e.classList.remove("popup"),e.classList.add("fullscreen"))}}},[]);let Ue=R?{position:"absolute",bottom:0,left:0}:{};return t.default.createElement(Pe,{title:n("wallet_signup_maintitle_set_password"),desc:n(Fe?"wallet_extension_signup_subtitle_set_password_hardware":"wallet_extension_subtitle_password_unlock")},({formClass:e,formErrorClass:l,itemClass:s})=>t.default.createElement(w,{form:f,size:E.SIZE.lg,onSubmit:xe,validateTrigger:["onChange"],className:e,errorClassName:l,onValuesChange:(a,o)=>{Le(o)}},t.default.createElement(w.Item,{name:"password",style:{marginBottom:0},className:s,label:n("wallet_set_password_subtitle_password")},t.default.createElement(y.Password,{autoFocus:!0,autoComplete:"off",inputClassName:U.passwordInput,size:y.SIZE.xl,placeholder:n("wallet_settings_reset_passord_placeholder_input_desc")})),t.default.createElement(w.Item,{noStyle:!0,shouldUpdate:(a,o)=>a.password!==o.password},({getFieldValue:a})=>{let o=a("password");return t.default.createElement(ie,{password:o})}),t.default.createElement(w.Item,{name:"confirmPassword",style:{flex:1,marginTop:"32px"},dependencies:["password"],className:s,rules:[({getFieldValue:a})=>({validator:(o,u)=>{let T=a("password");return u&&T!==u?Promise.reject(n("wallet_set_password_errortip_password_not_match")):Promise.resolve()}})],label:n("wallet_set_password_subtitle_confirm_password")},t.default.createElement(y.Password,{autoComplete:"off",inputClassName:U.passwordInput,size:y.SIZE.xl,placeholder:n("wallet_settings_reset_passord_placeholder_input_desc")})),t.default.createElement(oe.FooterActions,{affixStyle:Ue},t.default.createElement(w.Item,{noStyle:!0},t.default.createElement(E,{block:!0,htmlType:"submit",disabled:F,size:E.SIZE.lg,type:E.TYPE.highlight,loading:d,category:E.CATEGORY.fill},n("wallet_set_password_btn_confirm"))))))};export{No as default};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=CreatePassword-T7CON5YY.js.map
