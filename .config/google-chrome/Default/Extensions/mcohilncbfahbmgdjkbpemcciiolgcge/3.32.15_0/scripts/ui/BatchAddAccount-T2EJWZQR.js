import{a as f,b as kt}from"./chunk-FQ4FGGZV.js";import{a as It}from"./chunk-BAISQ3N2.js";import"./chunk-O2YW3UOK.js";import{a as wt}from"./chunk-BUZ3YKBY.js";import{a as At,b as et}from"./chunk-OMKIB2BU.js";import{a as gt}from"./chunk-FI4N3Q67.js";import"./chunk-X73WRWZ5.js";import{a as Y}from"./chunk-CWEAF2VW.js";import"./chunk-MF4732CU.js";import{c as V}from"./chunk-NL5HLEQU.js";import{a as Nt,b as ht,c as Bt,d as bt}from"./chunk-Z2O34Z77.js";import"./chunk-HFZH6ZWL.js";import{H as xt}from"./chunk-FF6KJRSH.js";import{a as ot}from"./chunk-OFKAKQXT.js";import"./chunk-KA5XDNKC.js";import"./chunk-LBVWUYQX.js";import{a as G}from"./chunk-M2F2X65U.js";import{La as H,Ma as W}from"./chunk-S5DGV5WL.js";import"./chunk-3EO5SKIF.js";import{X as Rt}from"./chunk-VPDRXROE.js";import{w as mt}from"./chunk-JLIPSIRU.js";import{a as ut}from"./chunk-VX55KNI4.js";import{i as yt,m as oo}from"./chunk-4TYAYDA2.js";import{f as pt,j as to}from"./chunk-LDX3S2CG.js";import"./chunk-TS5DNQFS.js";import"./chunk-656GFN7J.js";import"./chunk-VGT27A4M.js";import{d as K,f as ft}from"./chunk-R4G6BEPF.js";import"./chunk-OG46YTNN.js";import{c}from"./chunk-RXNDJ7P3.js";import"./chunk-YM7II27E.js";import"./chunk-CYOQISC6.js";import"./chunk-TKYTZF2K.js";import"./chunk-RY27BWZR.js";import"./chunk-WIWWLEBZ.js";import{Tc as _t,Y as at,Z as Xt,gd as $t,q as st,r as it,v as Qt}from"./chunk-YT2MPR4E.js";import"./chunk-R4ZXRZL6.js";import{D as C,q as lt,w as dt}from"./chunk-LDKM7IQF.js";import"./chunk-6O63U2D6.js";import{M as T,l as k,x as d}from"./chunk-RIOWPXBZ.js";import"./chunk-BAWLRI3I.js";import"./chunk-USKTQDCY.js";import"./chunk-B2L2MSSC.js";import"./chunk-OIIWKMG6.js";import{c as ct,ca as x}from"./chunk-OSCGYMLH.js";import"./chunk-ADWO6K2C.js";import{a as g}from"./chunk-O337TVCZ.js";import"./chunk-2T657SRL.js";import"./chunk-QJAZEJHH.js";import"./chunk-LCKQ7YKT.js";import"./chunk-ZVYHIM2Y.js";import"./chunk-VBARKITZ.js";import"./chunk-NCANHNXF.js";import{f as p,m as t,o}from"./chunk-GLD6H5Q5.js";t();o();var R=p(g()),U=p(ut());t();o();var M=p(g());t();o();var Z=p(g());t();o();var rt={root:"_root_dowdc_1",header:"_header_dowdc_30"};t();o();t();o();var Lt=p(g());t();o();var v=ot(ht,bt),j=ot(Nt,Bt);t();o();var Et=p(ut());function eo(){let e=(0,Et.useHistory)(),r=s=>(y=!0)=>{y?e.replace(s):e.push(s)},n=s=>e.location.pathname===s,i=r(W),m=r(H),u=n(H),a=n(W);return{isHomePage:u,isAddPage:a,gotoAddPage:i,gotoHomePage:m}}var z=eo;function ro(){let[e]=v(),{gotoHomePage:r,isHomePage:n}=z();(0,Lt.useLayoutEffect)(()=>{!n&&!e&&r()},[r,n,e])}var Ft=ro;function no(){return Ft(),null}var St=no;function so({children:e,hidden:r=!1}){return Z.default.createElement(c.Box,{className:rt.root},Z.default.createElement(wt,{className:rt.header}),r?null:e,Z.default.createElement(St,null))}var q=so;t();o();var J=p(g());T();t();o();var O={root:"_root_5jwcg_1",titleBox:"_titleBox_5jwcg_17",title:"_title_5jwcg_17",subtitle:"_subtitle_5jwcg_112",add:"_add_5jwcg_131"};function io(){let e=d("wallet_extension_addaccount_title_add_account"),r=d("wallet_extension_addaccount_subtitle_select_account");return J.default.createElement(c.Box,{className:O.titleBox},J.default.createElement(c.Box,{className:O.title},e),J.default.createElement(c.Box,{className:O.subtitle},r))}var Tt=io;t();o();var _=p(g());T();t();o();var E={root:"_root_1umy7_2",confirm:"_confirm_1umy7_41",max:"_max_1umy7_55",label:"_label_1umy7_67",name:"_name_1umy7_73",nums:"_nums_1umy7_80",option:"_option_1umy7_86",icon:"_icon_1umy7_105"};t();o();var Ct=p(g());T();$t();var ao=e=>e.filter(r=>[_t.MNEMONIC].includes(r.keyringIdentityType)).filter(r=>r.walletIdentities.every(n=>!n.needBackup)),nt=1;function mo(){let e=C.useForm(),{gotoAddPage:r}=z(),{keyringIdentities:n,remainAccountAmount:i}=Y(),[,m]=j(),[,u]=v(),a=h=>{if(Object.keys(e.getErrors()).length>0)return;let{keyringId:S,amount:B}=h;if(B==="0")return;let tt=Number(B||nt);!S||tt>i||(m(tt),u(S),r())},s=(0,Ct.useMemo)(()=>ao(n).map(h=>({value:h.keyringId,label:h.keyringName,len:h.walletIdentities.length})),[n]),y={keyringId:s[0]?.value,amount:""},N=(h,F=nt)=>{if(Number(F||nt)<=i&&i>0)return Promise.resolve();let B=d("wallet_extension_addaccount_remainder_added_upper_limits",{num:k.thousandFormat(i)});return Promise.reject(B)},A=()=>{e.setFieldsValue({amount:i})},b=i<=0||s.length<=0;return{initialValues:y,onSubmit:a,form:e,options:s,amountValidator:N,onSetMaxAmount:A,disableAdd:b}}var Dt=mo;function uo(){let{initialValues:e,onSubmit:r,form:n,options:i,amountValidator:m,onSetMaxAmount:u,disableAdd:a}=Dt(),{isSm:s}=V(),y=s?G.FooterActions:_.default.Fragment,N=A=>_.default.createElement(_.default.Fragment,null,_.default.createElement("div",{className:E.name},A.label),_.default.createElement("div",{className:E.nums},d("wallet_extension_batch_modify_account_desc",{num:k.thousandFormat(A.len)})));return _.default.createElement(c.Box,{className:E.root},_.default.createElement(C,{requiredMark:!0,initialValues:e,onSubmit:r,form:n},_.default.createElement(C.Item,{label:d("wallet_extension_addaccount_title_select_wallet"),name:"keyringId"},_.default.createElement(dt,{title:d("wallet_extension_addaccount_title_select_wallet"),options:i,searchable:!1,showSelectedIcon:!0,label:A=>_.default.createElement("div",{className:E.label},N(A)),renderOption:({option:A,activeIcon:b})=>_.default.createElement("div",{className:E.option},_.default.createElement("div",null,N(A)),_.default.createElement("div",{className:E.icon},b))})),_.default.createElement(C.Item,{label:d("wallet_extension_addaccount_text_added_amount"),name:"amount",rules:[{validator:m}]},_.default.createElement(lt.Number,{placeholder:"1",precision:0,min:1,suffix:_.default.createElement(c.Box,{className:E.max,onClick:u},d("wallet_extension_addaccount_textbtn_max"))})),_.default.createElement(y,null,_.default.createElement(C.Item,{noStyle:!0,className:!s&&E.confirm},_.default.createElement(x,{category:x.CATEGORY.fill,type:x.TYPE.highlight,size:x.SIZE.xl,disabled:a,htmlType:"submit",block:!0},d("wallet_extension_addaccount_btn_add"))))))}var vt=uo;function co(){return M.default.createElement(q,null,M.default.createElement(c.Box,{className:O.root},M.default.createElement(Tt,null),M.default.createElement(vt,null)))}var Ot=co;t();o();var D=p(g());t();o();var Pt={root:"_root_1uqqr_1"};t();o();var w=p(g()),Mt=p(mt()),Ut=p(Rt());t();o();ft();var Ht=p(mt());oo();to();var lo=()=>{let e=(0,Ht.useDispatch)();return async(n,i=1)=>{try{return await K().addNewWallets(n,i)}catch(m){throw e(pt(m?.message)),m}finally{await yt(e)}}},Wt=lo;ft();var fo=e=>{let{newAccountsSuccessCount:r,newAccountsFailedCount:n}=e.metamask;return{newAccountsSuccessCount:r,newAccountsFailedCount:n}},_o=e=>{let[r,n]=(0,w.useState)(f.NONE),{newAccountsSuccessCount:i,newAccountsFailedCount:m}=(0,Mt.useSelector)(fo),u=et(),a=(0,w.useRef)(),[s]=j(),[y,N]=(0,w.useState)(0),[A,b]=(0,w.useState)(0),h=Wt(),F=s-y,S=P=>P>0;(0,w.useEffect)(()=>{s<=0||(y===s&&n(f.FINISHED),A===s&&n(f.FAILED))},[A,y,s]);let B=async()=>{if(!(y>0)&&!!S(s)){n(f.ADDING);try{let P=await h(e,s);N(P),b(s-P)}catch{b(s)}finally{n(f.FINISHED)}}};return{start:B,cancel:()=>{n(f.FINISHED),a.current?.cancel()},retry:()=>{F>0&&(b(0),B(F))},failed:u?A+m:A,success:u?y+i:y,total:s,remain:F,status:r}},po=e=>{let{keyringIdentities:r,remainAccountAmount:n}=Y(),i=r.find(u=>u.keyringId===e),m=i?.walletIdentities?.[0]?.walletId;return{keyring:i,walletId:m,remainAccountAmount:n}};function yo(){let[e]=v(),r=et(),n=(0,Ut.useLatest)(r),{walletId:i,keyring:m,remainAccountAmount:u}=po(e),a=(0,w.useRef)(!1),{start:s,cancel:y,retry:N,success:A,failed:b,total:h,status:F}=_o(i),S=It();return(0,w.useEffect)(()=>{!a.current&&i&&u>0&&(s(),a.current=!0)},[i,u,s]),(0,w.useEffect)(()=>{let B=async()=>{n.current===!0&&K().stopBatchAddNewWallets()};return window.addEventListener("beforeunload",B),()=>{window.removeEventListener("beforeunload",B)}},[]),{start:s,cancel:y,retry:N,success:A,failed:b,total:h,keyring:m,status:F,onFinish:S}}var Kt=yo;t();o();var Vt=p(g()),Yt=p(ct());T();t();o();var Gt={root:"_root_x2b1d_1"};var xo=({status:e,className:r,walletName:n})=>{let m={[f.NONE]:null,[f.ADDING]:{key:"wallet_extension_addaccount_remainder_account_creating",params:{acctName:n}},[f.FINISHED]:{key:"wallet_extension_addaccount_remainder_account_created"},[f.FAILED]:{key:"wallet_extension_addaccount_adding_maintitle_create_failed"}}[e],u=m?d(m.key,m.params):"";return Vt.default.createElement(c.Box,{className:(0,Yt.default)(Gt.root,r)},u)},jt=xo;t();o();var X=p(g());T();t();o();var Q={root:"_root_1n2pz_1",item:"_item_1n2pz_75",retry:"_retry_1n2pz_98"};t();o();T();var Ao=({status:e,success:r=0,total:n=0,failed:i=0})=>{let u=f.FINISHED===e?n-r:i,a={success:{key:"wallet_extension_addaccount_adding_text_create_success",params:{num:k.thousandFormat(r)}},failed:{key:"wallet_extension_addaccount_adding_text_create_failed",params:{num:k.thousandFormat(u)},withRetry:u>0},adding:{key:"wallet_extension_addaccount_remainder_created_account",params:{successnum:k.thousandFormat(r),totalnum:k.thousandFormat(n)}}};return{items:{[f.NONE]:[],[f.ADDING]:[a.adding],[f.FINISHED]:[a.success,u>0?a.failed:void 0].filter(Boolean),[f.FAILED]:[a.failed]}[e]}},zt=Ao;function go(e){let{items:r=[]}=zt(e),{retry:n}=e;return X.default.createElement(c.Box,{className:Q.root},r.map((i,m)=>{let{key:u,params:a,withRetry:s}=i;return X.default.createElement(c.Box,{key:m,className:Q.item},d(u,a),s&&X.default.createElement(c.Box,{onClick:n,className:Q.retry},d("wallet_extension_addaccount_adding_textbtn_retry")))}))}var Zt=go;t();o();var I=p(g()),$=p(ct());T();Xt();Qt();t();o();var L={root:"_root_1gfwy_1",actions:"_actions_1gfwy_21",adding:"_adding_1gfwy_38",finish:"_finish_1gfwy_52",tip:"_tip_1gfwy_88",hiddenTip:"_hiddenTip_1gfwy_154",mobileFinishActions:"_mobileFinishActions_1gfwy_162"};function wo(e){let{isSm:r}=V(),{status:n,cancel:i,download:m,finish:u}=e,a=n===f.ADDING,s=at(),y=r?G:c.Box,N=r&&!a?{offsetBottom:0,className:(0,$.default)(L.actions,L.mobileFinishActions)}:{};return I.default.createElement(c.Box,{className:L.root},I.default.createElement(y,{className:(0,$.default)(L.actions,a?L.adding:L.finish),...N},a?I.default.createElement(I.default.Fragment,null,I.default.createElement(x,{category:x.CATEGORY.outline,type:x.TYPE.primary,onClick:i,size:x.SIZE.xl,block:!0},d("wallet_extension_addaccount_adding_btn_cancel"))):I.default.createElement(I.default.Fragment,null,s!==st&&s!==it&&I.default.createElement(x,{category:x.CATEGORY.outline,type:x.TYPE.primary,size:x.SIZE.xl,onClick:At(xt)(m),block:r},d("wallet_extension_addaccount_adding_btn_download_address")),I.default.createElement(x,{category:x.CATEGORY.fill,type:x.TYPE.highlight,size:x.SIZE.xl,onClick:u,block:r},d("wallet_extension_addaccount_adding_btn_confirm")))),I.default.createElement(c.Box,{className:(0,$.default)(L.tip,!a&&L.hiddenTip)},a?d("wallet_extension_addaccount_adding_text_not_close"):""))}var qt=wo;function Io(){let{cancel:e,retry:r,success:n,failed:i,total:m,keyring:u,status:a,onFinish:s}=Kt(),{downloadAddress:y}=gt();return D.default.createElement(q,{hidden:a===f.NONE},D.default.createElement(c.Box,{className:Pt.root},D.default.createElement(kt,{status:a}),D.default.createElement(jt,{status:a,walletName:u?.keyringName}),D.default.createElement(Zt,{status:a,retry:r,total:m,failed:i,success:n}),D.default.createElement(qt,{status:a,cancel:e,download:y,finish:s})))}var Jt=Io;var bn=()=>R.default.createElement(U.Switch,null,R.default.createElement(U.Route,{path:H,component:Ot,exact:!0}),R.default.createElement(U.Route,{path:W,component:Jt,exact:!0}));export{bn as default};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=BatchAddAccount-T2EJWZQR.js.map
