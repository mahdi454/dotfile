import{q as S}from"./chunk-UAHUXCQX.js";import{e as F}from"./chunk-PGKED42N.js";import{a as oe}from"./chunk-SMZ64QW3.js";import{aa as j,ba as z,e as D,g as G,h as W,i as H,k as U,l as K,m as Z,n as R,o as Y,p as se}from"./chunk-FF6KJRSH.js";import{q as k}from"./chunk-WKBC6JL3.js";import{b as g,ca as O,fa as N,ta as pe}from"./chunk-VGT27A4M.js";import{c as f}from"./chunk-RXNDJ7P3.js";import{F as te,a as y,f as h,pa as V}from"./chunk-6O63U2D6.js";import{M as ee,l as T,x as s}from"./chunk-RIOWPXBZ.js";import{T as ne,c as me,ca as B}from"./chunk-OSCGYMLH.js";import{a as $}from"./chunk-O337TVCZ.js";import{f as L,m as p,o as x}from"./chunk-GLD6H5Q5.js";p();x();V();ee();pe();var w={NATIVE:132,TOKEN:99,NFT:66,OTHERS:33},A={add:"+",sub:"-"},xe="306001",fe=e=>{let{approveList:t=[],assetChange:n=[]}=e||{};if(t.length){let o=t[0];if([g.AUTHORIZATION,g.CANCEL_AUTHORIZATION,g.INCREASE_ALLOWANCE,g.DECREASE_ALLOWANCE,g.COMMON_APPROVE,g.NFT_AUTHORIZATION,g.NFT_CANCEL_AUTHORIZATION].includes(o?.approvalType))return o.approvalType}return n.length?g.TRANS_OUT:""},re=(e,t)=>{let n=e.filter(({operator:r})=>r===A.sub),o=e.filter(({operator:r})=>r===A.add),a=(r,c)=>{let l=r[t],i=c[t],m=r.asset?.decimals,E=c.asset?.decimals;return m&&E&&(l=T.div(l,T.pow(10,m)),i=T.div(i,T.pow(10,E))),T.sub(i,l)};return n.sort(a),o.sort(a),[...n,...o]},ge=(e,t)=>{let n=e.assetsDiffs?.[t]||{},o=e.exposures?.[t]||[],a=e.permissions?.[t]||[],r=e.permissionMsg||"",c=e.intention||{},l=e.blackAddressWarning||{},i=e.causeRiskItem||[];return{assetsDiff:n,exposure:o,permission:a,permissionMsg:r,intention:c,blackAddress:l,causeRiskItem:i}},Te=e=>{let t=[];return y(e)&&e.forEach(n=>{let{asset:o}=n||{};if(n?.diff){let a=T.gt(n.diff,0);t.push({asset:o,usdValue:n.diffUsdValue,operator:a?A.add:A.sub,rawValue:a?n.diff:n.diff?.slice(1)})}else n?.out?.forEach(a=>{t.push({asset:o,operator:A.sub,...a})}),n?.in?.forEach(a=>{t.push({asset:o,operator:A.add,...a})})}),t},we=(e,t)=>{if(!e||te(e))return{};let{assetsDiff:n,exposure:o,permission:a,permissionMsg:r,intention:c,blackAddress:l,causeRiskItem:i}=ge(e,t),m=[];if(y(o)){let u=o[0]||{},{asset:b={},spenders:M={}}=u;Object.entries(M).forEach(([ue,de])=>{m.push({asset:b,address:ue,...de})})}let E=Te(n),C={};[w.NATIVE,w.TOKEN,w.OTHERS].forEach(u=>{let b=E.filter(M=>M?.asset?.assetType===u);C[u]=re(b,"rawValue")});let X=E.filter(u=>u?.asset?.assetType===w.NFT),q=re(X,"tokenNum"),Q=[...C[w.NATIVE],...C[w.TOKEN],...q,...C[w.OTHERS]];return{intention:c,permission:a,permissionMsg:r,assetChange:Q,approveList:m,blackAddress:l,causeRiskItem:i}},ae=e=>e&&e?.result===!1,ie=e=>e&&(e?.resultCode===xe||e?.addFundsFlag),Ee=e=>ae(e)&&!ie(e),Oe=(e,t,n={})=>{let{from:o,preExecuteFailed:a=!1}=n||{},r={};return t?.forEach(c=>{let l=e?.find(i=>i?.checkType===c)||{};if(c===O.SAFE_ADDRESS){let i=Boolean(l?.blackAddress),m=l?.isSimilar||N.FAILED;r[c]={...l,isDefraud:i,similarType:m,isSimilar:[N.EXACT,N.ROUGH].includes(m)}}else if(c===O.CONTRACT_ADDRESS)r[c]={...l,isContract:typeof l?.result=="boolean"&&!l?.result};else if(c===O.KYS){let i=we(l,o);r[c]={...i,txType:fe(i)}}else if(c===O.VERIFY_GAS_LIMIT){let i={...l};a&&(i.result=!1),r[c]={...i,isPreExecuteFailed:ae(i),isPreExecuteGasError:ie(i),isPreExecuteNonGasError:Ee(i)}}else r[c]=l}),r};p();x();var P=L($());V();ee();p();x();var le={extLink:"_extLink_f58rv_1"};var I=({link:e,monitorEvt:t=h})=>{let n=()=>{t({is_click_risk_link:!0}),globalThis.platform.openTab({url:e?.scamsUrl})};return P.default.createElement("span",{className:le.extLink,onClick:n},s("wallet_extension_function_link_case"))},ke=()=>{let e=oe(),t=(u,b)=>({title:s("wallet_extension_header_title_transaction_risk"),desc:s(u,{case:P.default.createElement(I,{link:e,monitorEvt:b})}),mainBtnText:s("wallet_extension_function_btn_cancel"),subBtnText:s("wallet_extension_function_btn_advanced")}),n=(u="")=>({screenOne:{title:s("wallet_extension_function_title_approve_to_eoa"),desc:s("wallet_extension_function_desc_approve_to_eoa",{address:F(u),link:P.default.createElement(I,{link:e,monitorEvt:D})}),mainBtnText:s("wallet_extension_function_btn_cancel"),subBtnText:s("wallet_extension_function_btn_advanced")},screenTwo:{title:s("wallet_extension_function_title_approve_to_eoa"),desc:s("wallet_extension_function_desc_developer_continue"),mainBtnText:s("wallet_extension_mid_dialog_btn_cancel"),subBtnText:s("wallet_extension_function_btn_continue_transaction")},monitorEvt:D}),o=()=>({screenOne:t("wallet_extension_mid_desc_transaction_account_risk",H),screenTwo:{title:s("wallet_extension_header_title_transaction_risk"),desc:s("wallet_extension_mid_desc_continue_transaction"),mainBtnText:s("wallet_extension_mid_dialog_btn_cancel"),subBtnText:s("wallet_extension_mid_btn_continue_transaction")},monitorEvt:H}),a=()=>({screenOne:t("wallet_extension_mid_desc_transaction_account_risk",W),monitorEvt:W}),r={title:s("wallet_extension_header_title_transaction_risk"),desc:s("wallet_extension_function_desc_developer_continue"),mainBtnText:s("wallet_extension_mid_dialog_btn_cancel"),subBtnText:s("wallet_extension_function_btn_continue_transaction")};return{getEoaModalParams:n,getEthSignModalParams:()=>({screenOne:t("wallet_extension_sign_card_desc_risky_blocked",G),monitorEvt:G}),getLowerValueModalParams:()=>({screenOne:t("wallet_extension_sign_card_desc_risky_unusual",j),screenTwo:r,monitorEvt:j}),getSolPermissionsModalParams:a,getTronPermissionsModalParams:o,getBlackAddressWarnModalParams:(u="")=>({screenOne:{title:s("wallet_extension_header_title_transaction_risk"),desc:u,mainBtnText:s("wallet_extension_function_btn_cancel"),subBtnText:s("wallet_extension_function_btn_advanced")},screenTwo:r,monitorEvt:se}),getStrongBlackAddressModalParams:(u="")=>({screenOne:{title:s("wallet_extension_header_title_transaction_risk"),desc:s("wallet_extension_address_card_desc_risky_blocked",{address:F(u),case:P.default.createElement(I,{link:e,monitorEvt:Y})}),mainBtnText:s("wallet_extension_function_btn_cancel"),subBtnText:s("wallet_extension_function_btn_advanced")},monitorEvt:Y}),getSuspicionWithdrawAddressModalParams:()=>({screenOne:t("wallet_extension_mid_desc_transaction_address_risk",z),screenTwo:r,monitorEvt:z}),getNotSameParamsModalParams:()=>({screenOne:t("wallet_extension_warning_tampered_blocking",U),monitorEvt:U}),getRiskRejectParamsModalParams:()=>({screenOne:t("wallet_extension_warning_risky_blocking",Z),monitorEvt:Z}),getRiskAlertParamsModalParams:()=>({screenOne:t("wallet_extension_warning_risky_doublecheck",K),screenTwo:r,monitorEvt:K}),getMaliciousTokenModalParams:()=>({screenOne:t("wallet_extension_warning_risky_doublecheck_token",R),monitorEvt:R}),getConnectRiskModalParams:u=>({screenOne:{title:s("wallet_extension_tg_risk_alert_title_link"),desc:s("wallet_extension_tg_risk_alert_desc_link",{host:u,case:P.default.createElement(I,{link:e})}),mainBtnText:s("wallet_extension_tg_risk_alert_btn_link")}})}},Ze=ke;p();x();var _=L($()),J=L(me());V();p();x();var d={main:"_main_1fewt_1",box:"_box_1fewt_6",isPureScreen:"_isPureScreen_1fewt_12",tipImg:"_tipImg_1fewt_15",tipImgIcon:"_tipImgIcon_1fewt_24",title:"_title_1fewt_28",decs:"_decs_1fewt_36",extLink:"_extLink_1fewt_42",footerWrap:"_footerWrap_1fewt_46",screenOneButtons:"_screenOneButtons_1fewt_49",extButton:"_extButton_1fewt_53"};var ce=e=>{let{children:t,desc:n,title:o,isPureScreen:a}=e;return _.default.createElement(f.FlexBox,{className:d.main,direction:f.DIRECTION.vertical},_.default.createElement(f.Box,{className:(0,J.default)(d.box,{[d.isPureScreen]:a})},_.default.createElement(f.Box,{className:d.tipImg},_.default.createElement(ne,{className:(0,J.default)("okx-wallet-plugin-risk-trading",d.tipImgIcon)})),_.default.createElement(k.Text,{className:d.title,align:k.ALIGN.center},o),_.default.createElement(k.Text,{className:d.decs,size:k.SIZE.sm,align:k.ALIGN.center},n)),_.default.createElement(f.Box,{className:d.footerWrap},t))},Ae=({modalParams:e,handleCancel:t,handleNext:n})=>{let{screenOne:o,screenTwo:a,monitorEvt:r=h}=e,[c,l]=(0,_.useState)(!1),i=async()=>{r({is_click_cancel_link:!0}),l(!0),await t(),l(!1)},m=async()=>{r({is_click_advanced_link:!0}),n()};return _.default.createElement(ce,{desc:o.desc,title:o.title},_.default.createElement(f.Box,{className:d.screenOneButtons},_.default.createElement(B,{block:!0,loading:c,size:B.SIZE.lg,onClick:i,type:B.TYPE.highlight,category:B.CATEGORY.fill},o.mainBtnText),a?_.default.createElement(f.Box,{className:d.extButton,onClick:m},o.subBtnText):null))},Pe=({handleCancel:e,handleNext:t,modalParams:n})=>{let{screenTwo:o={},monitorEvt:a=h}=n,r=[{actionType:S.ACTION_TYPE.CANCEL,btnText:o.subBtnText,onClick:()=>{a({is_click_advanced_continue_link:!0}),t()}},{actionType:S.ACTION_TYPE.CONFIRM,btnText:o.mainBtnText,onClick:()=>{a({is_click_advanced_cancel_link:!0}),e()}}];return _.default.createElement(ce,{isPureScreen:!0,desc:o.desc,title:o.title},_.default.createElement(f.Box,{className:d.screenTwoButtons},_.default.createElement(S,{buttonGroup:r})))},Ce=({handleCancel:e,closeModal:t,modalParams:n})=>{let[o,a]=(0,_.useState)(1);return o===2?_.default.createElement(Pe,{modalParams:n,handleCancel:e,handleNext:t}):_.default.createElement(Ae,{modalParams:n,handleCancel:e,handleNext:()=>{a(2)}})},at=Ce;export{Ze as a,at as b,w as c,A as d,xe as e,ae as f,ie as g,Ee as h,Oe as i};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-RMSE4KTO.js.map
