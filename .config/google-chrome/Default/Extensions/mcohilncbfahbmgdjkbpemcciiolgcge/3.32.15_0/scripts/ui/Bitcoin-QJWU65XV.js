import{a as An}from"./chunk-RZVKOSLL.js";import{a as Nn}from"./chunk-TC3YAW4K.js";import{a as Sn}from"./chunk-YKXOTYDR.js";import{a as Tn}from"./chunk-NKXP6EKG.js";import{i as yn,j as gn,k as Cn,l as In,m as wn,n as hn}from"./chunk-M4UOXZNH.js";import"./chunk-C5ZY4QOR.js";import"./chunk-OQY6TZK5.js";import"./chunk-6LE5AZMI.js";import{a as Le,b as Pe}from"./chunk-VBFVRBFM.js";import{a as xn}from"./chunk-D7AZLJO7.js";import{a as ke}from"./chunk-226IQWB4.js";import{b as pn,c as _n,d as fn}from"./chunk-4MZS5WUT.js";import{a as dn}from"./chunk-YMNU7XNS.js";import{a as rn,b as sn,e as an,f as ln}from"./chunk-TK3POT64.js";import{a as un}from"./chunk-IHRKU3VB.js";import"./chunk-PKCAYJL7.js";import"./chunk-D7IU2MQB.js";import{d as mn,e as cn}from"./chunk-HTCS5UFP.js";import"./chunk-P4KG7HC3.js";import"./chunk-2YRNNTO4.js";import{a as pe}from"./chunk-FCM3KMN7.js";import{a as be,b as Be}from"./chunk-PYDL4HCD.js";import"./chunk-C6JR2GZU.js";import"./chunk-WMPWBUW7.js";import{b as Rt,g as Ae,i as Jo,j as Qo,k as Se,m as Ee,q as tn,r as en,s as on}from"./chunk-GL5KZF23.js";import"./chunk-6D2WFU2O.js";import{a as Ne}from"./chunk-445ZV7VL.js";import{e as Ko}from"./chunk-YQGNRWCJ.js";import"./chunk-X4Z4JMVV.js";import{c as jo}from"./chunk-RMSE4KTO.js";import"./chunk-W7APXTAD.js";import"./chunk-ALNQKIUN.js";import{a as ce}from"./chunk-XZFOTB6K.js";import"./chunk-ZGE3YU4L.js";import{a as nn,b as me,c as to,d as X,e as $t,g as Q}from"./chunk-R5U3NPEX.js";import"./chunk-JDZSGQWQ.js";import"./chunk-XY66VBX7.js";import"./chunk-GZFI5G46.js";import{q as G}from"./chunk-UAHUXCQX.js";import"./chunk-73OZ5IYN.js";import"./chunk-BWRHBLYR.js";import{c as Vo}from"./chunk-XTOYI7P4.js";import"./chunk-KSCP4BJT.js";import"./chunk-3MIEWVTZ.js";import{d as ht,f as Ro,g as $o}from"./chunk-J2H2J7IS.js";import"./chunk-SJIEUX3S.js";import"./chunk-L7LFNDLE.js";import"./chunk-NEFZK4RT.js";import{a as le}from"./chunk-STMKIE2Z.js";import"./chunk-GUQJR5VF.js";import"./chunk-MI6YHDAD.js";import"./chunk-ZAW6Z544.js";import"./chunk-SVAMZON6.js";import"./chunk-MF4732CU.js";import{c as ft}from"./chunk-F52H34ZH.js";import"./chunk-3RNOIYOK.js";import"./chunk-OQFQ7WFP.js";import"./chunk-MFN67L7C.js";import{a as Yo}from"./chunk-VUOBHGTC.js";import"./chunk-YW7TPMAR.js";import"./chunk-PGKED42N.js";import"./chunk-KSAOBFIR.js";import"./chunk-OJURW5TU.js";import"./chunk-PMGQLREC.js";import"./chunk-W6OF57RJ.js";import"./chunk-HRZ4SZVQ.js";import"./chunk-ECPXLKIL.js";import"./chunk-RK4XZYBE.js";import"./chunk-HMORTYXM.js";import"./chunk-OEIE6KE4.js";import"./chunk-N3OY7GLG.js";import"./chunk-ORJ3QBGC.js";import{b as Xo}from"./chunk-VVL4IZMM.js";import{b as nt}from"./chunk-ONV3ODOM.js";import{d as Go}from"./chunk-ZI4ZHHA3.js";import"./chunk-3545CIHX.js";import"./chunk-KWBWAA7R.js";import"./chunk-GJCTNUAU.js";import"./chunk-OCCQLMQL.js";import"./chunk-RIWLOEHK.js";import"./chunk-TRBDC433.js";import"./chunk-5KSRM7B2.js";import{a as Qe}from"./chunk-PPHSAQ52.js";import{h as J,i as at}from"./chunk-JUOUD4EO.js";import{d as qo}from"./chunk-4W35J5OQ.js";import"./chunk-GPJC633M.js";import{j as Zo}from"./chunk-YC6W5MPL.js";import"./chunk-ABBYZM2I.js";import"./chunk-KNUMOXQD.js";import"./chunk-JJ3ARLVE.js";import"./chunk-ZLD5XTE5.js";import"./chunk-2VRILCVI.js";import"./chunk-IRMGOW5H.js";import"./chunk-CQ64XZTP.js";import"./chunk-UXLFUD7T.js";import"./chunk-2HEOW3XO.js";import"./chunk-DLRFA5AU.js";import"./chunk-OC3IFNJW.js";import"./chunk-UI7PAU35.js";import{a as Ho}from"./chunk-SMZ64QW3.js";import"./chunk-DQTTI4XL.js";import"./chunk-FF6KJRSH.js";import"./chunk-CQ7YBDUS.js";import"./chunk-GSYNHSX4.js";import"./chunk-Y6SGFHFT.js";import"./chunk-V4NJDTLC.js";import"./chunk-OFKAKQXT.js";import{m as se,n as ae}from"./chunk-IQUFOLSA.js";import"./chunk-KA5XDNKC.js";import"./chunk-HXUMX2S7.js";import"./chunk-QKXA7YNE.js";import{a as Ut}from"./chunk-PAER4Z2U.js";import"./chunk-LBVWUYQX.js";import{a as Ot}from"./chunk-M2F2X65U.js";import"./chunk-ZYEEMVIP.js";import"./chunk-BOOOUD52.js";import"./chunk-TBLUUKKO.js";import{a as Zt}from"./chunk-S5DGV5WL.js";import{b as ot}from"./chunk-AOXUSYRH.js";import{a as Ao,q as T}from"./chunk-WKBC6JL3.js";import"./chunk-3EO5SKIF.js";import{a as br}from"./chunk-LMIOM5QK.js";import{X as Bt}from"./chunk-VPDRXROE.js";import{V as Do,W as Oo,j as Ve,k as Ce,m as xo,n as To,w as ie}from"./chunk-JLIPSIRU.js";import{a as So}from"./chunk-CIDV5VJQ.js";import{a as je}from"./chunk-VX55KNI4.js";import{i as Te,m as zo}from"./chunk-4TYAYDA2.js";import"./chunk-LDX3S2CG.js";import"./chunk-TS5DNQFS.js";import"./chunk-656GFN7J.js";import{I as K,W as ko,Y as kr,Z as Dt,b as P,c as bo,i as Bo,ia as bt,ja as Lo,ta as gt}from"./chunk-VGT27A4M.js";import{d as Eo,f as Br}from"./chunk-R4G6BEPF.js";import"./chunk-S3MY46XE.js";import"./chunk-2333N6PK.js";import"./chunk-AYCAVTPT.js";import"./chunk-OG46YTNN.js";import{c as u}from"./chunk-RXNDJ7P3.js";import"./chunk-YM7II27E.js";import{a as Uo,b as Lr}from"./chunk-CYOQISC6.js";import{c as Wo,h as Pr}from"./chunk-TKYTZF2K.js";import"./chunk-RY27BWZR.js";import"./chunk-WIWWLEBZ.js";import{Db as ne,Eb as wt,Gb as po,Jb as re,Kc as Er,Mb as uo,Ob as _o,Ub as Sr,Uc as Ht,X as Ar,bd as Po,dd as Fo,ed as vo,fd as Mo,gd as he,kc as fo,w as $e}from"./chunk-YT2MPR4E.js";import"./chunk-R4ZXRZL6.js";import{G as Io,H as wo,N as Je,O as ho,W as No,b as qt,o as Mt,p as Ke,r as go,y as Co}from"./chunk-LDKM7IQF.js";import"./chunk-6O63U2D6.js";import{M as R,l as A,x as i}from"./chunk-RIOWPXBZ.js";import"./chunk-BAWLRI3I.js";import"./chunk-USKTQDCY.js";import"./chunk-B2L2MSSC.js";import"./chunk-OIIWKMG6.js";import{T as we,Z as yo,c as Ie,ca as z}from"./chunk-OSCGYMLH.js";import"./chunk-ADWO6K2C.js";import{a as W}from"./chunk-O337TVCZ.js";import"./chunk-EJP3AYQB.js";import"./chunk-QOGOEJFG.js";import"./chunk-TZ33IXYR.js";import"./chunk-BTK364VD.js";import"./chunk-2T657SRL.js";import"./chunk-QJAZEJHH.js";import"./chunk-IMZNFJSN.js";import"./chunk-LCKQ7YKT.js";import"./chunk-WRBXETR5.js";import"./chunk-RBB7LL2V.js";import"./chunk-ZVYHIM2Y.js";import"./chunk-T47I3VPR.js";import"./chunk-ME7FEN7O.js";import"./chunk-VBARKITZ.js";import"./chunk-NCANHNXF.js";import{f as d,m as s,n as x,o as a}from"./chunk-GLD6H5Q5.js";s();a();var Pt=d(W());gt();s();a();var Fe=d(W());R();s();a();var En=({unapproved:t})=>Fe.default.createElement(u.Container,null,Fe.default.createElement(Ut,{title:i("wallet_trade_maintitle_transaction_confirm"),backable:!1,closeable:!1}),Fe.default.createElement(Tn,{unapproved:t}));s();a();var h=d(W()),bn=d(ie()),ve=d(Bt());R();Br();he();gt();re();var Fr=({unapproved:t})=>{let e=t?.localType,o=ft({localType:e})?.coinId;o===void 0&&(o=wt(e));let r=ht(o),l=(0,bn.useDispatch)(),c=t.walletId,p=t.params.transaction.from,B=ae(c),C=t.params.transaction.amount||2,[,y]=Ne({coinId:o,address:p,chainId:r?.chainId}),w=y?.transferReminder,f=y?.dummyOutput,[m,I]=(0,h.useState)({level:Dt.STANDARD,satBytes:y?.normal}),E=m?.satBytes;(0,h.useEffect)(()=>{if(!E&&y?.normal&&I({level:Dt.STANDARD,satBytes:y?.normal}),E&&m?.level!==Dt.CUSTOM){let $=y[be[m?.level]?.satBytes];I({...m,satBytes:$})}},[y]);let[D,{toggle:O}]=(0,ve.useBoolean)(!1),[F,{set:N}]=(0,ve.useBoolean)(!1),[b,{set:U}]=(0,ve.useBoolean)(!1),[v,Ft]=(0,h.useState)(),[H,S]=Se({coinId:o,walletId:c,address:p,batchDummyNum:C,utxoType:Rt.SPLIT_UTXO}),[It,k,yt]=Qo({coinId:o,walletId:c,address:p,networkFee:v,utxoType:Rt.SPLIT_UTXO,batchDummyNum:C,coinAmount:A.mul(f,C)},{ready:!!f}),rt=(0,h.useMemo)(()=>k.findIndex(({dummy:$})=>$!==!0),[k]),mt=(0,h.useMemo)(()=>rt===-1?[]:k.slice(rt),[rt,k]),it=(0,h.useMemo)(()=>rt===-1?0:Math.max(C-rt,0),[C,rt]),At=A.gt(it,0),jt=A.mul(f,it),tt=tn({coinId:o,fromAddr:p,satBytes:E}),st=(0,h.useCallback)(async()=>{try{if(!E)return;N(!0);let $=await tt({inputs:mt,outputs:Array.from({length:it}).map(()=>({address:p,amount:f}))});U(!1),Ft($)}catch{U(!0)}finally{N(!1)}},[f,tt,p,mt,it,E,U,N]);(0,h.useEffect)(()=>{st()},[st]);let ct=(0,h.useMemo)(()=>S===void 0||!v?!0:A.gt(S,v),[S,v]),Kt=(0,h.useMemo)(()=>B?{type:Q.TIP_TYPE.COMMON_ERROR,message:i("wallet_extension_top_toast_dapp_comingsoon")}:b?{type:Q.TIP_TYPE.FEE_ERROR}:ct?{type:qt.TYPE.warn,message:w}:{coinId:o,type:Q.TIP_TYPE.FEE_BALANCE_INSUFFICIENT},[o,b,B,ct,w]),vt=Ko({coinId:o,walletId:c,coinAmount:0,fromAddr:p,toAddr:p,localType:r?.localType,networkFee:v,extJson:JSON.stringify({}),txSource:Ht.DAPP,txType:P.BTC_SPLIT_UTXO}),St=Ee({coinId:o,txType:P.BTC_SPLIT_UTXO,address:p}),et=se(c),[Yt,Gt]=(0,h.useState)(!1),Jt=(0,h.useCallback)(async()=>{await l(J(t.id)),await l(nt()),Gt(!1)},[l,t.id]),Qt=(0,h.useCallback)(async()=>{if(At)try{if(!await le({walletId:c,callback:async()=>{await l(J(t.id))}}))return;await St(mt),Gt(!0);let{signed:Xt,utxos:He}=await Eo().splitUtxo({splitAmount:it,inputs:Ae(mt),amount:f,feePerB:m.satBytes},p,c);await vt(Xt);let Ze=k.filter(te=>te.dummy),Re=[...Ae(Ze),...He.map(te=>({...te,rawTransaction:Xt}))];await l(at(t.id,{utxos:Re}))}catch($){console.log($)}finally{Gt(!1)}else{let $=k.slice(0,C);await l(at(t.id,{utxos:Ae($)}))}},[C,l,f,k,p,At,mt,vt,it,m.satBytes,t.id,St,c]),de=(0,h.useMemo)(()=>{let $={actionType:G.ACTION_TYPE.CANCEL,btnText:i("wallet_dapp_connection_btn_reject"),onClick:Jt},Xt={actionType:G.ACTION_TYPE.CONFIRM,disabled:H||F||It||b||yt||!Number(v)||B,onClick:Qt};return ct||(Xt={coinId:o,walletId:c,address:p,actionType:G.ACTION_TYPE.FILL_UP}),[$,Xt]},[o,v,b,F,p,B,ct,H,Jt,Qt,yt,It,c]);return h.default.createElement(u.Container,null,h.default.createElement(Ut,{backable:!1,closeable:!1,title:i("wallet_extension_send_title_send")}),h.default.createElement(X,null,h.default.createElement(me,{title:i("wallet_extension_send_colored_send"),summaryList:[{coinId:o,coinAmount:jt}]})),h.default.createElement(X,null,h.default.createElement($t,{walletId:c,address:p,title:i("wallet_extension_network_address_title_walletused")},!!S&&h.default.createElement(Le,{coinBalance:S,tooltip:i("extension_defi_bot_popuptext_avail_amount"),coinId:o}))),h.default.createElement(X,{bordered:!1},h.default.createElement(ce,{coinId:o,loading:F,feeError:b,networkFee:v,onClick:O})),h.default.createElement(Ot,{placeholder:!0,offsetBottom:0,borderTop:!0},h.default.createElement(Q,{coinId:o,...Kt}),h.default.createElement(G,{buttonGroup:de})),h.default.createElement(Be,{coinId:o,visible:D,signInfo:y,value:m,estimatedFee:v,onChange:I,onToggleVisible:O}),h.default.createElement(Pe,{visible:et&&Yt}))},Bn=Fr;s();a();var kn=d(W());var Ln=({unapproved:t})=>{let e=t.params?.message,n=xn({unapproved:t});return kn.default.createElement(dn,{needCheckMpc:!0,message:e,unapproved:t,tipMessage:n})};s();a();var Ct=d(W()),Pn=d(ie()),Fn=d(je()),vn=d(Bt());he();gt();Er();re();s();a();var Vt={AMOUNT:1,CONFIRM:2};var eo=Vt.AMOUNT;function vr({unapproved:t}){let{from:e,type:n=P.BRC20_INSCRIBE,tick:o="",tid:r,amount:l,txSource:c=Ht.DAPP}=t?.params?.transaction||{},p=t?.localType||fo,[B,C]=(0,Ct.useState)(eo),y=(0,Pn.useDispatch)(),w=(0,Fn.useHistory)(),m=ft({localType:p})?.netWorkId;m===void 0?m=ne(p):m=+m;let I=(0,vn.useCreation)(()=>n===P.BRC20_INSCRIBE?{chainId:m,coinType:Ce(m),symbol:o}:null,[n,r,o,m]),D=ht(void 0,{},I)?.coinId,O=(0,Ct.useCallback)(async()=>{await y(J(t.id)),await y(nt()),w.push(Zt)},[y,w,t.id]),F=(0,Ct.useCallback)(()=>{C(Vt.CONFIRM),eo=Vt.CONFIRM},[]),N=(0,Ct.useCallback)(async({txIds:U,commitTx:v,revealTxs:Ft})=>{await y(at(t.id,{txIds:U,commitTx:v,revealTxs:Ft})),await y(nt()),w.push(Zt)},[y,w,t.id]),b=(0,Ct.useCallback)(()=>{C(Vt.AMOUNT),eo=Vt.AMOUNT},[]);return Ct.default.createElement(hn,{fromAddress:e,coinId:D},B===Vt.AMOUNT?Ct.default.createElement(In,{amount:l,walletId:t.walletId,onCancel:O,onConfirm:F,headerProps:{closeable:!1,backable:!1}}):Ct.default.createElement(wn,{txSource:c,onCancel:O,onConfirm:N,walletId:t.walletId,headerProps:{onBack:b,closeable:!1,backable:!0}}))}var Mn=vr;s();a();var _=d(W()),lr=d(ie()),mr=d(je());R();s();a();var oo=d(W()),On=d(Bt());Lo();s();a();function Dn(t=[]){if(!Array.isArray(t))throw new Error("assetChange should be an array");return t.map(e=>{let{direction:n,amount:o,usdAmount:r,symbol:l,logo:c}=e;return{operator:n===1?"+":"-",usdValue:r,rawValue:o,asset:{assetType:jo.NATIVE,amount:o,symbol:l,imageUrl:c}}})}var Mr=({address:t,hexStringList:e=[],chainIndex:n=0},o={})=>{let r=e?.toString(),l={ready:n!==void 0&&!!e?.length,refreshDeps:[t,r,n],...o},{loading:c,data:p,error:B}=(0,On.useRequest)(async()=>(await Zo({address:t,hexStringList:e,chainIndex:n})).data,l);return{loading:c,data:p,error:B}},Dr=t=>(0,oo.useMemo)(()=>!t||!t.length?[]:t.map(e=>{let{assetChange:n=[],assetInversion:o}=e;return{status:e.analysisStatus,gasFee:e?.gasFee||0,isShowFee:e?.isShowFee,exploreUrl:e?.exploreUrl,inputInfo:e?.inputInfo||[],outputInfo:e?.outputInfo||[],assetChange:Dn(n),assetInversion:o||!1}}),[t]),Or=(t=[])=>(0,oo.useMemo)(()=>!t||!t.length?null:t.some(n=>n.status>0)?bt.EXECUTE_ERROR:null,[t]);function Un(t={},e={}){let{loading:n,data:o,error:r}=Mr(t,e),{utxoAllInfos:l}=o||{},c=Dr(l),p=Or(c);return{loading:n,error:r||p,data:c}}s();a();var dt=d(W()),De=d(Bt());R();gt();s();a();var j=d(W()),no=d(Bt());R();gt();s();a();R();var Wn=t=>{typeof t!="string"&&(t=t.toString());let e=t?.length;return e<=9?36:e>=10&&e<12?32:e===12?30:e>=13&&e<=15?24:e>=16&&e<=18?20:e>=19&&e<=24?16:12},zn=(t,e)=>t?!1:e===""?!0:!A.gte(`${e||0}`,0);s();a();var Nt={AuthorizationToken:"_AuthorizationToken_g68hx_1",authorizationToken:"_AuthorizationToken_g68hx_1",title:"_title_g68hx_1",content:"_content_g68hx_4",unlimited_text:"_unlimited_text_g68hx_13",unlimitedText:"_unlimited_text_g68hx_13",balance:"_balance_g68hx_17",amount:"_amount_g68hx_22",checkAll:"_checkAll_g68hx_26",checkAll__text:"_checkAll__text_g68hx_30",checkAllText:"_checkAll__text_g68hx_30",footerActions:"_footerActions_g68hx_33"};s();a();var Ur=({chainId:t,address:e,walletId:n})=>{let o=ht(void 0,void 0,{chainId:t,address:e}),{coinId:r}=o||{};return Ro(r,n)},Yn=Ur;var Wr=({txType:t,chainId:e,address:n,walletId:o,authAmount:r,onConfirm:l})=>{let c=Yn({chainId:e,address:n,walletId:o}),{symbol:p,decimals:B}=c||{},C=ln(p,10),y=t===P.INCREASE_ALLOWANCE?"extension_approve_text_increase_approvals":"wallet_contract_interaction_approval_permission_authorized_amount",w=Oo(r),[f,m]=(0,j.useState)(!1),[I,E]=(0,j.useState)(w?"0":r),D=(0,j.useMemo)(()=>zn(f,I),[f,I]),O=(0,no.useMemoizedFn)(async()=>{l?.(f?Do:I)}),F=(0,no.useMemoizedFn)(()=>{E(c?.coinAmount)}),N=A.thousandFormat(c?.coinAmount);return j.default.createElement(u.FlexBox,{className:Nt.AuthorizationToken,direction:u.DIRECTION.vertical,align:u.ALIGN.center},j.default.createElement(T.Text,{strong:700,className:Nt.title},i(y)),j.default.createElement(u.Box,{className:Nt.content},f?j.default.createElement(T.Text,{strong:500,size:T.SIZE.xl,className:Nt.unlimited_text},i("wallet_extension_transfer_title_unlimited_amount",{token:C})):j.default.createElement(Vo,{symbol:C,autoSize:Wn,placeholder:"0",decimals:B||0,value:I,onChange:E,style:{fontWeight:500,height:"48px"}}),!!Number(c?.coinAmount)&&j.default.createElement(T.Text,{nowrap:!0,type:T.TYPE.secondary,size:T.SIZE.xs,onClick:F,className:Nt.balance},i("wallet_extension_transfer_dialog_text_balance_amount",{amount:j.default.createElement(T.Text,{inherit:!0,component:"span",className:Nt.amount,ellipsis:{tooltip:N}},N),token:C}))),j.default.createElement(go,{className:Nt.checkAll,checked:f,textClass:Nt.checkAll__text,onChange:({target:{checked:b}})=>{m(b)}},i("wallet_extension_transfer_dialog_checkbox_set_to_unlimited")),j.default.createElement(Ot.FooterActions,{affixStyle:{position:"none"},placeholder:!1,className:Nt.footerActions},j.default.createElement(z,{disabled:D,category:z.CATEGORY.fill,type:z.TYPE.primary,size:z.SIZE.lg,onClick:O},i("commonall_filter_btn_save"))))},Gn=Wr;s();a();var Me={edit_btn:"_edit_btn_rw6lw_1",editBtn:"_edit_btn_rw6lw_1",authorization_token_dialog:"_authorization_token_dialog_rw6lw_5",authorizationTokenDialog:"_authorization_token_dialog_rw6lw_5",authorization_token_dialog__content:"_authorization_token_dialog__content_rw6lw_5",authorizationTokenDialogContent:"_authorization_token_dialog__content_rw6lw_5"};var zr=t=>{let[e,{toggle:n}]=(0,De.useBoolean)(!1),{txType:o,loading:r,dappInfo:l,walletId:c,analyzeRet:p,approveToken:B,onAuthTokenAmountChange:C,showDappInfo:y=!0,noFold:w=!1}=t,{approveList:f,assetChange:m=[]}=p,I=f?.[0]||{},E=(0,De.useMemoizedFn)(D=>{n(),C?.(D)});return r?dt.default.createElement(un,null):sn(o)?dt.default.createElement(_n,{approveInfo:I}):rn(o)?dt.default.createElement(dt.default.Fragment,null,dt.default.createElement(fn,{approveInfo:I,authAmount:B?.authAmount,editBtnSlot:[P.AUTHORIZATION,P.INCREASE_ALLOWANCE].includes(I?.approvalType)?dt.default.createElement(z,{size:z.SIZE.xs,type:z.TYPE.primary,category:z.CATEGORY.outline,className:Me.edit_btn,onClick:n},i("wallet_extension_transfer_text_edit")):null}),dt.default.createElement(Mt,{alignBottom:!0,noContentPadding:!0,visible:e,onClose:n,className:Me.authorization_token_dialog,windowClass:Me.authorization_token_dialog__content},dt.default.createElement(Gn,{txType:o,walletId:c,...B,onConfirm:E}))):an(o)?dt.default.createElement(pn,{assetChange:m,dappInfo:l,showDappInfo:y,noFold:w}):y?dt.default.createElement(X,null,dt.default.createElement(cn,{...l})):null},Oe=zr;s();a();var g=d(W()),_e=d(Ie());R();s();a();var ue=d(W());var qn=d(br());R();var ro=d(Bt());s();a();var Xn={address:"_address_11ipy_1"};function io({children:t,addresses:e=[],exploreUrl:n=""}){let o=e[0],r=(0,ro.useMemoizedFn)(()=>{(0,qn.default)(o),Io.success({title:i("wallet_receive_toast_address_copied"),desc:""})},[o]),l=(0,ro.useMemoizedFn)(()=>{n&&globalThis.platform.openTab({url:`${n}${o}`})},[o,n]);return e.length>1?t:ue.default.createElement(Ke.WhiteBoard,{rebirthPopper:!0,popupStyle:{marginLeft:16,marginRight:16,padding:12,borderRadius:8},content:ue.default.createElement(u.FlexBox,{align:u.ALIGN.center,justify:"center"},ue.default.createElement(T.Text,{forceWrap:!0,size:T.SIZE.sm,className:Xn.address},o),ue.default.createElement(ot,{size:ot.SIZE.xs,icon:"okds-copy",onClick:r,style:{marginLeft:8}}),ue.default.createElement(ot,{size:ot.SIZE.sm,icon:"okx-wallet-plugin-open-link",onClick:l,style:{marginLeft:8}})),trigger:Ke.TRIGGER.hover},t)}Sr();s();a();he();function so(t){return t===Po.XRC_NFT}s();a();var M={content:"_content_1i550_1",none:"_none_1i550_4",title:"_title_1i550_10",input:"_input_1i550_15",utxoContainer:"_utxoContainer_1i550_18",isCurrentAddr:"_isCurrentAddr_1i550_18",signTag:"_signTag_1i550_18",addrContainer:"_addrContainer_1i550_24",address:"_address_1i550_29",amount:"_amount_1i550_38",xrcAssetsContainer:"_xrcAssetsContainer_1i550_50",xrcAssetsTitle:"_xrcAssetsTitle_1i550_56",xrcAssetContainer:"_xrcAssetContainer_1i550_62",logo:"_logo_1i550_65",isNFT:"_isNFT_1i550_72",isNft:"_isNFT_1i550_72",amountText:"_amountText_1i550_75",protocol:"_protocol_1i550_78",moreXRCContainer:"_moreXRCContainer_1i550_85",moreXrcContainer:"_moreXRCContainer_1i550_85",showMoreTitle:"_showMoreTitle_1i550_89",moreAssetsLogos:"_moreAssetsLogos_1i550_95",moreAssetsLogo:"_moreAssetsLogo_1i550_95",expandContainer:"_expandContainer_1i550_106",expandContainer_title:"_expandContainer_title_1i550_110",expandContainerTitle:"_expandContainer_title_1i550_110",expandContainer_leftTotal:"_expandContainer_leftTotal_1i550_116",expandContainerLeftTotal:"_expandContainer_leftTotal_1i550_116",expandContainer_icon:"_expandContainer_icon_1i550_123",expandContainerIcon:"_expandContainer_icon_1i550_123"};var ao="inputInfo",Hn="outputInfo",Ue={xrcAsset:10,utxo:50},Yr=({coinId:t,data:e={},currentAddr:n})=>{let[o,r]=(0,g.useState)({}),[,l]=$o(t,{withPrice:!0}),c=(0,g.useMemo)(()=>[ao,Hn].map(m=>{let I=e[m]||[],E=o[m]||!1;return I.map((D,O)=>{let F=o[`${m}-${O}`]||!1,N=D.xrcAssets||[];return D.xrcToShow=F?N:N.slice(0,Ue.xrcAsset),D.moreXRC=N.slice(Ue.xrcAsset),D}),{key:m,exploreUrl:e.exploreUrl,allData:I,dataToShow:E?I:I.slice(0,Ue.utxo),moreData:I.slice(Ue.utxo)}}),[e,o]),p=(0,g.useCallback)((f=[])=>f.reduce((m,{amount:I})=>A.add(m,I),0),[]),B=(0,g.useCallback)(f=>{switch(f){case ao:return i("wallet_extension_asset_input_inputs_num",{amount:c[0].allData.length});case Hn:return i("wallet_extension_asset_outputs",{amount:c[1].allData.length});default:return""}},[c]),C=(0,g.useCallback)(f=>{r(m=>({...m,[f]:!0}))},[]),y=f=>{let{protocolType:m}=f||{};return so(m)?f.logo||_o:f.logo||uo},w=g.default.memo(({xrcAssets:f=[]})=>g.default.createElement(u.FlexBox,{align:u.ALIGN.center,className:M.moreAssetsLogos},f.slice(0,3).map(m=>g.default.createElement("img",{className:M.moreAssetsLogo,src:m.logo||"",alt:m.symbol}))));return g.default.createElement(ke,{copyable:!1,title:i("wallet_extension_asset_btn_transaction_details")},c.map(f=>g.default.createElement("div",{className:(0,_e.default)(M.content,f.key===ao?M.input:"",f.dataToShow.length===0?M.none:"")},g.default.createElement("div",{className:(0,_e.default)(M.title)},B(f.key)),f.dataToShow.map((m,I)=>g.default.createElement(g.default.Fragment,null,g.default.createElement(u.FlexBox,{align:u.ALIGN.center,justify:"space-between",className:(0,_e.default)(M.utxoContainer,n===m.address[0]?M.isCurrentAddr:"")},g.default.createElement("div",{className:(0,_e.default)(M.addrContainer)},g.default.createElement(io,{addresses:m.address,exploreUrl:f.exploreUrl},g.default.createElement("div",{className:M.address},m.address.length>1?i("wallet_extension_asset_title_multisig"):xo(m.address[0]))),g.default.createElement(No,{className:M.signTag,size:Je.SIZE.sm},i("wallet_extension_asset_tag_sign"))),g.default.createElement("div",{className:M.amount},g.default.createElement(T.DisplayAmount,{noStyle:!0,amount:m.amount,mode:T.CRYPTO,symbol:l?.symbol,decimals:l?.decimals}))),m.xrcToShow.length>0&&g.default.createElement("div",{className:M.xrcAssetsContainer},g.default.createElement(T.Text,{size:T.SIZE.xs,className:M.xrcAssetsTitle},i("wallet_extension_asset_include_asset")),m.xrcToShow.map(E=>g.default.createElement(u.FlexBox,{align:u.ALIGN.center,className:M.xrcAssetContainer},g.default.createElement("img",{className:(0,_e.default)(M.logo,so(E.protocolType)?M.isNFT:""),src:y(E),alt:E.symbol}),g.default.createElement(T.Text,{nowrap:!0,size:T.SIZE.xs,ellipsis:{tooltip:!0},className:M.amountText},`${E.amount} ${E.symbol}`),g.default.createElement(ho,{className:M.protocol,size:Je.SIZE.sm},E.protocolName))),m.moreXRC.length>0&&!o[`${f.key}-${I}`]?g.default.createElement(u.FlexBox,{align:u.ALIGN.center,onClick:()=>{C(`${f.key}-${I}`)},className:M.moreXRCContainer},g.default.createElement(w,{xrcAssets:m.moreXRC}),g.default.createElement("div",{className:M.showMoreTitle},i("wallet_extension_asset_btn_show_num_asset",{amount:A.thousandFormat(m.moreXRC.length)})),g.default.createElement(ot,{icon:"okds-arrow-chevron-down-md",size:ot.SIZE.xs})):null))),f.moreData.length>0&&!o[f.key]?g.default.createElement("div",{className:M.expandContainer,onClick:()=>{C(f.key)}},g.default.createElement(u.FlexBox,{align:u.ALIGN.center,justify:"space-between"},g.default.createElement("div",{className:M.expandContainer_title},i("wallet_extension_asset_more_amount_inputs",{amount:A.thousandFormat(f.moreData.length)})),g.default.createElement(u.FlexBox,null,g.default.createElement("div",{className:M.expandContainer_leftTotal},g.default.createElement(T.DisplayAmount,{noStyle:!0,amount:p(f.moreData),mode:T.CRYPTO,symbol:l?.symbol,decimals:l?.decimals})),g.default.createElement(ot,{icon:"okds-arrow-chevron-down-md",size:Ao.xs,className:M.expandContainer_icon})))):null)))},Zn=Yr;s();a();var Z=d(W()),Rn=d(Ie());R();s();a();var lt={main:"_main_asg9r_1",title:"_title_asg9r_8",scrollArea:"_scrollArea_asg9r_17",item:"_item_asg9r_22",subTitle:"_subTitle_asg9r_25",content:"_content_asg9r_32",loading:"_loading_asg9r_38",arrow:"_arrow_asg9r_43",icon:"_icon_asg9r_48"};function Gr({psbts:t=[],loading:e,onClick:n}){let o=(0,Z.useCallback)(l=>{n(l)},[n]),r=()=>e?Z.default.createElement("div",{className:lt.scrollArea},Z.default.createElement("div",{className:lt.loading},Z.default.createElement(yo.Circle,null))):t.length===0?Z.default.createElement(Co.State,{className:lt.empty}):Z.default.createElement("div",{className:lt.scrollArea},(t||[]).map((l,c)=>Z.default.createElement(u.FlexBox,{className:lt.item,align:u.ALIGN.center,key:l,onClick:()=>{o(c)}},Z.default.createElement(u.FlexBox,{className:lt.content,direction:u.DIRECTION.vertical},Z.default.createElement("div",{className:lt.subTitle},i("wallet_extension_asset_transaction_confirmation",{amount:Qe(c+1)})),Z.default.createElement("div",{className:lt.content},To(l))),Z.default.createElement("div",{className:lt.arrow},Z.default.createElement(ot,{className:(0,Rn.default)("okx-wallet-plugin-arrow-small-right",lt.icon)})))));return Z.default.createElement(u.FlexBox,{className:lt.main},Z.default.createElement("div",{className:lt.title},i("",{number:Qe(t.length)})),r())}var $n=(0,Z.memo)(Gr);zo();gt();Lo();re();s();a();var xt=d(W()),Vn=d(Ie());R();s();a();var Wt={main:"_main_1w6ta_1",box:"_box_1w6ta_6",tipImg:"_tipImg_1w6ta_12",tipImgIcon:"_tipImgIcon_1w6ta_21",title:"_title_1w6ta_25",decs:"_decs_1w6ta_33",w100:"_w100_1w6ta_39",footerWrap:"_footerWrap_1w6ta_42"};var Xr=({visible:t,onCancel:e,onConfirm:n,headerProps:o,psbtHasMultiXRCAsset:r,paymentUseXRCAsset:l,assetInversion:c})=>{let p=(0,xt.useMemo)(()=>r?i("wallet_extension_tip_multiple_inscription_use"):l?i("wallet_extension_desc_inscription_asset"):c?i("wallet_extension_transaction_desc_risky_greater_pay"):"",[c,l,r]);return xt.default.createElement(Mt,{visible:t,alignBottom:!0,noMargin:!0,maskClosable:!0,noContentPadding:!0,transitionProps:{type:"slide",placement:"bottom",timeout:300},confirmBtnProps:{size:z.SIZE.lg},cancelBtnProps:{size:z.SIZE.lg},cancelText:i("wallet_extension_function_btn_continue_transaction"),confirmText:i("wallet_extension_mid_dialog_btn_cancel"),onCancel:e,onConfirm:n,onClose:e},xt.default.createElement(u.FlexBox,{className:Wt.main,direction:u.DIRECTION.vertical},xt.default.createElement(u.Box,{className:Wt.box},xt.default.createElement(u.Box,{className:Wt.tipImg},xt.default.createElement(we,{className:(0,Vn.default)("okx-wallet-plugin-risk-trading",Wt.tipImgIcon)})),xt.default.createElement(T.Text,{className:Wt.title,align:T.ALIGN.center},i("wallet_extension_title_transaction_risk")),xt.default.createElement(T.Text,{className:Wt.decs,size:T.SIZE.sm,align:T.ALIGN.center},p)),xt.default.createElement(u.Box,{className:Wt.w100},xt.default.createElement(Oe,{...o,showDappInfo:!1,loading:!1,noFold:!0}))))},jn=Xr;s();a();Lr();Pr();var We=d(W()),qr=()=>{let[t,e]=(0,We.useState)(""),n=async()=>{let{data:o}=await Wo(Uo.getSignPrompt);o.assetReminder?e(o.assetReminder):e(null)};return(0,We.useEffect)(()=>{n()},[]),{assetReminder:t}},Kn=qr;s();a();var Jn=d(W());R();var Hr=({onConfirm:t})=>(0,Jn.useCallback)(()=>{Mt.warn({title:i("wallet_extension_asset_alertbanner_title_alert"),alignBottom:!1,maskClosable:!1,hideCloseBtn:!0,text:i("wallet_extension_asset_alertbanner_desc_utxo_lost"),confirmBtnProps:{type:z.TYPE.outline,size:z.SIZE.lg},cancelBtnProps:{type:z.TYPE.highlight,size:z.SIZE.lg},onConfirm(e){e.destroy(),t()},async onCancel(e){e.destroy()},cancelText:i("commonall_text_btn_cancel"),confirmText:i("wallet_extension_asset_btn_continue")})},[t]),Qn=Hr;s();a();var fe=d(W());gt();s();a();var q=d(W()),lo=d(Ie());s();a();var Tt={main:"_main_1fewt_1",box:"_box_1fewt_6",isPureScreen:"_isPureScreen_1fewt_12",tipImg:"_tipImg_1fewt_15",tipImgIcon:"_tipImgIcon_1fewt_24",title:"_title_1fewt_28",decs:"_decs_1fewt_36",extLink:"_extLink_1fewt_42",footerWrap:"_footerWrap_1fewt_46",screenOneButtons:"_screenOneButtons_1fewt_49",extButton:"_extButton_1fewt_53"};var tr=t=>{let{children:e,desc:n,title:o,isPureScreen:r}=t;return q.default.createElement(u.FlexBox,{className:Tt.main,direction:u.DIRECTION.vertical},q.default.createElement(u.Box,{className:(0,lo.default)(Tt.box,{[Tt.isPureScreen]:r})},q.default.createElement(u.Box,{className:Tt.tipImg},q.default.createElement(we,{className:(0,lo.default)("okx-wallet-plugin-risk-trading",Tt.tipImgIcon)})),q.default.createElement(T.Text,{className:Tt.title,align:T.ALIGN.center},o),q.default.createElement(T.Text,{className:Tt.decs,size:T.SIZE.sm,align:T.ALIGN.center},n)),q.default.createElement(u.Box,{className:Tt.footerWrap},e))},Zr=({modalParams:t,handleCancel:e,handleNext:n})=>{let{screenOne:o,screenTwo:r}=t,[l,c]=(0,q.useState)(!1),p=async()=>{c(!0),await e(),c(!1)};return q.default.createElement(tr,{desc:o.desc,title:o.title},q.default.createElement(u.Box,{className:Tt.screenOneButtons},q.default.createElement(z,{block:!0,loading:l,size:z.SIZE.lg,onClick:p,type:z.TYPE.highlight,category:z.CATEGORY.fill},o.mainBtnText),r?q.default.createElement(u.Box,{className:Tt.extButton,onClick:n},o.subBtnText):null))},Rr=({handleCancel:t,handleNext:e,modalParams:n})=>{let{screenTwo:o={}}=n,r=[{actionType:G.ACTION_TYPE.CANCEL,btnText:o.subBtnText,onClick:e},{actionType:G.ACTION_TYPE.CONFIRM,btnText:o.mainBtnText,onClick:t}];return q.default.createElement(tr,{isPureScreen:!0,desc:o.desc,title:o.title},q.default.createElement(u.Box,{className:Tt.screenTwoButtons},q.default.createElement(G,{buttonGroup:r})))},$r=({handleCancel:t,closeModal:e,modalParams:n})=>{let[o,r]=(0,q.useState)(1);return o===2?q.default.createElement(Rr,{modalParams:n,handleCancel:t,handleNext:e}):q.default.createElement(Zr,{modalParams:n,handleCancel:t,handleNext:()=>{r(2)}})},er=$r;s();a();var nr=d(W());R();s();a();var or={extLink:"_extLink_1eb1z_1"};var Vr=()=>{let t=Ho(),e=r=>({title:i("wallet_extension_fractal_title_transaction_risky"),desc:i(r,{case:nr.default.createElement(So,{className:or.extLink,href:t?.scamsUrl},i("wallet_extension_function_link_case"))}),mainBtnText:i("wallet_extension_function_btn_cancel"),subBtnText:i("wallet_extension_function_btn_advanced")}),n={title:i("wallet_extension_fractal_title_transaction_risky"),desc:i("wallet_extension_function_desc_developer_continue"),mainBtnText:i("wallet_extension_mid_dialog_btn_cancel"),subBtnText:i("wallet_extension_function_btn_continue_transaction")};return{getUTXONotFoundModalParams:()=>({screenOne:e("wallet_extension_fractal_desc_transaction_risky"),screenTwo:n})}},rr=Vr;var jr=({psbtsInfoErr:t,handleCancel:e})=>{let{getUTXONotFoundModalParams:n}=rr(),o=(0,fe.useRef)(),r=l=>{o.current||(o.current=Mt.action({hideCloseBtn:!0,maskClosable:!1,noContentPadding:!0,children:fe.default.createElement(er,{modalParams:l,handleCancel:async()=>{await e(),o.current.destroy(),o.current=null},closeModal:()=>{o.current.destroy(),o.current=null}})}))};(0,fe.useEffect)(()=>{t?.code==bt.UTXO_NOT_FOUND&&r(n())},[t])},ir=jr;s();a();R();s();a();var mo=d(Yo());var sr=t=>{try{return mo.Psbt.fromHex(t).toBase64()}catch{return mo.Psbt.fromBase64(t),t}};var ze=d(Yo()),kt={LIST:"list",UNLIST:"unlist",TRADE:"trade",RUNES:"runes"},ar=t=>{try{let e=ze.Psbt.fromBase64(sr(t)),n=e?.data?.inputs||[],o=e?.data?.globalMap?.unsignedTx?.tx?.outs||[],r=[];return n.forEach((l,c)=>{if(l.witnessUtxo)r.push({...l,value:l.witnessUtxo.value});else if(l.nonWitnessUtxo){let p=ze.Transaction.fromBuffer(l.nonWitnessUtxo),B=e?.data?.globalMap?.unsignedTx?.tx?.ins||[],y=p.outs[B[c]?.index]?.value;r.push({...l,value:y})}}),{inputs:r,outputs:o}}catch{return{inputs:[],outputs:[]}}},zt=(t,e=0,n)=>!Array.isArray(t)||n===0?0:t.slice(e,n?e+n:void 0).reduce((o,{value:r})=>A.add(o,r),0);var cr=({unapproved:t})=>{let{psbt:e,psbts:n,type:o,from:r,amount:l=1,psbtOpts:c,broadcast:p=!1}=t.params.transaction,{origin:B}=t,C=t.method===K.SIGNPSBTS,y=t?.walletId,w=t?.localType,m=ft({localType:w})?.coinId;m===void 0&&(m=wt(w));let I=se(y),E=ae(y),D=pe(y),{loading:O,data:F,error:N}=Un({address:r,hexStringList:C?n:[e],chainIndex:ne(w)}),[b,U]=(0,_.useState)(!1),[v,Ft]=(0,_.useState)(0),H=(0,_.useMemo)(()=>C&&!b,[C,b]),S=(0,_.useMemo)(()=>F[v]||{},[F,v]),{assetReminder:It}=Kn(),k=(0,lr.useDispatch)(),yt=(0,mr.useHistory)(),rt=mn(t),{name:mt,icon:it,host:At}=rt,{inputs:jt,outputs:tt}=ar(C?n[v]:e),st=(0,_.useMemo)(()=>A.sub(zt(jt),zt(tt)),[jt,tt]),ct=Nn(),Kt=(0,_.useMemo)(()=>{if(o!==kt.TRADE&&o!==kt.RUNES)return null;let V=Number(l);if(o===kt.RUNES){let ee=zt(tt,1,V),oe=A.add(zt(tt,0,1),zt(tt,tt.length-V+1,V-1));return`${A.sub(oe,A.add(ee,st))}`}let Et=zt(tt,V+1,V),pt=zt(tt,1,V);return`${A.sub(pt,A.add(Et,st))}`},[l,st,tt,o]),vt=(0,_.useMemo)(()=>I&&C?{type:Q.TIP_TYPE.COMMON_ERROR,message:i("extension_wallet_contractual_interaction_wallet_unavailable")}:E?{type:Q.TIP_TYPE.COMMON_ERROR,message:i("wallet_extension_top_toast_dapp_comingsoon")}:N?{type:qt.TYPE.warn,message:i("wallet_extension_asset_alert_trust_network")}:It&&!B?.includes("okx.com")?{type:qt.TYPE.warn,message:It}:{},[E,I,It,N,B]),St=(0,_.useCallback)(async()=>{await k(J(t.id)),await k(nt()),await Te(k)},[k,t.id]),et=(0,_.useCallback)(async()=>{if(!await le({walletId:y,callback:async()=>{await k(J(t.id))}}))return;let Et=po(w);try{let pt=await Go(C?n:e,r,y,{localType:Et,isPsbts:C},c);await k(at(t.id,{signedTx:pt,broadcast:p}))}catch(pt){await ct({id:t.id,error:pt?.message||"Error"})}await k(nt()),yt.push(Zt)},[yt,r,ct,k,C,w,e,c,n,t.id,y]);ir({psbtsInfoErr:N,handleCancel:St});let Yt=Qn({onConfirm:et}),[Gt,Jt]=(0,_.useState)(!1),Qt=(0,_.useMemo)(()=>{let V=S?.inputInfo||[],Et=S?.outputInfo||[],pt=V.filter(ut=>ut.address?.includes(r)),ee=Et.filter(ut=>ut.address?.includes(r)),oe=[],ge=[];return pt.forEach(ut=>{ut.xrcAssets&&ut.xrcAssets.forEach(_t=>{oe.some(xe=>xe.symbol===_t.symbol&&xe.protocolId===_t.protocolId)||oe.push({symbol:_t.symbol,protocolId:_t.protocolId})})}),ee.forEach(ut=>{ut.xrcAssets&&ut.xrcAssets.forEach(_t=>{ge.some(xe=>xe.symbol===_t.symbol&&xe.protocolId===_t.protocolId)||ge.push({symbol:_t.symbol,protocolId:_t.protocolId})})}),oe.length>0&&ge.length>0?!oe.every(ut=>ge.some(_t=>ut.symbol===_t.symbol&&ut.protocolId===_t.protocolId)):!1},[S,r]),de=(0,_.useMemo)(()=>{let V=S.inputInfo||[],Et=S.outputInfo||[];return[...V,...Et].some(pt=>!!(pt.xrcAssets&&pt.xrcAssets.length>1))},[S]),$=(0,_.useMemo)(()=>F.some(V=>{let Et=V.inputInfo||[],pt=V.outputInfo||[];return[...Et,...pt].some(ee=>!!(ee.xrcAssets&&ee.xrcAssets.length>1))}),[F]);(0,_.useEffect)(()=>{H||(de||Qt||S.assetInversion)&&Jt(!0)},[F,H,de,Qt,S.assetInversion]);let Xt=(0,_.useCallback)(()=>{if(!$||!H){et();return}Yt()},[$,et,Yt,H]),He=(0,_.useCallback)(V=>{U(!0),Ft(V)},[U]),Ze=(0,_.useMemo)(()=>[{actionType:G.ACTION_TYPE.CANCEL,btnText:H?i("wallet_extension_asset_btn_cancel_all"):i("wallet_dapp_connection_btn_reject"),onClick:St},{disabled:E||O||vt.type===Q.TIP_TYPE.COMMON_ERROR,actionType:G.ACTION_TYPE.CONFIRM,btnText:H?i("wallet_extension_asset_btn_confirm_all"):i("extension_transactions_btn_confirm"),onClick:Xt}],[E,St,vt,H,O]),Re=(0,_.useMemo)(()=>{switch(o){case kt.LIST:return i("extension_wallet_transfer_maintitle_list");case kt.UNLIST:return i("extension_wallet_transfer_maintitle_cancel_listing");case kt.TRADE:return i("extension_wallet_transfer_maintitle_transaction");default:return i("extension_wallet_transfer_maintitle_transaction")}},[o]),te=(0,_.useMemo)(()=>o==="list"||S&&!S.isShowFee?!1:A.gt(S.gasFee,0)||A.gt(st,0),[st,S,o]),hr=(0,_.useMemo)(()=>!N||N===bt.EXECUTE_ERROR&&S.status!==bt.PSBT_ANALYSIS_FAILED,[N,S]),Nr=(0,_.useMemo)(()=>N&&N!==bt.EXECUTE_ERROR||S?.status===bt.PSBT_ANALYSIS_FAILED,[N,S]);return _.default.createElement(u.Container,null,_.default.createElement(Ut,{title:Re,backable:C&&b,closeable:!1,onBack:()=>{U(!1)}}),H?_.default.createElement("div",null,_.default.createElement(X,null,_.default.createElement(to,{summaryList:[{title:mt,desc:At,icon:{src:it}}],title:i("extension_contract_interaction_maintitle_request_from")})),_.default.createElement($n,{psbts:n,loading:O,onClick:He})):null,H?null:_.default.createElement(_.default.Fragment,null,hr&&_.default.createElement(Oe,{coinId:m,txType:P.TRANS_OUT,loading:O,dappInfo:{name:mt,host:At,icon:it},analyzeRet:S}),Nr&&_.default.createElement(X,null,(o===kt.TRADE||o===kt.RUNES)&&_.default.createElement(me,{summaryList:[{coinId:m,coinAmount:Kt}],tooltip:i("extension_infor_tooltip_asset_changestips"),title:i("extension_contract_interaction_maintitle_asset_changes")}),_.default.createElement(to,{summaryList:[{title:mt,desc:At,icon:{src:it}}],title:i("extension_contract_interaction_maintitle_request_from")})),te&&_.default.createElement(X,null,_.default.createElement(ce,{coinId:m,networkFee:S.gasFee||st})),_.default.createElement(X,null,_.default.createElement($t,{title:i("wallet_extension_network_address_title_walletused"),address:r,walletId:y,onCopyCallback:()=>{D({trade:"approve",all_confirmation:"wallet_used_address"})}})),!te&&_.default.createElement(X,null,_.default.createElement(Sn,{coinId:m})),_.default.createElement(X,null,_.default.createElement(Zn,{coinId:m,data:S,currentAddr:r})),_.default.createElement(X,null,_.default.createElement(ke,{data:C?n[v]:e,copyable:{hideDesc:!0}}))),b?null:_.default.createElement(Ot,{placeholder:!0,offsetBottom:0,borderTop:!0},_.default.createElement(Q,{coinId:m,...vt}),_.default.createElement(G,{buttonGroup:Ze})),_.default.createElement(jn,{visible:Gt,onCancel:()=>{Jt(!1)},onConfirm:()=>{Jt(!1),St()},headerProps:{coinId:m,txType:P.TRANS_OUT,analyzeRet:S},psbtHasMultiXRCAsset:de,paymentUseXRCAsset:Qt,assetInversion:S.assetInversion}))};s();a();var L=d(W()),pr=d(ie()),ur=d(je()),_r=d(Bt());R();gt();re();var fr=({unapproved:t})=>{let e=t.walletId,{localType:n}=t,r=ft({localType:n})?.coinId;r===void 0&&(r=wt(n));let l=ae(e),{memo:c,value:p,memoPos:B,to:C,satBytes:y,from:w,extraParams:f}=t.params.transaction,m=ht(r),[I,{toggle:E}]=(0,_r.useBoolean)(!1),[D,O]=(0,L.useState)(y?{level:Dt.CUSTOM,satBytes:y}:{}),F=D?.satBytes,N=(0,pr.useDispatch)(),b=(0,ur.useHistory)(),[,U]=Ne({coinId:r,address:w,chainId:m?.chainId}),v=U?.transferReminder;(0,L.useEffect)(()=>{if(!F&&U?.normal&&O({level:Dt.STANDARD,satBytes:U?.normal}),F&&D?.level!==Dt.CUSTOM){let et=U[be[D?.level]?.satBytes];O({...D,satBytes:et})}},[U]);let[Ft,H]=Se({coinId:r,walletId:e,address:w,satBytes:F},{}),S=pe(e),[It,k,yt]=en({coinId:r,toAddr:C,walletId:e,fromAddr:w,satBytes:F,coinAmount:p,canTransferAmount:H},{}),rt=(0,L.useMemo)(()=>H===void 0||k===void 0?!0:A.gte(H,A.add(k,p)),[H,p,k]),mt=Ee({coinId:r,txType:P.TRANS_OUT,address:w}),it=on({memo:c,memoPos:B,coinId:r,toAddr:C,walletId:e,coinAmount:p,fromAddr:w,localType:m?.localType,dustSize:U?.minOutput,networkFee:k,satBytes:D.satBytes}),At=Jo({coinId:r,walletId:e,satBytes:F,address:w,utxoType:Rt.TRANSFER}),jt=se(e),[tt,st]=(0,L.useState)(!1),ct=(0,L.useCallback)(async()=>{await N(J(t.id)),await N(nt()),st(!1),b.push(Zt)},[N,b,t.id]),Kt=(0,L.useCallback)(async()=>{if(!await le({walletId:e,callback:async()=>{await N(J(t.id))}}))return;let Yt=await At(p,k);await mt(Yt,()=>{ct()}),st(!0);let Gt=await it({utxoList:Yt});t.id&&(await N(at(t.id,{signedTx:Gt,coinAmount:p,serviceCharge:k,satPerByte:F,coinId:r,...f})),await N(nt())),st(!1)},[mt,p,N,k,f,At,ct,F,it,t.id]),vt=(0,L.useMemo)(()=>l?{type:Q.TIP_TYPE.COMMON_ERROR,message:i("wallet_extension_top_toast_dapp_comingsoon")}:rt?yt?{type:Q.TIP_TYPE.FEE_ERROR}:{type:qt.TYPE.warn,message:v}:{type:Q.TIP_TYPE.FEE_BALANCE_INSUFFICIENT},[yt,l,rt,v]),St=(0,L.useMemo)(()=>{let et=[{actionType:G.ACTION_TYPE.CANCEL,btnText:i("wallet_dapp_connection_btn_reject"),onClick:ct}];return rt?et=[...et,{disabled:Ft||It||yt||l||!Number(k),actionType:G.ACTION_TYPE.CONFIRM,onClick:Kt}]:et=[...et,{coinId:r,address:w,walletId:e,actionType:G.ACTION_TYPE.FILL_UP}],et},[r,k,yt,It,w,l,rt,Ft,ct,Kt,e]);return L.default.createElement(u.Container,null,L.default.createElement(Ut,{title:i("wallet_trade_maintitle_transaction_confirm"),backable:!1,closeable:!1}),L.default.createElement(X,null,L.default.createElement(me,{title:i("wallet_extension_send_colored_send"),summaryList:[{coinId:r,coinAmount:p}]})),L.default.createElement(X,null,L.default.createElement($t,{walletId:e,address:w,title:i("extension_send_mid_text_from"),onCopyCallback:()=>{S({trade:"send",all_confirmation:"wallet_used_address"})}},!!H&&L.default.createElement(Le,{coinBalance:H,coinId:r})),L.default.createElement($t,{address:C,title:i("extension_send_mid_text_to"),onCopyCallback:()=>{S({trade:"send",all_confirmation:"to_address"})}})),L.default.createElement(X,{bordered:!1},L.default.createElement(ce,{coinId:r,loading:It,estimateFailed:yt,networkFee:k,level:D?.level,onClick:()=>{E(),S({trade:"send",all_confirmation:"network_fee"})}})),L.default.createElement(Ot,{placeholder:!0,offsetBottom:0,borderTop:!0},L.default.createElement(Q,{coinId:r,...vt}),L.default.createElement(G,{buttonGroup:St})),L.default.createElement(Be,{coinId:r,visible:I,signInfo:U,value:D,estimatedFee:k,onChange:O,onToggleVisible:E}),L.default.createElement(Pe,{visible:jt&&tt}))};s();a();var ye=d(W()),gr=d(Bt());he();gt();kr();re();s();a();function dr(t){try{return[JSON.parse(t),null]}catch{return[null,new Error("Illegal JSON string")]}}Ar();s();a();var Xe=d(W()),Tr=d(ie());R();gt();re();s();a();var Y=d(W());gt();R();var Ge=d(Bt());s();a();var Lt={"inscription-preview":"_inscription-preview_yy6vc_1",inscriptionPreview:"_inscription-preview_yy6vc_1","inscription-preview__inner":"_inscription-preview__inner_yy6vc_13",inscriptionPreviewInner:"_inscription-preview__inner_yy6vc_13","inscription-preview-text":"_inscription-preview-text_yy6vc_21",inscriptionPreviewText:"_inscription-preview-text_yy6vc_21","inscription-preview-image":"_inscription-preview-image_yy6vc_26",inscriptionPreviewImage:"_inscription-preview-image_yy6vc_26","inscription-item__content":"_inscription-item__content_yy6vc_30",inscriptionItemContent:"_inscription-item__content_yy6vc_30","inscription-exceedTip":"_inscription-exceedTip_yy6vc_34",inscriptionExceedTip:"_inscription-exceedTip_yy6vc_34","inscription-extend":"_inscription-extend_yy6vc_39",inscriptionExtend:"_inscription-extend_yy6vc_39","inscription-extend__icon":"_inscription-extend__icon_yy6vc_43",inscriptionExtendIcon:"_inscription-extend__icon_yy6vc_43"};var co=24,Ye={TEXT:"text",IMAGE:"image"},Kr=Y.default.memo(({type:t,contentType:e,body:n})=>{let[{inscriptionType:o,inscriptionContent:r},l]=(0,Ge.useSetState)({inscriptionType:Ye.TEXT,inscriptionContent:n});return(0,Y.useEffect)(()=>{if(t===P.ORDINAL_NFT||e?.startsWith("image/"))try{let c=URL.createObjectURL(new Blob([n]));l({inscriptionType:Ye.IMAGE,inscriptionContent:c})}catch{l({inscriptionType:Ye.TEXT,inscriptionContent:n})}finally{l({initing:!1})}},[n,e,l,t]),Y.default.createElement(u.Box,{className:Lt["inscription-preview"]},o===Ye.IMAGE?Y.default.createElement("img",{alt:"",src:r,className:Lt["inscription-preview-image"]}):Y.default.createElement(u.Box,{className:Lt["inscription-preview__inner"]},Y.default.createElement(T.Text,{forceWrap:!0,className:Lt["inscription-preview-text"]},r)))}),Jr=({type:t,contentType:e,body:n,rawBody:o})=>{let r=(0,Y.useMemo)(()=>{let p=n?.length;return A.lt(p,1024)?`${p} B`:`${A.floorTruncate(A.div(p,1024),3)} KB`},[n?.length]),l=t===P.ORDINAL_NFT||e?.startsWith("image/"),c=l?o?.slice(0,200):o;return Y.default.createElement(u.FlexBox,null,Y.default.createElement(Kr,{type:t,body:n,contentType:e}),Y.default.createElement(u.FlexBox,{direction:u.DIRECTION.vertical,className:Lt["inscription-item__content"]},Y.default.createElement(T.Text,{strong:!0,ellipsis:{tooltip:!l},size:T.SIZE.xs},c),Y.default.createElement(T.Text,{size:T.SIZE.xs,type:T.TYPE.secondary},r)))},Qr=({type:t,dataSource:e=[]})=>{let n=e?.length||0,[o,{toggle:r}]=(0,Ge.useBoolean)(!1),l=(0,Y.useMemo)(()=>o?e?.slice(0,co):e?.slice(0,3),[e,o]),c=(0,Y.useMemo)(()=>Bo(t),[t]);return Y.default.createElement(nn,{space:16,title:i(c,{num:n})},Y.default.createElement(qo,{space:24,renderEmpty:!1,dataSource:l,renderItem:p=>Y.default.createElement(Jr,{...p,type:t})}),o&&n>co&&Y.default.createElement(T.Text,{size:T.SIZE.xs,type:T.TYPE.secondary,className:Lt["inscription-exceedTip"]},i("wallet_info_dialog_desc_replicate_hide",{num:A.sub(n,co)})),n>3&&Y.default.createElement(u.FlexBox,{justify:"center",className:Lt["inscription-extend"],onClick:r},Y.default.createElement(ot,{size:ot.SIZE.xs,className:Lt["inscription-extend__icon"],icon:o?"okds-arrow-chevron-up-md":"okx-wallet-plugin-add-arrow-chevrons"})))},xr=Qr;function ti({unapproved:t}){let e=(0,Tr.useDispatch)(),{id:n}=t,{type:o}=t.params?.transaction||{},r=bo[o],{localType:l}=t,p=ft({localType:l})?.coinId;p===void 0&&(p=wt(l));let B=async()=>{await e(nt()),await e(J(t.id))},C=async w=>{await e(at(t.id,w)),await e(nt())},{inscriptions:y}=yn();return Xe.default.createElement(gn,{txId:n,headerProps:{title:r?i(r):null,closeable:!1,backable:!1},confirmButtonProps:{onCancel:B,onConfirm:C},slot:{top:Xe.default.createElement(X,null,Xe.default.createElement(xr,{type:o,dataSource:y}))},netWorkCoinId:p})}var yr=ti;var ei=[P.BRC20_MINT,P.BRC20_INSCRIBE,P.BRC20_DEPLOY],oi=[P.RUNES_ETCH];function ni(t,e){let n=vo(e);return ei.includes(t)?n=Fo(e):oi.includes(t)&&(n=Mo(e)),n}function ri(t,e){return e.map(({contentType:n,body:o})=>{let r=o;try{(t===P.ORDINAL_NFT||typeof t!="number"&&n?.startsWith("image/"))&&(r=x.Buffer.from(o,"hex"))}catch{}return{contentType:n,body:r,rawBody:o}})}function ii({unapproved:t}){let{tick:e,type:n,from:o,to:r,txSource:l,inscriptions:c=[],amount:p,mintType:B=ko.parallel,noBroadCast:C=!1}=t.params?.transaction||{},{localType:y}=t,w=(0,ye.useMemo)(()=>ri(n,c),[n,c]),f=ft({localType:y}),m=f?.netWorkId;m===void 0?m=ne(y):m=+m;let I=f?.coinId;I===void 0&&(I=wt(y));let E=(0,gr.useCreation)(()=>{if(n===P.RUNES_ETCH){let[b,U]=dr(c[0]?.body);if(U)return{chainId:m,coinType:Ve(m),symbol:e,address:"btc-runesMain-invalid-inscriptions"};let v=b?.id||"";return{chainId:m,coinType:Ve(m),symbol:e,address:`btc-runesMain-${v}`}}return e?{chainId:m,coinType:Ce(m),symbol:e}:null},[e,n,m]),D=ni(n,m),O=ht(void 0,{},E),F=(b,U)=>{let v=0;if(n===P.RUNES_ETCH){b.coinAmount=$e(p,10**O?.decimals),b.coinId=O?.coinId||I,b.txSource=l||Ht.DAPP;return}p&&O?.decimals&&(v=$e(p,10**O?.decimals)),b.coinAmount=v,b.coinId=U?I:O?.coinId||I,b.txSource=l||Ht.DAPP},N=(b,U)=>(b&&F(b,!0),Array.isArray(U)&&U.forEach(v=>{F(v,!1)}),C);return ye.default.createElement(Cn,{params:{walletId:t.walletId,utxoType:Rt.INSCRIPTION_USE_NFT_UTXO,from:o,to:r,inscriptions:w,txType:n,protocolId:D,mintType:B,netWorkCoinId:I},lifecycle:{beforePostTx:N}},ye.default.createElement(yr,{unapproved:t}))}var Cr=ii;s();a();var qe=d(W()),Ir=d(ie());R();zo();var si=({unapproved:t})=>{let e=(0,Ir.useDispatch)(),{targetCoin:n}=t.params||{},o={image:n.logo,decimals:n.decimals,name:n.name,address:n.contractAddress,symbol:n.symbol},r=pe(),l=(0,qe.useMemo)(()=>{let c={actionType:G.ACTION_TYPE.CANCEL,async onClick(){r({all_confirmation:"cancel",trade:"add_token"}),await e(J(t.id)),await Te(e)},btnText:i("wallet_dapp_connection_btn_reject")},p={actionType:G.ACTION_TYPE.CONFIRM,async onClick(){try{r({all_confirmation:"confirm",trade:"add_token"}),await Xo(n),await e(at(t.id)),await Te(e)}catch(B){wo.error(B?.data?.originalError?.msg||i("wallet_extenshion_toast_add_failed"))}}};return[c,p]},[r,e,n,t.id]);return qe.default.createElement(An,{token:o,networkName:n.blockChain||n.localType,buttonGroup:l})},wr=si;var Tu=({unapproved:t})=>{switch(t.method){case K.TRANSFER_NFT:case K.SEND_INSCRIPTION:return Pt.default.createElement(En,{unapproved:t});case K.SPLITUTXO:return Pt.default.createElement(Bn,{unapproved:t});case K.INSCRIBE:case K.INSCRIBE_TRANSFER:return Pt.default.createElement(Mn,{unapproved:t});case K.SIGNPSBT:case K.SIGNPSBTS:return Pt.default.createElement(cr,{unapproved:t});case K.SIGN_MESSAGE:return Pt.default.createElement(Ln,{unapproved:t});case K.MINT:return Pt.default.createElement(Cr,{unapproved:t});case K.WATCHASSET:return Pt.default.createElement(wr,{unapproved:t});case K.SEND:case K.SEND_BTC:return Pt.default.createElement(fr,{unapproved:t});default:return""}};export{Tu as default};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=Bitcoin-QJWU65XV.js.map
