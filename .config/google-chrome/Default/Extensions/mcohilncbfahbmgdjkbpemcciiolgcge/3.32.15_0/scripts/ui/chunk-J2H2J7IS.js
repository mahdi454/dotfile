import{a as $}from"./chunk-MF4732CU.js";import{a as ue,b as le,d as me,g as v}from"./chunk-GPJC633M.js";import{I as fe,M as Ce,N as E,O as Z}from"./chunk-YC6W5MPL.js";import{c as X,d as Y}from"./chunk-ABBYZM2I.js";import{a as J,b as D,c as ae}from"./chunk-V4NJDTLC.js";import{h as G}from"./chunk-IQUFOLSA.js";import{a as _}from"./chunk-ZYEEMVIP.js";import{l as z}from"./chunk-WKBC6JL3.js";import{X as H}from"./chunk-VPDRXROE.js";import{K as ce,sa as ie,w as oe}from"./chunk-JLIPSIRU.js";import{Bb as re,Gb as te,Jb as Ae,Oc as se,Rc as Ne,X as V,w,x as Q}from"./chunk-YT2MPR4E.js";import{F as j,K as ne,pa as Te,x as K}from"./chunk-6O63U2D6.js";import{M as ee,l as M,r as U}from"./chunk-RIOWPXBZ.js";import{a as O}from"./chunk-O337TVCZ.js";import{f as N,m as g,o as P}from"./chunk-GLD6H5Q5.js";g();P();var R=N(O()),C=N(H());Te();ee();g();P();var pe=N(O());V();function ye(){let e=D();return(0,pe.useCallback)(async n=>{let t=await ue(n),r={};return t&&Object.entries(t).forEach(([o,s])=>{let l=[];s.forEach(c=>{let i;"childrenCoin"in c&&c.childrenCoin?.length&&(i=c.childrenCoin?.map(f=>({...f,currencyAmount:w(f.currencyAmountUSD,e.usdToThisRate)}))),l.push({...c,childrenCoin:i,currencyAmount:w(c.currencyAmountUSD,e.usdToThisRate)})}),r[o]=l}),r},[e.usdToThisRate])}g();P();var de=N(O()),he=N(oe()),F=N(H());V();var I=()=>{let e=(0,he.useSelector)(ie),n=v();return(0,F.useCreation)(()=>{let t={},{symbol:r}=e;return Object.keys(n).forEach(o=>{t[o]={currencySymbol:r,usdPrice:n?.[o]?.coinToUSDRate,currencyPrice:w(n?.[o]?.coinToUSDRate,e?.usdToThisRate),priceChangePercent24h:n?.[o]?.coinPriceChangePercent24h}}),t},[n,e])},ge=e=>{let n=I(),t=D(),{data:r,run:o}=(0,F.useRequest)(E,{manual:!0,ready:!0,retryCount:3,staleTime:36e5,cacheTime:864e5});return(0,de.useEffect)(()=>{!n[e]&&fe(e)&&o(+e)},[n,e]),(0,F.useCreation)(()=>{let s=n[e];if(s)return s;if(r&&t){let{currencyAmount:l,priceChangePercent24h:c}=r;return{currencySymbol:t.symbol,usdPrice:l,currencyPrice:w(l,t.usdToThisRate),priceChangePercent24h:c}}return null},[n,e,t,r])};g();P();var Pe=N(oe());function q(){return(0,Pe.useSelector)(ce)}Ae();Ne();V();var Be=e=>!!e&&!Number.isNaN(e),W=(e={})=>{let n=$(),t=J(),r=q(),o=I(),s=v(),l=(0,C.useLatest)(n),c=(0,C.useLatest)(o),i=(0,C.useLatest)(s),{withPrice:f=!1,withPriceChangePercent24h:d=!1}=e||{},[h,p]=(0,R.useState)(void 0),{runAsync:b}=(0,C.useRequest)(Z,{manual:!0,cacheKey:h,retryCount:3,staleTime:36e5,cacheTime:864e5});return(0,R.useCallback)(async(a,m)=>{if(a===0||!r||Number.isNaN(a))return null;let y;if(typeof a<"u")y=l?.current?.[a];else if(m){let u=Object.values(n);if(m.aggregation&&m.symbol)return t[m.symbol]?{...t[m.symbol][0],childrenCoin:t[m.symbol]}:null;if(Y(m)){let B=U(u,m);B.length>0&&(y=B[0])}}if(!y&&a!==0){let u;typeof a<"u"&&!Number.isNaN(a)?u={coinId:a}:m&&(u=!j(m)&&Ce(m)?m:null),u&&(p(X(u)),y=await b(u))}if(!y)return null;let T;if((f||d)&&!l?.current?.[a]&&(T=await E(y.coinId)),f){let{currencySymbol:u,usdPrice:A,currencyPrice:B}=c?.current?.[a]??T??{};y={...y,currencySymbol:u,usdPrice:A,currencyPrice:B}}if(d){let u=i?.current?.[a]?.coinPriceChangePercent24h??T?.priceChangePercent24h;y={...y,priceChangePercent24h:u}}return y},[f,d,n,t,b,r])},Me=(e,n,t)=>(0,C.useCreation)(()=>{let r;if(!(t||e===0)&&(typeof e<"u"&&!Number.isNaN(e)?r={coinId:e}:r=j(n)?null:n,r))return X(r)},[e,n,t]),x=(e,n={},t)=>{let r=J(),o=$(),s=q(),{withPrice:l,withPriceChangePercent24h:c}=n,i=ae(t),f=[e,o,r,i,s],d=[],h=(0,C.useCreation)(()=>{let u;if(e===0||!s||Number.isNaN(e))return null;if(typeof e<"u")u=o?.[e];else if(i){let A=Object.values(o);if(i.aggregation&&i.symbol)return r[i.symbol]?{...r[i.symbol][0],childrenCoin:r[i.symbol]}:null;if(Y(i)){let k=U(A,i);k.length>0&&(u=k[0])}}return u||null},f),p=!!h,b=Me(e,i,p),{data:a,run:m}=(0,C.useRequest)(Z,{manual:!0,ready:!0,cacheKey:b,retryCount:3,staleTime:36e5,cacheTime:864e5});(0,R.useEffect)(()=>{if(!p&&s&&!!b){let u=Be(e)?{coinId:e}:i;m(u)}},[p,s,b,e,i]);let y=h||a,T=ge(l||c?y?.coinId:null);return d.push(y,T),(0,C.useCreation)(()=>{if(!y)return null;let u=y;if(l&&T){let{currencySymbol:A,usdPrice:B,currencyPrice:k}=T;u={...u,currencySymbol:A,usdPrice:B,currencyPrice:k}}if(c){let{priceChangePercent24h:A}=T;u={...u,priceChangePercent24h:A}}return u},d)};var Re=e=>{let n=W(e),t=G(),r=me(),o=ye();return(0,C.useMemoizedFn)(async(s,l)=>{let c=await n(s);if(!c)return null;let i;l&&l!==t?i=(await o({walletIds:[l],coinId:s,chainId:c.chainId,flatten:!0}))[l]??[]:i=r;let{coinAmountInt:f="0",currencyAmount:d="0",currencyAmountUSD:h="0"}=K(i,p=>p?.coinId===s)||{};return{...c,coinAmountInt:f,currencyAmount:d,currencyAmountUSD:h,coinAmount:Q(f,10**c?.decimals)}},[r,t,n])},we=(e,n,t)=>{let{addressType:r,key:o}=t||{},s=x(e,t,o?{key:o}:void 0),l=G(),c=n||l,i=le(c),f=!!i,d=i?.coins??[],h=(0,C.useCreation)(()=>K(d,a=>{let m;if(o?m=a.key===o:m=a.coinId===e,r){let y=se[te(s?.localType)]?.[r];m=m&&y===a?.addressType}return m}),[d,c,e,r,o]),{coinAmountInt:p,currencyAmount:b}=h||{};return(0,C.useCreation)(()=>{let a;return s?(a={...s,coinAmountInt:p,currencyAmount:b},ne(p)?f?(a.coinAmountInt="0",a.coinAmount="0",a.currencyAmount="0",a.currencyAmountUSD="0"):a.coinAmount=void 0:a.coinAmount=Q(p,10**s.decimals)):a=null,a},[s,p,f])},xe=(e,n)=>{let t=x(e,n),r=x(t?.baseCoinId,n);return[t,r||t]},be=e=>{let n=W(e);return(0,C.useMemoizedFn)(async t=>{let r=await n(t),o=await n(r?.baseCoinId);return[r,o||r]},[n])};var Se=(e={})=>{let n=be(e);return(0,C.useMemoizedFn)(async t=>{let[,r]=await n(t),o=r?.coinId;return re.indexOf(o)!==-1},[n])},dn=(e,n={})=>{let t=Se(n),[r,o]=(0,R.useState)(!1);return(0,C.useAsyncEffect)(async()=>{let s=await t(e);o(s)},[t]),r};g();P();g();P();ee();var L=N(H());var Fe=(e={})=>{let{currencyId:n,formatted:t=!0,useApproximate:r}=e||{},o=_(n),{symbol:s,usdToThisRate:l}=o,c=W({withPrice:!0});return(0,L.useMemoizedFn)(async(i,f)=>{let d=await c(i),h=M.div(f,10**d?.decimals),p=M.mul(d?.usdPrice,l),b=M.mul(h,p);return t?z(b,{useApproximate:r,symbol:s}):b},[s,t,c,l,r])},We=(e,n,t={})=>{let{currencyId:r,formatted:o=!0,useApproximate:s,useMinPrecision:l=!0}=t||{},c=x(e,{withPrice:!0}),{usdToThisRate:i,symbol:f}=_(r);return(0,L.useCreation)(()=>{if(!c||!c?.usdPrice)return null;let d=l?M.div(n,10**c?.decimals):n,h=M.mul(c?.usdPrice,i),p=M.mul(d,h);return o?z(p,{useApproximate:s,symbol:f}):p},[f,o,i,n,s,c?.usdPrice,c?.decimals])};export{ye as a,q as b,W as c,x as d,Re as e,we as f,xe as g,dn as h,Fe as i,We as j};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-J2H2J7IS.js.map
